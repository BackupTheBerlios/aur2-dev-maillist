From djszapi at archlinux.us  Sat Nov 14 06:14:29 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Sat, 14 Nov 2009 06:14:29 +0100
Subject: [Aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	created. 2da02900756ced2e08da28b4e178fadc7a90f5cf
Message-ID: <200911140514.nAE5ETY6000514@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been created
        at  2da02900756ced2e08da28b4e178fadc7a90f5cf (commit)

- Log -----------------------------------------------------------------
commit 2da02900756ced2e08da28b4e178fadc7a90f5cf
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Feb 10 12:34:08 2009 +0900

    Add the tagging app
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 680f25ec8e5c1c56f5470ed919c2d5ee6d60ef2c
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Feb 10 12:29:39 2009 +0900

    Fix serving static media using the Django dev server
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 110c0f7a673abdeccdea42353ae6fdf2f0a0d629
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Feb 10 12:16:41 2009 +0900

    Re-organize settings file
    
    Instead of tracking changes in settings.py.proto and merging with a
    local settings.py, the settings.py is tracked and local settings are
    imported from settings_local.py. The imported settings can override the
    settings defined in settings.py, so it's still flexible.
    
    Better efaults have also been defined, for a development environment.
    This makes it faster and easier to start developing.
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 17d90a8f0ad54e76e1f283bb024513cf8df54f93
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Wed Feb 4 13:44:47 2009 +0900

    Fix has_update_notification template tag
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 97c03a2938aaf60b8055dd21fc30c32895a0763a
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Wed Feb 4 00:11:59 2009 +0900

    Fix download link in package detail view
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 75762e6a8d8d1be9e573c324cccfdc4b11b35e85
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Wed Feb 4 00:06:28 2009 +0900

    Change categories to tags
    
    This allows for a much more flexible way of categorizing packages. If
    pacman/makepkg ever support categories, it will be much easier to integrate
    that data.
    
    This uses the django-tagging third party app, which means an additional
    dependency. The app does not support non-integer based primary keys for
    taggable models, thus Package's primary key was changed to the standard "id"
    and name was changed to be unique. A slug was also added to keep the
    object_detail generic view working.
    
    Note: This is a schema backwards-incompatible change.

commit 229751db6baaa7928839a624e0c62177dc6f02e0
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Feb 2 01:22:45 2009 +0900

    Fix uploading plain text PKGBUILDs
    
    The tarfile module seems to require a path in ASCII, but unicode was used.
    This fix will probably turn into a bug in Python 3.0
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 224fd7dca4fd9cf40c686f89120fa1c98b392c4d
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Feb 2 01:14:47 2009 +0900

    Fix has_update_notificatation filter
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 3f0fa31c1f58b34c663401a856aee5639ec3917a
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Feb 2 00:10:43 2009 +0900

    Skip sending emails when user did not specify email
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 7d94ee97febc2f00743f97f4ac9e381453ea48aa
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Feb 2 00:01:19 2009 +0900

    Use new file storage instead of os.* directly

commit f787b5a74fb235508ee6fd049026ea074f772d97
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Feb 1 21:42:00 2009 +0900

    Fix package update notification
    
    Also use DEFAULT_FROM_MAIL instead of EMAIL_HOST_USER for the From field
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 745235bd4921c1caadb1c94691c8174fd19c57b6
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Feb 1 18:42:01 2009 +0900

    Add 404 (Not Found) template
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 3d7534f023756feb8c08ec253bca79bc9260a815
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Feb 1 17:38:41 2009 +0900

    Make forms less needy
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit c415aaddc05780d8e81c796e5bc92d9cb823ca3e
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Feb 1 14:07:15 2009 +0900

    Remove ArchUser and use django-registration
    
    The ArchUser User profile added complexities for little benefit (IRC username
    and inactivity). It was removed in favor of aurprofile for AUR user profiles.
    This new app provides only provides a profile page and a form for updating
    user details.
    
    Handling of the registration process has been out-sourced to the third-party
    django-registration app, which does more than the previous system did. This
    obviously adds a dependency for that app.
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit aa9d25cdff41d67380667735359a27f611335985
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Feb 1 02:04:47 2009 +0900

    Add documentation about configuration and installation
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 86aa09f33ffdbea228f493d8c1b28330d6eb5039
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Jan 31 23:18:15 2009 +0900

    Catch errors when creating a tarfile
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 3b2e6c3e428bfbf7f70bbce5ab0cf1a78a8e270e
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Jan 31 19:06:32 2009 +0900

    Fix API response mimetype and allow for different formats
    
    The mimetype was set as "text/plain", which is not correct for JSON, it should
    be "application/json".
    
    The API now supports different serialization formats depending on the
    extension provided in the URL. E.g., /api/package/foo.json and
    /api/package/foo.xml return package information in JSON and XML format,
    repsectively.
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit e949fe7293f41632e2b2c96f517796681ad4ccde
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Jan 31 21:16:47 2009 +0900

    Fix uploading packages
    
    In Django 1.0 the way files FileFields were saved changed. The API now wants a
    File object as opposed to a string. Additionally the upload_to field now
    allows a callable. The overridden methods were removed in favor of using a
    callable that returns the appropriate path.

commit fdf516e2248b7cae241910ed7615498e4f5a7ad4
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Jan 27 22:59:18 2009 +0900

    Fix Package form for Django 1.0
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit d4b5a4c0da5946001a5f4da8088d73b86f23dc6a
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Jan 27 19:47:50 2009 +0900

    Fix admin interface
    
    The way customizing the admin panel has changed from Django 0.8 to
    Django 1.0. This "ports" the admin customizations from 0.8 to 1.0.
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit fc62702d0f3ec12911574b1a64e98732dcb0967c
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Jan 27 19:04:33 2009 +0900

    Fix admin urls to be compatible with Django 1.0
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 053ce938e36079ab9bd6194d34a9971bb9f3129e
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Dec 29 22:53:06 2008 +0900

    Replace BetterPaginator with the Django paginator
    
    The paginator in Django 1.0 has improved. BetterPaginator is also
    broken.
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 97e2e2a7f1c7ead813ef2c7a83b26570445cbfcd
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Dec 29 23:55:08 2008 +0900

    Update signal connection method for Django 1.0
    
    Signal handling has been completely changed in Django 1.0. This change
    reflects those changes
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit de0e3a4f49000bb2123695189f88ab0c95fad86c
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Dec 29 22:57:45 2008 +0900

    Import forms instead of newforms (Django 1.0)
    
    As stated in the comments, newforms has moved to forms, so we have to
    import that instead.
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 0a24855a41d28ae5f19af492ebf514e253ff82c9
Author: Callan Barrett <wizzomafizzo at gmail.com>
Date:   Fri Jun 27 21:19:12 2008 +0800

    Update templates, make style and images local
    
    No more hotlinking in templates, references to some stuff have been updated
    and added in urls.py to serve media files with django if debug is on
    
    Signed-off-by: Callan Barrett <wizzomafizzo at gmail.com>
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit d3ec4371e6e051c329072a16d4311ca7388baff3
Author: Callan Barrett <wizzomafizzo at gmail.com>
Date:   Fri Jun 27 20:43:27 2008 +0800

    Fixes error when uploading files
    
    Signed-off-by: Callan Barrett <wizzomafizzo at gmail.com>
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit d3957745a0f9124e7c6b5dece07ee0e742a2dd8d
Author: Callan Barrett <wizzomafizzo at gmail.com>
Date:   Fri Jun 27 20:33:26 2008 +0800

    Add a proper working settings file
    
    Signed-off-by: Callan Barrett <wizzomafizzo at gmail.com>
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 593e8a2425877c3bdc492a6b023cc5cfcd5a75c3
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Fri Jan 25 19:27:55 2008 +0900

    Removed TODO comment for implementing transactions

commit f5db74dc60f019f7115aac86978a6e9bb5026b97
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Fri Jan 25 19:03:36 2008 +0900

    Moved sortby and order by from the form
    
    The two GET variables now get set by clicking on the table headers of the
    search/package listing

commit 193751f01f399c53ac381ff811b7265bf40897fb
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Fri Jan 25 17:39:02 2008 +0900

    Moved Account link to "Logged in as [user]" text

commit 33b96c89b9c4bbe9652dd4939014f150134e90d8
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Fri Jan 18 02:25:04 2008 +0900

    Revised provision support

commit ea352da84d99200b6360b9d57bf2c0898a8c7d29
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Thu Jan 17 18:55:42 2008 +0900

    Added reverse dependencies

commit dee63e6efbca1abd62397ce5f59ddc29ff2bc16e
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Thu Jan 17 18:03:25 2008 +0900

    Changed notification emailing to use settings
    
    Also added the email template which somehow wasn't committed

commit ae28428da0d131f58f26141f85b068ea831efdee
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 14 15:02:11 2008 +0900

    Added basic package management interface

commit 566369cacba6e5e49b363b6d535380d39dce5f4a
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 13 22:21:35 2008 +0900

    Extended User model

commit b6d27191b44a2b104ec88e5fac312ecb7a067be2
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Tue Jan 15 22:16:26 2008 +0900

    Moved form related code to forms.py

commit 415c2787ce924a935056b34f5b059f4371f40fc9
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Tue Jan 15 19:20:13 2008 +0900

    Fix pagination url when no other GET variables are set

commit 99419084015c5fd6b68e8fb2ce6b1743b8ee6148
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 13 13:19:20 2008 +0900

    Fixed display of "last updated" date on the account page

commit 27a45a9b86d33c00f9e5a01349dca136f1e98c8d
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 13 12:35:29 2008 +0900

    Update packages properly
    
    The form was basically assuming it was creating packages and django by default
    "plays nice" with files that exist on disk, so there were duplicates

commit a97cd53d7258408b7f4deceb04acbeef33febe21
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 13 12:47:56 2008 +0900

    Fixed display of "last updated" date in package listing

commit 8734866af4eddb02c544bf35351f7ea09d82f911
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 13 01:11:50 2008 +0900

    Be more unicode compatible

commit 975f73c52dfb64cfce0d9609e0a22e432466f18a
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 13 00:49:49 2008 +0900

    Delete files when removing Package and PackageFiles

commit 55973b2152c36b6bab4bd6113917debf677ece81
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Jan 12 22:59:54 2008 +0900

    Delete temporary directories after parsing PKGBUILD

commit 50d2d153b4b24fd8f9171a5d2f83fe97837f09df
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Jan 12 22:55:02 2008 +0900

    Refactored submit code into PackageSubmitForm
    
    Validation and actual saving of data and files is now separated. Errors are
    enclosed within the form

commit eb0f0929b522f7f618a655765b4341b0d62d94ad
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Jan 12 16:51:12 2008 +0900

    Removed comment from package submission

commit 8e7fd1fb548cc357bdcea50e54672179c1feadd0
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Jan 12 15:01:48 2008 +0900

    Added "flag out of date" help like on the main site

commit b539717bac41f7a27aa4145a1fc72c59f81fd367
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Jan 12 14:34:04 2008 +0900

    Updated template to reflect changes on the main site

commit 096a301cfb6d7824a0b45f45b458c547d0b7dac7
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Thu Jan 10 04:15:35 2008 +0900

    Implemented basic JSON RPC API

commit 2e7798113f56cc0d67dda691715122cb1ba1f061
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Wed Jan 9 19:46:59 2008 +0900

    Save install files as well

commit 26f901b81b723ef30dd2b6d79d6042e4b7a7be44
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Tue Jan 8 23:16:09 2008 +0900

    Added validation checks for hyphens in version and release fields
    
    makepkg has these checks so we should have them too

commit f8ab8138a5da279aa3ecc3d07710a4295bf95b6c
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 21:01:40 2008 +0900

    Fixed external urls not being recorded

commit 3eb99d03a1b03fe69caa1483a7759ce54a151173
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 20:39:04 2008 +0900

    Implemented transactions in submit view

commit a942de6da427c5e3db17c3635da3df5a02bc011c
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 18:28:09 2008 +0900

    Fixed submission for plain PKGBUILDs

commit 605b92a835c8e73d6ffc8abad0118f3001763d1e
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 18:00:15 2008 +0900

    Fixed listing of a single package
    
    Since the listing is supposedly a search, having only one hit resulted in being
    redirected to the package's detail page. The view now checks if the form was
    bound (it was a search) before doing so.

commit 36dadd3511d8790b0a409d16c81a31ad5c47169e
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 17:53:22 2008 +0900

    Implemented interface for subscriptions to package updates

commit 4b1b5bf79869609a173dd528cd5fee2e6a844c00
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 16:28:51 2008 +0900

    Removed "view file list" and "view scm entries" since they are useless

commit 572d5eccf5ff82acc2f1a4001a7ed5253a720b04
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 16:22:15 2008 +0900

    Implemented saving the tarball of a package

commit db93cdb824970c653804f3c9faf347e9f9034b60
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 15:34:56 2008 +0900

    Fixed saving local files
    
    The search path of local sources was incorrect so sources were being saved as
    urls instead.

commit a77a3e703821e81c4d683e60466dee92922520be
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 04:02:22 2008 +0900

    PKGBUILD gets saved for real now
    
    When reading the PKGBUILD for hashing the file pointer moved to the end of the
    file, so subsequent calls to readlines() returned nothing.

commit bcddd2a3756a2fc0693b25523ceb2c87e2ba78e6
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Jan 7 03:50:23 2008 +0900

    Implemented saving PKGBUILD to file system

commit da8d7740afdedc890fb3b64d8b3320485f924061
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 6 01:33:48 2008 +0900

    Automated updating of timestamps
    
    Timestamps automatically get added to the Package and Comment models on
    creation.

commit 51f69f67e640354dbd2de49925e62c89fac63926
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 6 00:55:26 2008 +0900

    Setting the outdated field in save() prevents us from changing it
    
    I thought setting outdated to False in the save method would be a
    shortcut but it only broke flagging packages out of date

commit 4ce8bed73f72ac9ce677f6b1fcf7a612b4ad042e
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Jan 6 00:53:43 2008 +0900

    Fixed and standardised most urls
    
    Added get_absolute_url for Package

commit 018b3457a77688510e8c6acf1a43718d1a5d1431
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Jan 5 00:01:21 2008 +0900

    Implemented packages out of date counter in profile page

commit dcb2d7502a903b644539e4fd8ff86758430e6dd6
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Fri Jan 4 23:11:40 2008 +0900

    Added space in "logged in as" text in the header

commit 644514bdd04263a14c188422dab45d429f1bc221
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Mon Dec 31 21:56:33 2007 +0900

    Added more internationalisation and cleaned templates up a bit

commit 4ce1b7d685e61e8eaed2e25863a14caafe4efb5b
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Dec 30 21:48:40 2007 +0900

    Added initial data for Groups
    
    Developer, Trusted User and User groups have been added as default

commit edf12e169f9148baecd2798c17ca4b099b523184
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Dec 30 19:39:14 2007 +0900

    Implemented flagging packages out of date

commit bd02b155f2eec1509d35935f3b4a9f2fac16cf07
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Dec 30 15:57:52 2007 +0900

    Fixed catching exceptions. All are now displayed to the user

commit c5ea342456ae18dc5843c4ac18eb9bfc3f09a288
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Dec 30 15:34:01 2007 +0900

    Package class now actually extends UserDict instead of being a wrapper

commit d2e25ca36dcd0aed9839ffdae85250c696d9e9f0
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Dec 30 15:24:50 2007 +0900

    Made parser more flexible, allowing for any type of tar file
    
    The parser doesn't check the filename and simply tries to open the file as a
    tar file. This means any filename may be opened if it's a valid tar file

commit f7da83a67aeebb4bdb08446c95f16d8e832110f2
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Dec 30 04:09:17 2007 +0900

    Redirect straight to package details if only one package is found

commit 3d9be62bb66a86a590d68aa63612cecac506d2e5
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sun Dec 30 03:52:36 2007 +0900

    Implemented more in-depth package validation

commit bb273eec923975afc29ebca24f3433343f12fb89
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Dec 29 21:37:46 2007 +0900

    Refactored search into search form
    
    The search view was unecessarily doing all the heavy lifting. The search
    form now does the actual search and form parsing and simply returns a
    QuerySet.

commit 4532287e4bb4052589f3a03263284164832dd44e
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Dec 29 23:00:22 2007 +0900

    Corrected referential integrity
    
    Some records were being written when the package was not yet saved.
    This raised errors with DBMS's that enforce referential integrity.
    
    The location of the uploaded tarball was changed to one within the
    temporary directory.

commit ff3d786e0268a6ff8c0faeaab411a58a709cd884
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Dec 29 20:06:52 2007 +0900

    Refactored initial data for search form

commit b2b6118e3df8e08f4b23edd5a8b2102798f3f7a6
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Sat Dec 29 18:50:34 2007 +0900

    Added message about not having any packages in the database

commit 39b3efb771c8667a1364d3a9ae8925b239771259
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Fri Dec 28 16:36:04 2007 +0900

    Removed "Statistics" tab from navigation, since it's not implemented

commit 8ae9797f003ec29fec854ec5a66dd38cc0bfb83d
Author: Sebastian Nowicki <xilonmu at gmail.com>
Date:   Fri Dec 28 16:09:55 2007 +0900

    Increased License name max_length just in case
    
    The "PerlArtistic" license was too long for the current max_length

commit 3bbd6ae1a7bcade6c2ec83f26836a6d6fd1d5c9a
Author: Callan Barrett <wizzomafizzo at gmail.com>
Date:   Tue Dec 25 03:38:45 2007 +0900

    Fixed Xilon's terrible spelling
    
    Signed-off-by: Callan Barrett <wizzomafizzo at gmail.com>
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

commit 5640dce414d04c2b125acd6abb9d7f26aedffe34
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Dec 23 00:33:55 2007 +0900

    Added basic package update notification

commit f847abb91454158888016240a410b993fa48f73f
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Dec 23 02:19:09 2007 +0900

    Moved Package module to aur application

commit 921615d9269192b0b1a259814cef274c2c318878
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Dec 22 16:54:27 2007 +0900

    Extended title tags on various pages

commit 011adf21c9158bb18daa7ee241c676b4d9f972d9
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Dec 22 15:59:24 2007 +0900

    Added comments, without threading

commit e233268821ceef81b3b31b17d1989b15d37f4790
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Dec 22 04:18:21 2007 +0900

    Implemented listing sources of a Package

commit 11460a9ee1362c2b0bfdf8bc760c3aac1d4b5c1f
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Fri Dec 21 15:17:44 2007 +0900

    Added basic support for package submission
    
    Added Group and License models
    Added common license fictures
    Changed maxlength to max_length as it is deprecated
    Increased maximum hash length to 128 due to sha512 sums
    hash field in PackageHash is now the primary key
    Added licenses and groups fields to Package
    Added make_depends, provides, replaces and conflicts fields to Package
    Changed hash type to a CharField, it's simpler that way

commit f563acb04f55b9105826bc5a838cd86c49b345ed
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Fri Dec 21 15:13:10 2007 +0900

    Package can raise exceptions

commit c6caa4822283f28009f35c3b475e65575986a307
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Wed Dec 19 01:25:22 2007 +0900

    Added PKGBUILD parsing scripts

commit 2c3b556a9ee6933ec797024e9ed6beb1c441c9bc
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Nov 18 13:55:34 2007 +0900

    Allowed hyphens in package name

commit 9cfb1974d8e691d256126c23fe8d3c4aa90b1e40
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Nov 12 23:18:26 2007 +0900

    Removed unecessary dictionary

commit 0c829436c558aabd8ac0ab23bf4344e7079f57a3
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Nov 12 23:10:44 2007 +0900

    Fixed a few w3c compliancy errors

commit a75c747d39548c00cbc071960a2aea703eefaa4e
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Wed Oct 10 00:16:42 2007 +0800

    Added PKGBUILD field to Submit form

commit 8dff749b1a904ed896493e15eca5f7964485d4e9
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 22:23:44 2007 +0800

    Added basic Package Submit view, form and template

commit 5dd0f583bd035b2b5744a77b893f4d4dec9b6763
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 18:05:31 2007 +0800

    Added a note to read the AUR User Guidelines to the footer

commit f42af24b5e486afb53181345a7e6bb5aa5270b7c
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 17:42:46 2007 +0800

    Fixed a problem when res2 was None

commit 096326a73d11e20620afd6462247f9c47f1589a9
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 17:10:49 2007 +0800

    Added a message with help on making PKGBUILDs if a user has no packages

commit 1a3c20e91159ef17286948b273cb4249bdba52db
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 17:02:49 2007 +0800

    Added My Packages listing to profile and updated Account Details form

commit 5a0fa14b9e2104e4434ae9ec8e194f0c15c2c613
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 17:01:41 2007 +0800

    Login form redirects to profile page

commit c702a1906951e769c876cde424468f1e6c845eeb
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 17:01:01 2007 +0800

    Users can now modify their account details

commit c0b34a611ccfcfaafeef9982e659a35e1a248e64
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 14:40:03 2007 +0800

    Dependencies list shows "None" if a package has no dependencies

commit c40e39b7b1877336205e3d7e051aa28aeeec9dbe
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 13:17:59 2007 +0800

    Corrected some CSS nuisances

commit 07866d1dfe68a0e565ed4debd4e47627b71c9b6a
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 03:35:15 2007 +0800

    Removed Account link if user is not logged in. Fixed copyright symbol

commit 3da02da2635d21ee7b952ca3870943df5c553543
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 03:34:18 2007 +0800

    Added outdated indication

commit f19e05c525f6a39d2cce58c72f79577ea22397da
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 03:32:25 2007 +0800

    Added profile page

commit 3576051b9c9dca76f518e3bb61c863cd3f4609c6
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 02:48:16 2007 +0800

    Added outdated flag to Package

commit df87c49858bdf0034a77e4bcdd114747d5a97caf
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Tue Oct 9 00:22:18 2007 +0800

    Added account app for some account views. Fixed various things
    
    Added registration form and register link in the header

commit 1cde832071417e0d2463cf44e56ba450387c6244
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 18:23:55 2007 +0800

    Added login and logged_out views

commit 7d5279d4a8bb27328a48951dd79992b86445fcf0
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 16:35:57 2007 +0800

    Passed user to the search template

commit 4ed51035a2b9a3da8402269c6c22c60d838be94f
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 16:07:02 2007 +0800

    Fixed URL in Package and added a default value for deleted

commit c0f75044dd08eff864fbfce2ba729966bbfd0610
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 15:36:59 2007 +0800

    Fixed maintainer and dependencies listing

commit 76aa138c1e03f02d21a8643aa20dcb2955d248ce
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 15:08:21 2007 +0800

    Removed gap after the table when there is no pagination

commit e3c486cedb207c5288440000063b6d889e643cb3
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 15:01:25 2007 +0800

    Fixed the AUR tab. It is now selected.

commit 5afb1a46bfc66878a7a951462340ecde5ab9758b
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 14:38:04 2007 +0800

    Made searching more efficient if query is empty

commit 621588e8468ab3849c733386de70c457d9fe1551
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 14:18:02 2007 +0800

    Added has_pagination() to BetterPaginator and implemented in search

commit 2d93ea32eacbfd192d951f4cc0dfa3563d009b59
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 13:58:01 2007 +0800

    Fixed pagination url when page is not in GET

commit 9f928a99a60fb3782473215d58b157d40e03de04
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 13:49:45 2007 +0800

    Added a search form to all pages apart from the search page

commit 7e36e0e44a3386cd65fbbfc7f1efa73795c7b063
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 03:04:31 2007 +0800

    Added pagination
    
    The standard ObjectPaginator in Django is quite primative, so I imported a
    wrapper class.

commit 425f7daaa341d66b40216fc294634ff5fda786bf
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 00:35:33 2007 +0800

    Improved searching
    
    * Made query optional, as to allow a listing of all packages
    * Removed useless things from sort by
    * Changed some things like location for consitency
    * Searching by maintainer is now possible
    * Fixed restricting repositories
    * Can search for packages updated since lastupdate
    * Added sorting and sort order

commit 471de32d0be29e3c76dd1add2c92f15083580a7d
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Mon Oct 8 00:31:59 2007 +0800

    Removed package_archive generic view and replaced with search

commit 8fe7a5138ef01b1dac69c2e94239c4305ca3a320
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Oct 7 23:27:45 2007 +0800

    Rearranged fields to match the main site and current AUR
    
    Added a label for query to match the main site

commit 6d38b8442f8250183aecfcb025df97995325009f
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Oct 7 23:26:20 2007 +0800

    Aligned header text left

commit bb5f967e631c079bb3fc18c8cac84d0ddf73e440
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Oct 7 21:57:57 2007 +0800

    Searching now actually works.
    
    Only category and repository restricts, the other fields are not used
    yet.

commit 0b7a50032f055907f05d6ed9a690498124f1cd8d
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Oct 7 19:48:16 2007 +0800

    Added search template and removed some crap from views.py
    
    Removed various comments as the uncommented stuff works well.
    The view currently displays the search form well but doesn't do
    anything beyond that.

commit d0ecfd7a6f7ff971f957d9d16f9fb50ac571fdd1
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Oct 7 19:46:33 2007 +0800

    Changed repository and category to ChoiceField
    
    * Added labels
    * Made lastupdate not required

commit 1ad6cd5a2332605dae26e7ed5ed88e3197aae2d3
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Oct 6 03:10:40 2007 +0800

    Added urls for search and tidied them up a bit

commit f4f875619885668f76d57df7dfdeb621a5412f20
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Oct 6 03:09:56 2007 +0800

    Added the beginning of a search view

commit adc7e41b6b195be7cf076762b9ff0c223420ca58
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Thu Oct 4 18:57:47 2007 +0800

    Fixed a broken URL

commit f8774ff8ad1ed00cf914f646b998883a6e443e5f
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Thu Oct 4 18:43:20 2007 +0800

    Made Package.name a primary key

commit ade00694a3fea905b8aa3e969aa031b4e485d8d8
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Thu Oct 4 18:41:35 2007 +0800

    All templates requiring i18n now load the package
    
    It appears package loading is not inherited, so we need to load the
    i18n package in each template seperately

commit 8ab0ee9b85b58556c06d2d7cb60cda77441d78bb
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Thu Oct 4 18:14:47 2007 +0800

    Added Polish translation

commit 613bb21356468e33cf956ecbdf23625839abffc2
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Thu Oct 4 18:07:07 2007 +0800

    Changed "Location" to "Repository" for consistency

commit 5fec8ba088049b3a4801125a470f03c89e38b347
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Thu Oct 4 16:17:18 2007 +0800

    Added more internationalisation
    
    The base.html template now loads i18n instead of package_archive.html

commit 9ef0b177630d373e4a5d3c612c56d5659d113d2a
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Wed Oct 3 15:08:42 2007 +0800

    Added basic "Account details" template.
    
    Template still needs refining and a view to go with it, so we can add
    variables and such

commit d901a5c045dc1552d5322b38e193e7a5267c5b61
Author: Joerie de Gram <j.de.gram at gmail.com>
Date:   Mon Sep 17 16:02:41 2007 +0200

    Added i18n to package_archive

commit 83e61994d3776e061a20998f2cb11d48e38e8f12
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Sep 16 20:30:32 2007 +0800

    Added package_detail generic view.
    
    Added a link from package_archive to package_detail
    Added new url entry for it
    Removed pointless "/?" from urls

commit 6429ede8cb813dc376254dcd696142928fe74d11
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Sep 16 20:09:19 2007 +0800

    Added alternating row colours to table

commit a55f1e22983a0a71d51f89833c88c0dab8125b33
Author: Joerie de Gram <j.de.gram at gmail.com>
Date:   Sat Sep 15 21:40:33 2007 +0200

    Fixed package.maintainers assertion failure

commit f556f8ababbe18c82e81a9e573712dbc88a7763c
Author: Joerie de Gram <j.de.gram at gmail.com>
Date:   Sat Sep 15 20:18:39 2007 +0200

    Added Repository model plus fixtures

commit 0dfd6defedfe21ba2d283b2bffe0b652ccddadd7
Author: Joerie de Gram <j.de.gram at gmail.com>
Date:   Sat Sep 15 20:01:01 2007 +0200

    Reorganized package display in package_archive

commit ab78b2a104b598e0a9ef24982896a0aa730d51b6
Author: Joerie de Gram <j.de.gram at gmail.com>
Date:   Sat Sep 15 12:19:32 2007 +0200

    Added PackageHash, Comments models
    
    Models PackageHash and Comments have been added.
    Version and release have been added to Package.
    Architecture display in package admin has been made prettier.

commit 0de85b5fa4f39d96eef39bedcb3f1e61de1723e7
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Sep 15 14:33:50 2007 +0800

    Added description field to Package

commit ef8f7b9e9ab617c54ea78c8bc2a0ad78229e5653
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Sep 15 13:59:27 2007 +0800

    Added ordering to Package

commit eb81099aa686da9698856850bc8ccbb32a5edae5
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Sep 15 13:32:51 2007 +0800

    Use absolute paths for archlinux website and change order of navigation

commit e6fbe65ff88c9feba9425ba2f1ad3b39340aae93
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Sep 15 03:19:22 2007 +0800

    Added i686 and x86_64 architectures to initial data.

commit 905f03c28213c30b5d9c33eeaa2e48209fe22b74
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Sep 15 02:39:30 2007 +0800

    Started on a generic view of packages.

commit 2b21859d09df201c52d5fdc464ac69fe126e7a3e
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Sep 15 02:38:13 2007 +0800

    Removed auto_add* from models as they will be removed.

commit 08376363acd5279c913aab9e13d80c81b05f6a7e
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sat Sep 15 01:39:31 2007 +0800

    Added deleted, updated, added attributes to Package

commit c10f379ff82da01b1f01773e55aa8e8c9c7173e2
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Fri Sep 14 21:03:49 2007 +0800

    Added base template
    
    All templates will inherit from this one.

commit 84b3efea981a779e73ac4e688183fca87bb6dbac
Author: Joerie de Gram <j.de.gram at gmail.com>
Date:   Fri Sep 14 14:59:43 2007 +0200

    Initial commit

-----------------------------------------------------------------------


hooks/post-receive
-- 
Project aur2 at BerliOS


From icarnales at gmail.com  Sat Nov 14 22:19:29 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 19:19:29 -0200
Subject: [aur2-dev] [PATCH] changed ADMIN_MEDIA_PREFIX dir Signed-off-by:
	Ismael Carnales <icarnales@gmail.com>
Message-ID: <1258233569-5098-1-git-send-email-icarnales@gmail.com>

ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix

If they're equal like now, local media serving fails
---
 archlinux/settings.py |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/archlinux/settings.py b/archlinux/settings.py
index f809fee..1d9843e 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -32,7 +32,7 @@ MEDIA_URL = 'http://localhost:8000/media/'
 
 # URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
 # trailing slash.
-ADMIN_MEDIA_PREFIX = '/media/'
+ADMIN_MEDIA_PREFIX = '/media/admin_media/'
 
 # Make this unique, and don't share it with anybody.
 SECRET_KEY = ''
-- 
1.6.5.2



From djszapi at archlinux.us  Sat Nov 14 22:43:40 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 14 Nov 2009 22:43:40 +0100
Subject: [aur2-dev] [PATCH] changed ADMIN_MEDIA_PREFIX dir
	Signed-off-by: Ismael Carnales <icarnales@gmail.com>
In-Reply-To: <1258233569-5098-1-git-send-email-icarnales@gmail.com>
References: <1258233569-5098-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911141343k44f4b226xc615c0feef8423d5@mail.gmail.com>

On Sat, Nov 14, 2009 at 10:19 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
> http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix
>
> If they're equal like now, local media serving fails
> ---
> ?archlinux/settings.py | ? ?2 +-
> ?1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/archlinux/settings.py b/archlinux/settings.py
> index f809fee..1d9843e 100644
> --- a/archlinux/settings.py
> +++ b/archlinux/settings.py
> @@ -32,7 +32,7 @@ MEDIA_URL = 'http://localhost:8000/media/'
>
> ?# URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
> ?# trailing slash.
> -ADMIN_MEDIA_PREFIX = '/media/'
> +ADMIN_MEDIA_PREFIX = '/media/admin_media/'
>
> ?# Make this unique, and don't share it with anybody.
> ?SECRET_KEY = ''
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

Thanks the patch!

Something went wrong with it, because the 'Signed off' part is in the
subject, instead of above '---' and below your long comment. Could you
send it again please ?

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 14 22:48:11 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 19:48:11 -0200
Subject: [aur2-dev] [PATCH] reworked local settings Signed-off-by: Ismael
	Carnales <icarnales@gmail.com>
Message-ID: <1258235291-5913-1-git-send-email-icarnales@gmail.com>

moved default settings to local settings

defaults to settings for local devel should be provided in the local
settings file instead of the main settings.py file

renamed settings_local to local_settings

local_settings.py is the conventional name for the local settings
overrides file
---
 archlinux/local_settings.py.sample |   15 +++++++++++++++
 archlinux/settings.py              |   12 +-----------
 archlinux/settings_local.py.sample |   12 ------------
 3 files changed, 16 insertions(+), 23 deletions(-)
 create mode 100644 archlinux/local_settings.py.sample
 delete mode 100644 archlinux/settings_local.py.sample

diff --git a/archlinux/local_settings.py.sample b/archlinux/local_settings.py.sample
new file mode 100644
index 0000000..d7c549c
--- /dev/null
+++ b/archlinux/local_settings.py.sample
@@ -0,0 +1,15 @@
+DEBUG = True
+TEMPLATE_DEBUG = DEBUG
+
+ADMINS = (
+    # ('Your Name', 'your_email at domain.com'),
+)
+
+DATABASE_ENGINE = 'sqlite3'
+DATABASE_NAME = 'database.sqlite3'
+DATABASE_USER = ''             # Not used with sqlite3.
+DATABASE_PASSWORD = ''         # Not used with sqlite3.
+DATABASE_HOST = ''             # Set to empty string for localhost. Not used with sqlite3.
+DATABASE_PORT = ''             # Set to empty string for default. Not used with sqlite3.
+
+SECRET_KEY = ''
diff --git a/archlinux/settings.py b/archlinux/settings.py
index f809fee..32b261f 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -1,8 +1,5 @@
 import os.path
 
-DEBUG = True
-TEMPLATE_DEBUG = DEBUG
-
 DEPLOY_PATH = os.path.dirname(__file__) # This is the base dir for everything
 
 ADMINS = (
@@ -11,13 +8,6 @@ ADMINS = (
 
 MANAGERS = ADMINS
 
-DATABASE_ENGINE = 'sqlite3'
-DATABASE_NAME = 'database.sqlite3'
-DATABASE_USER = ''
-DATABASE_PASSWORD = ''
-DATABASE_HOST = ''
-DATABASE_PORT = ''
-
 TIME_ZONE = 'America/Chicago'
 
 LANGUAGE_CODE = 'en-us'
@@ -82,6 +72,6 @@ FORCE_LOWERCASE_TAGS = True
 
 # Import local settings if they exist
 try:
-    from settings_local import *
+    from local_settings import *
 except ImportError:
     pass
diff --git a/archlinux/settings_local.py.sample b/archlinux/settings_local.py.sample
deleted file mode 100644
index 8cebc2e..0000000
--- a/archlinux/settings_local.py.sample
+++ /dev/null
@@ -1,12 +0,0 @@
-ADMINS = (
-    # ('Your Name', 'your_email at domain.com'),
-)
-
-DATABASE_ENGINE = ''           # 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
-DATABASE_NAME = ''             # Or path to database file if using sqlite3.
-DATABASE_USER = ''             # Not used with sqlite3.
-DATABASE_PASSWORD = ''         # Not used with sqlite3.
-DATABASE_HOST = ''             # Set to empty string for localhost. Not used with sqlite3.
-DATABASE_PORT = ''             # Set to empty string for default. Not used with sqlite3.
-
-SECRET_KEY = ''
-- 
1.6.5.2



From djszapi at archlinux.us  Sat Nov 14 23:00:18 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 14 Nov 2009 23:00:18 +0100
Subject: [aur2-dev] [PATCH] reworked local settings Signed-off-by:
	Ismael Carnales <icarnales@gmail.com>
In-Reply-To: <1258235291-5913-1-git-send-email-icarnales@gmail.com>
References: <1258235291-5913-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911141400i1c8da5b3udc4d880e34b529de@mail.gmail.com>

On Sat, Nov 14, 2009 at 10:48 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> moved default settings to local settings
>
> defaults to settings for local devel should be provided in the local
> settings file instead of the main settings.py file
>
> renamed settings_local to local_settings
>
> local_settings.py is the conventional name for the local settings
> overrides file
> ---
> ?archlinux/local_settings.py.sample | ? 15 +++++++++++++++
> ?archlinux/settings.py ? ? ? ? ? ? ?| ? 12 +-----------
> ?archlinux/settings_local.py.sample | ? 12 ------------
> ?3 files changed, 16 insertions(+), 23 deletions(-)
> ?create mode 100644 archlinux/local_settings.py.sample
> ?delete mode 100644 archlinux/settings_local.py.sample
>
> diff --git a/archlinux/local_settings.py.sample b/archlinux/local_settings.py.sample
> new file mode 100644
> index 0000000..d7c549c
> --- /dev/null
> +++ b/archlinux/local_settings.py.sample
> @@ -0,0 +1,15 @@
> +DEBUG = True
> +TEMPLATE_DEBUG = DEBUG
> +
> +ADMINS = (
> + ? ?# ('Your Name', 'your_email at domain.com'),
> +)
> +
> +DATABASE_ENGINE = 'sqlite3'
> +DATABASE_NAME = 'database.sqlite3'
> +DATABASE_USER = '' ? ? ? ? ? ? # Not used with sqlite3.
> +DATABASE_PASSWORD = '' ? ? ? ? # Not used with sqlite3.
> +DATABASE_HOST = '' ? ? ? ? ? ? # Set to empty string for localhost. Not used with sqlite3.
> +DATABASE_PORT = '' ? ? ? ? ? ? # Set to empty string for default. Not used with sqlite3.
> +
> +SECRET_KEY = ''
> diff --git a/archlinux/settings.py b/archlinux/settings.py
> index f809fee..32b261f 100644
> --- a/archlinux/settings.py
> +++ b/archlinux/settings.py
> @@ -1,8 +1,5 @@
> ?import os.path
>
> -DEBUG = True
> -TEMPLATE_DEBUG = DEBUG
> -
> ?DEPLOY_PATH = os.path.dirname(__file__) # This is the base dir for everything
>
> ?ADMINS = (
> @@ -11,13 +8,6 @@ ADMINS = (
>
> ?MANAGERS = ADMINS
>
> -DATABASE_ENGINE = 'sqlite3'
> -DATABASE_NAME = 'database.sqlite3'
> -DATABASE_USER = ''
> -DATABASE_PASSWORD = ''
> -DATABASE_HOST = ''
> -DATABASE_PORT = ''
> -
> ?TIME_ZONE = 'America/Chicago'
>
> ?LANGUAGE_CODE = 'en-us'
> @@ -82,6 +72,6 @@ FORCE_LOWERCASE_TAGS = True
>
> ?# Import local settings if they exist
> ?try:
> - ? ?from settings_local import *
> + ? ?from local_settings import *
> ?except ImportError:
> ? ? pass
> diff --git a/archlinux/settings_local.py.sample b/archlinux/settings_local.py.sample
> deleted file mode 100644
> index 8cebc2e..0000000
> --- a/archlinux/settings_local.py.sample
> +++ /dev/null
> @@ -1,12 +0,0 @@
> -ADMINS = (
> - ? ?# ('Your Name', 'your_email at domain.com'),
> -)
> -
> -DATABASE_ENGINE = '' ? ? ? ? ? # 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
> -DATABASE_NAME = '' ? ? ? ? ? ? # Or path to database file if using sqlite3.
> -DATABASE_USER = '' ? ? ? ? ? ? # Not used with sqlite3.
> -DATABASE_PASSWORD = '' ? ? ? ? # Not used with sqlite3.
> -DATABASE_HOST = '' ? ? ? ? ? ? # Set to empty string for localhost. Not used with sqlite3.
> -DATABASE_PORT = '' ? ? ? ? ? ? # Set to empty string for default. Not used with sqlite3.
> -
> -SECRET_KEY = ''
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

Same issue appears here with 'Signed Off' tag. Maybe it's worth to fix
it before submitting more patches, because you will need to send again
all of them.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 14 23:00:21 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:00:21 -0200
Subject: [aur2-dev] [PATCH] changed ADMIN_MEDIA_PREFIX dir
Message-ID: <1258236021-6286-1-git-send-email-icarnales@gmail.com>

ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix

If they're equal like now, local media serving fails

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/settings.py |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/archlinux/settings.py b/archlinux/settings.py
index f809fee..1d9843e 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -32,7 +32,7 @@ MEDIA_URL = 'http://localhost:8000/media/'
 
 # URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
 # trailing slash.
-ADMIN_MEDIA_PREFIX = '/media/'
+ADMIN_MEDIA_PREFIX = '/media/admin_media/'
 
 # Make this unique, and don't share it with anybody.
 SECRET_KEY = ''
-- 
1.6.5.2



From icarnales at gmail.com  Sat Nov 14 23:05:48 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:05:48 -0200
Subject: [aur2-dev] [PATCH] changed ADMIN_MEDIA_PREFIX dir
	Signed-off-by: Ismael Carnales <icarnales@gmail.com>
In-Reply-To: <a362e8010911141343k44f4b226xc615c0feef8423d5@mail.gmail.com>
References: <1258233569-5098-1-git-send-email-icarnales@gmail.com> 
	<a362e8010911141343k44f4b226xc615c0feef8423d5@mail.gmail.com>
Message-ID: <d83f7a8d0911141405j30ae89e7u59a52756172f431c@mail.gmail.com>

Fixed. Resent the patch, bye!

On Sat, Nov 14, 2009 at 7:43 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 14, 2009 at 10:19 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
>> http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix
>>
>> If they're equal like now, local media serving fails
>> ---
>> ?archlinux/settings.py | ? ?2 +-
>> ?1 files changed, 1 insertions(+), 1 deletions(-)
>>
>> diff --git a/archlinux/settings.py b/archlinux/settings.py
>> index f809fee..1d9843e 100644
>> --- a/archlinux/settings.py
>> +++ b/archlinux/settings.py
>> @@ -32,7 +32,7 @@ MEDIA_URL = 'http://localhost:8000/media/'
>>
>> ?# URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
>> ?# trailing slash.
>> -ADMIN_MEDIA_PREFIX = '/media/'
>> +ADMIN_MEDIA_PREFIX = '/media/admin_media/'
>>
>> ?# Make this unique, and don't share it with anybody.
>> ?SECRET_KEY = ''
>> --
>> 1.6.5.2
>>
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>
> Thanks the patch!
>
> Something went wrong with it, because the 'Signed off' part is in the
> subject, instead of above '---' and below your long comment. Could you
> send it again please ?
>
> Best Regards,
> Laszlo Papp
>


From icarnales at gmail.com  Sat Nov 14 23:03:05 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:03:05 -0200
Subject: [aur2-dev] [PATCH] reworked local settings
Message-ID: <1258236185-6399-1-git-send-email-icarnales@gmail.com>

moved default settings to local settings

defaults to settings for local devel should be provided in the local
settings file instead of the main settings.py file

renamed settings_local to local_settings

local_settings.py is the conventional name for the local settings
overrides file

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/local_settings.py.sample |   15 +++++++++++++++
 archlinux/settings.py              |   12 +-----------
 archlinux/settings_local.py.sample |   12 ------------
 3 files changed, 16 insertions(+), 23 deletions(-)
 create mode 100644 archlinux/local_settings.py.sample
 delete mode 100644 archlinux/settings_local.py.sample

diff --git a/archlinux/local_settings.py.sample b/archlinux/local_settings.py.sample
new file mode 100644
index 0000000..d7c549c
--- /dev/null
+++ b/archlinux/local_settings.py.sample
@@ -0,0 +1,15 @@
+DEBUG = True
+TEMPLATE_DEBUG = DEBUG
+
+ADMINS = (
+    # ('Your Name', 'your_email at domain.com'),
+)
+
+DATABASE_ENGINE = 'sqlite3'
+DATABASE_NAME = 'database.sqlite3'
+DATABASE_USER = ''             # Not used with sqlite3.
+DATABASE_PASSWORD = ''         # Not used with sqlite3.
+DATABASE_HOST = ''             # Set to empty string for localhost. Not used with sqlite3.
+DATABASE_PORT = ''             # Set to empty string for default. Not used with sqlite3.
+
+SECRET_KEY = ''
diff --git a/archlinux/settings.py b/archlinux/settings.py
index f809fee..32b261f 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -1,8 +1,5 @@
 import os.path
 
-DEBUG = True
-TEMPLATE_DEBUG = DEBUG
-
 DEPLOY_PATH = os.path.dirname(__file__) # This is the base dir for everything
 
 ADMINS = (
@@ -11,13 +8,6 @@ ADMINS = (
 
 MANAGERS = ADMINS
 
-DATABASE_ENGINE = 'sqlite3'
-DATABASE_NAME = 'database.sqlite3'
-DATABASE_USER = ''
-DATABASE_PASSWORD = ''
-DATABASE_HOST = ''
-DATABASE_PORT = ''
-
 TIME_ZONE = 'America/Chicago'
 
 LANGUAGE_CODE = 'en-us'
@@ -82,6 +72,6 @@ FORCE_LOWERCASE_TAGS = True
 
 # Import local settings if they exist
 try:
-    from settings_local import *
+    from local_settings import *
 except ImportError:
     pass
diff --git a/archlinux/settings_local.py.sample b/archlinux/settings_local.py.sample
deleted file mode 100644
index 8cebc2e..0000000
--- a/archlinux/settings_local.py.sample
+++ /dev/null
@@ -1,12 +0,0 @@
-ADMINS = (
-    # ('Your Name', 'your_email at domain.com'),
-)
-
-DATABASE_ENGINE = ''           # 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
-DATABASE_NAME = ''             # Or path to database file if using sqlite3.
-DATABASE_USER = ''             # Not used with sqlite3.
-DATABASE_PASSWORD = ''         # Not used with sqlite3.
-DATABASE_HOST = ''             # Set to empty string for localhost. Not used with sqlite3.
-DATABASE_PORT = ''             # Set to empty string for default. Not used with sqlite3.
-
-SECRET_KEY = ''
-- 
1.6.5.2



From icarnales at gmail.com  Sat Nov 14 23:08:06 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:08:06 -0200
Subject: [aur2-dev] [PATCH] reworked local settings Signed-off-by:
	Ismael Carnales <icarnales@gmail.com>
In-Reply-To: <a362e8010911141400i1c8da5b3udc4d880e34b529de@mail.gmail.com>
References: <1258235291-5913-1-git-send-email-icarnales@gmail.com> 
	<a362e8010911141400i1c8da5b3udc4d880e34b529de@mail.gmail.com>
Message-ID: <d83f7a8d0911141408t699beb71h9545e344a5b02864@mail.gmail.com>

Fixed and resent, bye!

On Sat, Nov 14, 2009 at 8:00 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 14, 2009 at 10:48 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> moved default settings to local settings
>>
>> defaults to settings for local devel should be provided in the local
>> settings file instead of the main settings.py file
>>
>> renamed settings_local to local_settings
>>
>> local_settings.py is the conventional name for the local settings
>> overrides file
>> ---
>> ?archlinux/local_settings.py.sample | ? 15 +++++++++++++++
>> ?archlinux/settings.py ? ? ? ? ? ? ?| ? 12 +-----------
>> ?archlinux/settings_local.py.sample | ? 12 ------------
>> ?3 files changed, 16 insertions(+), 23 deletions(-)
>> ?create mode 100644 archlinux/local_settings.py.sample
>> ?delete mode 100644 archlinux/settings_local.py.sample
>>
>> diff --git a/archlinux/local_settings.py.sample b/archlinux/local_settings.py.sample
>> new file mode 100644
>> index 0000000..d7c549c
>> --- /dev/null
>> +++ b/archlinux/local_settings.py.sample
>> @@ -0,0 +1,15 @@
>> +DEBUG = True
>> +TEMPLATE_DEBUG = DEBUG
>> +
>> +ADMINS = (
>> + ? ?# ('Your Name', 'your_email at domain.com'),
>> +)
>> +
>> +DATABASE_ENGINE = 'sqlite3'
>> +DATABASE_NAME = 'database.sqlite3'
>> +DATABASE_USER = '' ? ? ? ? ? ? # Not used with sqlite3.
>> +DATABASE_PASSWORD = '' ? ? ? ? # Not used with sqlite3.
>> +DATABASE_HOST = '' ? ? ? ? ? ? # Set to empty string for localhost. Not used with sqlite3.
>> +DATABASE_PORT = '' ? ? ? ? ? ? # Set to empty string for default. Not used with sqlite3.
>> +
>> +SECRET_KEY = ''
>> diff --git a/archlinux/settings.py b/archlinux/settings.py
>> index f809fee..32b261f 100644
>> --- a/archlinux/settings.py
>> +++ b/archlinux/settings.py
>> @@ -1,8 +1,5 @@
>> ?import os.path
>>
>> -DEBUG = True
>> -TEMPLATE_DEBUG = DEBUG
>> -
>> ?DEPLOY_PATH = os.path.dirname(__file__) # This is the base dir for everything
>>
>> ?ADMINS = (
>> @@ -11,13 +8,6 @@ ADMINS = (
>>
>> ?MANAGERS = ADMINS
>>
>> -DATABASE_ENGINE = 'sqlite3'
>> -DATABASE_NAME = 'database.sqlite3'
>> -DATABASE_USER = ''
>> -DATABASE_PASSWORD = ''
>> -DATABASE_HOST = ''
>> -DATABASE_PORT = ''
>> -
>> ?TIME_ZONE = 'America/Chicago'
>>
>> ?LANGUAGE_CODE = 'en-us'
>> @@ -82,6 +72,6 @@ FORCE_LOWERCASE_TAGS = True
>>
>> ?# Import local settings if they exist
>> ?try:
>> - ? ?from settings_local import *
>> + ? ?from local_settings import *
>> ?except ImportError:
>> ? ? pass
>> diff --git a/archlinux/settings_local.py.sample b/archlinux/settings_local.py.sample
>> deleted file mode 100644
>> index 8cebc2e..0000000
>> --- a/archlinux/settings_local.py.sample
>> +++ /dev/null
>> @@ -1,12 +0,0 @@
>> -ADMINS = (
>> - ? ?# ('Your Name', 'your_email at domain.com'),
>> -)
>> -
>> -DATABASE_ENGINE = '' ? ? ? ? ? # 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
>> -DATABASE_NAME = '' ? ? ? ? ? ? # Or path to database file if using sqlite3.
>> -DATABASE_USER = '' ? ? ? ? ? ? # Not used with sqlite3.
>> -DATABASE_PASSWORD = '' ? ? ? ? # Not used with sqlite3.
>> -DATABASE_HOST = '' ? ? ? ? ? ? # Set to empty string for localhost. Not used with sqlite3.
>> -DATABASE_PORT = '' ? ? ? ? ? ? # Set to empty string for default. Not used with sqlite3.
>> -
>> -SECRET_KEY = ''
>> --
>> 1.6.5.2
>>
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>
> Same issue appears here with 'Signed Off' tag. Maybe it's worth to fix
> it before submitting more patches, because you will need to send again
> all of them.
>
> Best Regards,
> Laszlo Papp
>


From djszapi at archlinux.us  Sat Nov 14 23:19:07 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 14 Nov 2009 23:19:07 +0100
Subject: [aur2-dev] [PATCH] reworked local settings Signed-off-by:
	Ismael Carnales <icarnales@gmail.com>
In-Reply-To: <d83f7a8d0911141408t699beb71h9545e344a5b02864@mail.gmail.com>
References: <1258235291-5913-1-git-send-email-icarnales@gmail.com>
	<a362e8010911141400i1c8da5b3udc4d880e34b529de@mail.gmail.com>
	<d83f7a8d0911141408t699beb71h9545e344a5b02864@mail.gmail.com>
Message-ID: <a362e8010911141419y17d1c3fexaee9ab72b9832786@mail.gmail.com>

On Sat, Nov 14, 2009 at 11:08 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Fixed and resent, bye!
>

One small thing yet. If you send a patch with git-send-email after a
suggestion/recommandation, you can check the Message-ID of the email
for that you try to answer and add this message-id to the
--in-reply-to option of git-send-email command, and the mail can be
seen in the same thread, not in a separate one.

No need to send again because of this now, but next time it can be helpful.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 14 23:23:00 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:23:00 -0200
Subject: [aur2-dev] [PATCH] reworked local settings Signed-off-by:
	Ismael Carnales <icarnales@gmail.com>
In-Reply-To: <a362e8010911141419y17d1c3fexaee9ab72b9832786@mail.gmail.com>
References: <1258235291-5913-1-git-send-email-icarnales@gmail.com> 
	<a362e8010911141400i1c8da5b3udc4d880e34b529de@mail.gmail.com> 
	<d83f7a8d0911141408t699beb71h9545e344a5b02864@mail.gmail.com> 
	<a362e8010911141419y17d1c3fexaee9ab72b9832786@mail.gmail.com>
Message-ID: <d83f7a8d0911141423i7f0a2adau62db08571a838e34@mail.gmail.com>

Excellent, I'll use it next time, I'm still new to git, bye!

On Sat, Nov 14, 2009 at 8:19 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 14, 2009 at 11:08 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> Fixed and resent, bye!
>>
>
> One small thing yet. If you send a patch with git-send-email after a
> suggestion/recommandation, you can check the Message-ID of the email
> for that you try to answer and add this message-id to the
> --in-reply-to option of git-send-email command, and the mail can be
> seen in the same thread, not in a separate one.
>
> No need to send again because of this now, but next time it can be helpful.
>
> Best Regards,
> Laszlo Papp
>


From djszapi at archlinux.us  Sat Nov 14 23:30:30 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 14 Nov 2009 23:30:30 +0100
Subject: [aur2-dev] [PATCH] changed ADMIN_MEDIA_PREFIX dir
In-Reply-To: <1258236021-6286-1-git-send-email-icarnales@gmail.com>
References: <1258236021-6286-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911141430v4892500cnebf054f1d787e7e2@mail.gmail.com>

On Sat, Nov 14, 2009 at 11:00 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
> http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix
>
> If they're equal like now, local media serving fails
>
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> ?archlinux/settings.py | ? ?2 +-
> ?1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/archlinux/settings.py b/archlinux/settings.py
> index f809fee..1d9843e 100644
> --- a/archlinux/settings.py
> +++ b/archlinux/settings.py
> @@ -32,7 +32,7 @@ MEDIA_URL = 'http://localhost:8000/media/'
>
> ?# URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
> ?# trailing slash.
> -ADMIN_MEDIA_PREFIX = '/media/'
> +ADMIN_MEDIA_PREFIX = '/media/admin_media/'
>
> ?# Make this unique, and don't share it with anybody.
> ?SECRET_KEY = ''
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

* I prefer imperative words like 'Change' instead of 'changed', if you
read the git documentation here you will see the best practice (12-13
lines).
http://repo.or.cz/w/git.git/blob/HEAD:/Documentation/SubmittingPatches

* Is ADMIN_MEDIA_PREFIX = '/media/admin/' better ?

*  MEDIA_URL = 'http://localhost:8000/media/' -> MEDIA_URL = '/media/' ?

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 14 23:35:35 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:35:35 -0200
Subject: [aur2-dev] [PATCH] changed ADMIN_MEDIA_PREFIX dir
In-Reply-To: <a362e8010911141430v4892500cnebf054f1d787e7e2@mail.gmail.com>
References: <1258236021-6286-1-git-send-email-icarnales@gmail.com> 
	<a362e8010911141430v4892500cnebf054f1d787e7e2@mail.gmail.com>
Message-ID: <d83f7a8d0911141435q1df5e1a9scc05b73023cb78e2@mail.gmail.com>

On Sat, Nov 14, 2009 at 8:30 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 14, 2009 at 11:00 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
>> http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix
>>
>> If they're equal like now, local media serving fails
>>
>> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
>> ---
>> ?archlinux/settings.py | ? ?2 +-
>> ?1 files changed, 1 insertions(+), 1 deletions(-)
>>
>> diff --git a/archlinux/settings.py b/archlinux/settings.py
>> index f809fee..1d9843e 100644
>> --- a/archlinux/settings.py
>> +++ b/archlinux/settings.py
>> @@ -32,7 +32,7 @@ MEDIA_URL = 'http://localhost:8000/media/'
>>
>> ?# URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
>> ?# trailing slash.
>> -ADMIN_MEDIA_PREFIX = '/media/'
>> +ADMIN_MEDIA_PREFIX = '/media/admin_media/'
>>
>> ?# Make this unique, and don't share it with anybody.
>> ?SECRET_KEY = ''
>> --
>> 1.6.5.2
>>
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>
> * I prefer imperative words like 'Change' instead of 'changed', if you
> read the git documentation here you will see the best practice (12-13
> lines).
> http://repo.or.cz/w/git.git/blob/HEAD:/Documentation/SubmittingPatches

I'll read the guidelines an apply them to patches.

>
> * Is ADMIN_MEDIA_PREFIX = '/media/admin/' better ?
>
> * ?MEDIA_URL = 'http://localhost:8000/media/' -> MEDIA_URL = '/media/' ?
>

Your second guess is right, actually it should be changed to '/media'/
as you point.

ADMIN_MEDIA_PREFIX must be different than MEDIA_URL, right now it
isn't beign used (as there isn't custom admin media) so any new url
will do the trick. But putting the admin media inside of the general
media folder is a good organization I think.

Should I resend the patch with this changes?

> Best Regards,
> Laszlo Papp
>


From djszapi at archlinux.us  Sat Nov 14 23:42:39 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 14 Nov 2009 23:42:39 +0100
Subject: [aur2-dev] [PATCH] changed ADMIN_MEDIA_PREFIX dir
In-Reply-To: <d83f7a8d0911141435q1df5e1a9scc05b73023cb78e2@mail.gmail.com>
References: <1258236021-6286-1-git-send-email-icarnales@gmail.com>
	<a362e8010911141430v4892500cnebf054f1d787e7e2@mail.gmail.com>
	<d83f7a8d0911141435q1df5e1a9scc05b73023cb78e2@mail.gmail.com>
Message-ID: <a362e8010911141442q480edbd0le0d5085d2c7b3040@mail.gmail.com>

> Should I resend the patch with this changes?

Yeah, and I will apply them.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 14 23:48:16 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:48:16 -0200
Subject: [aur2-dev] [PATCH] change ADMIN_MEDIA_PREFIX dir
In-Reply-To: <a362e8010911141442q480edbd0le0d5085d2c7b3040@mail.gmail.com>
References: <a362e8010911141442q480edbd0le0d5085d2c7b3040@mail.gmail.com>
Message-ID: <1258238896-6602-1-git-send-email-icarnales@gmail.com>

ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix

If they're equal like now, local media serving fails

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/settings.py |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/archlinux/settings.py b/archlinux/settings.py
index f809fee..1dbc233 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -28,11 +28,11 @@ USE_I18N = True
 
 # Absolute path to the directory that holds media.
 MEDIA_ROOT = os.path.join(DEPLOY_PATH, 'media')
-MEDIA_URL = 'http://localhost:8000/media/'
+MEDIA_URL = '/media/'
 
 # URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
 # trailing slash.
-ADMIN_MEDIA_PREFIX = '/media/'
+ADMIN_MEDIA_PREFIX = '/media/admin/'
 
 # Make this unique, and don't share it with anybody.
 SECRET_KEY = ''
-- 
1.6.5.2



From icarnales at gmail.com  Sat Nov 14 23:55:47 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 20:55:47 -0200
Subject: [aur2-dev] [PATCH] change ADMIN_MEDIA_PREFIX dir
In-Reply-To: <1258238896-6602-1-git-send-email-icarnales@gmail.com>
References: <a362e8010911141442q480edbd0le0d5085d2c7b3040@mail.gmail.com> 
	<1258238896-6602-1-git-send-email-icarnales@gmail.com>
Message-ID: <d83f7a8d0911141455h140e998fr2b3b193a3d0f79d@mail.gmail.com>

Damn, added the message id of your last reply in git send-email but
gmail isn't showing it in the thread (look at the in reply to header).
Do you know what went wong?

On Sat, Nov 14, 2009 at 8:48 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
> http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix
>
> If they're equal like now, local media serving fails
>
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> ?archlinux/settings.py | ? ?4 ++--
> ?1 files changed, 2 insertions(+), 2 deletions(-)
>
> diff --git a/archlinux/settings.py b/archlinux/settings.py
> index f809fee..1dbc233 100644
> --- a/archlinux/settings.py
> +++ b/archlinux/settings.py
> @@ -28,11 +28,11 @@ USE_I18N = True
>
> ?# Absolute path to the directory that holds media.
> ?MEDIA_ROOT = os.path.join(DEPLOY_PATH, 'media')
> -MEDIA_URL = 'http://localhost:8000/media/'
> +MEDIA_URL = '/media/'
>
> ?# URL prefix for admin media -- CSS, JavaScript and images. Make sure to use a
> ?# trailing slash.
> -ADMIN_MEDIA_PREFIX = '/media/'
> +ADMIN_MEDIA_PREFIX = '/media/admin/'
>
> ?# Make this unique, and don't share it with anybody.
> ?SECRET_KEY = ''
> --
> 1.6.5.2
>
>


From icarnales at gmail.com  Sun Nov 15 00:14:42 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 21:14:42 -0200
Subject: [aur2-dev] [PATCH] reworked local settings
In-Reply-To: <a362e8010911141504g42ade885v1c842f364d2c17fa@mail.gmail.com>
References: <1258236185-6399-1-git-send-email-icarnales@gmail.com> 
	<a362e8010911141504g42ade885v1c842f364d2c17fa@mail.gmail.com>
Message-ID: <d83f7a8d0911141514g6b3c31c2je78a746870eb71de@mail.gmail.com>

On Sat, Nov 14, 2009 at 9:04 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
>> renamed settings_local to local_settings
>>
>> local_settings.py is the conventional name for the local settings
>> overrides file
>>
>
> If I see well, this patch is about renaming. What's the real benefit of this ?
>

This patch could be really splitted in two patches, actually is a
rebase squishing two commits.

The first part moves some default settings that shouldn't be in the
main setting.py file to the local settings file.

The second part renames settings_local.py to local_setting.py this is
the conventional name (as in good practices) for the local settings
file, you can see it in the django conventions site for example:
http://ericholscher.com/projects/reusable-app-docs/projects/settings.html

bye!

> Best Regards,
> Laszlo Papp
>


From djszapi at archlinux.us  Sun Nov 15 00:28:58 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sun, 15 Nov 2009 00:28:58 +0100
Subject: [aur2-dev] [PATCH] reworked local settings
In-Reply-To: <d83f7a8d0911141514g6b3c31c2je78a746870eb71de@mail.gmail.com>
References: <1258236185-6399-1-git-send-email-icarnales@gmail.com>
	<a362e8010911141504g42ade885v1c842f364d2c17fa@mail.gmail.com>
	<d83f7a8d0911141514g6b3c31c2je78a746870eb71de@mail.gmail.com>
Message-ID: <a362e8010911141528p566f15e4j8c6f9e1d62bfea6c@mail.gmail.com>

On Sun, Nov 15, 2009 at 12:14 AM, Ismael Carnales <icarnales at gmail.com> wrote:
> On Sat, Nov 14, 2009 at 9:04 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
>>> renamed settings_local to local_settings
>>>
>>> local_settings.py is the conventional name for the local settings
>>> overrides file
>>>
>>
>> If I see well, this patch is about renaming. What's the real benefit of this ?
>>
>
> This patch could be really splitted in two patches, actually is a
> rebase squishing two commits.
>
> The first part moves some default settings that shouldn't be in the
> main setting.py file to the local settings file.
>

Agreed.

> The second part renames settings_local.py to local_setting.py this is
> the conventional name (as in good practices) for the local settings
> file, you can see it in the django conventions site for example:
> http://ericholscher.com/projects/reusable-app-docs/projects/settings.html
>

It's just an 1-2 lines snippet, I can show you example for settings_* too :)
http://www.bearfruit.org/blog/2008/05/28/multiple-django-configurations-for-development-and-production

The current name seems for me more logical, maybe Sebastian choosed
this one because of this, I'd preserve Sebastian's work.

If you send again the first part of patch alone, I will apply it,
because it's a good patch so in my opinion.

PS: Don't forget reworked -> Refactor in the subject.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sun Nov 15 00:53:32 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 21:53:32 -0200
Subject: [aur2-dev] [PATCH] Move default settings to local settings
In-Reply-To: <a362e8010911141528p566f15e4j8c6f9e1d62bfea6c@mail.gmail.com>
References: <a362e8010911141528p566f15e4j8c6f9e1d62bfea6c@mail.gmail.com>
Message-ID: <1258242812-7434-1-git-send-email-icarnales@gmail.com>

Defaults to settings for local devel should be provided in the local
settings file instead of the main settings.py file

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/settings.py              |   10 ----------
 archlinux/settings_local.py.sample |    7 +++++--
 2 files changed, 5 insertions(+), 12 deletions(-)

diff --git a/archlinux/settings.py b/archlinux/settings.py
index f809fee..3f463e1 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -1,8 +1,5 @@
 import os.path
 
-DEBUG = True
-TEMPLATE_DEBUG = DEBUG
-
 DEPLOY_PATH = os.path.dirname(__file__) # This is the base dir for everything
 
 ADMINS = (
@@ -11,13 +8,6 @@ ADMINS = (
 
 MANAGERS = ADMINS
 
-DATABASE_ENGINE = 'sqlite3'
-DATABASE_NAME = 'database.sqlite3'
-DATABASE_USER = ''
-DATABASE_PASSWORD = ''
-DATABASE_HOST = ''
-DATABASE_PORT = ''
-
 TIME_ZONE = 'America/Chicago'
 
 LANGUAGE_CODE = 'en-us'
diff --git a/archlinux/settings_local.py.sample b/archlinux/settings_local.py.sample
index 8cebc2e..d7c549c 100644
--- a/archlinux/settings_local.py.sample
+++ b/archlinux/settings_local.py.sample
@@ -1,9 +1,12 @@
+DEBUG = True
+TEMPLATE_DEBUG = DEBUG
+
 ADMINS = (
     # ('Your Name', 'your_email at domain.com'),
 )
 
-DATABASE_ENGINE = ''           # 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
-DATABASE_NAME = ''             # Or path to database file if using sqlite3.
+DATABASE_ENGINE = 'sqlite3'
+DATABASE_NAME = 'database.sqlite3'
 DATABASE_USER = ''             # Not used with sqlite3.
 DATABASE_PASSWORD = ''         # Not used with sqlite3.
 DATABASE_HOST = ''             # Set to empty string for localhost. Not used with sqlite3.
-- 
1.6.5.2



From icarnales at gmail.com  Sun Nov 15 00:57:39 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 14 Nov 2009 21:57:39 -0200
Subject: [aur2-dev] [PATCH] Replace tabs by spaces in urls.py
Message-ID: <1258243059-7586-1-git-send-email-icarnales@gmail.com>

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/urls.py |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/archlinux/urls.py b/archlinux/urls.py
index e56fc75..de3a92d 100644
--- a/archlinux/urls.py
+++ b/archlinux/urls.py
@@ -12,8 +12,8 @@ urlpatterns = patterns('',
 )
 
 if settings.DEBUG == True:
-	urlpatterns += patterns('',
-		(r'^media/(.*)$', 'django.views.static.serve', {
-		    'document_root': settings.MEDIA_ROOT
-		})
-	)
+    urlpatterns += patterns('',
+        (r'^media/(.*)$', 'django.views.static.serve', {
+            'document_root': settings.MEDIA_ROOT
+        })
+    )
-- 
1.6.5.2



From djszapi at archlinux.us  Sun Nov 15 01:23:31 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sun, 15 Nov 2009 01:23:31 +0100
Subject: [aur2-dev] [PATCH] Replace tabs by spaces in urls.py
In-Reply-To: <1258243059-7586-1-git-send-email-icarnales@gmail.com>
References: <1258243059-7586-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911141623q4bdf6c9cge54ee79b22748559@mail.gmail.com>

On Sun, Nov 15, 2009 at 12:57 AM, Ismael Carnales <icarnales at gmail.com> wrote:
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> ?archlinux/urls.py | ? 10 +++++-----
> ?1 files changed, 5 insertions(+), 5 deletions(-)
>
> diff --git a/archlinux/urls.py b/archlinux/urls.py
> index e56fc75..de3a92d 100644
> --- a/archlinux/urls.py
> +++ b/archlinux/urls.py
> @@ -12,8 +12,8 @@ urlpatterns = patterns('',
> ?)
>
> ?if settings.DEBUG == True:
> - ? ? ? urlpatterns += patterns('',
> - ? ? ? ? ? ? ? (r'^media/(.*)$', 'django.views.static.serve', {
> - ? ? ? ? ? ? ? ? ? 'document_root': settings.MEDIA_ROOT
> - ? ? ? ? ? ? ? })
> - ? ? ? )
> + ? ?urlpatterns += patterns('',
> + ? ? ? ?(r'^media/(.*)$', 'django.views.static.serve', {
> + ? ? ? ? ? ?'document_root': settings.MEDIA_ROOT
> + ? ? ? ?})
> + ? ?)
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

You're absolutely okay with this patch, but the only reason for
rejecting that I applied it today in my working branch :( I started to
correct the issues in the current project with pylint checker, so
sorry I didn't push it until now, because I will push more files
together soon.I will do soon a gitweb for my local branch before
pushing it to the main central repository to avoid such a situations,
sorry once more time.

Best Regards,
Laszlo Papp


From sebnow at gmail.com  Sun Nov 15 04:29:18 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sun, 15 Nov 2009 11:29:18 +0800
Subject: [aur2-dev] Branches
References: <5F14C167-BF3C-4F6C-A6B9-5858B3CE2D69@gmail.com>
Message-ID: <8B469397-9A5F-455F-9778-08536861F0E6@gmail.com>

Hi,

I'm not sure if I mentioned this, but contributors should be looking  
at my "pkgbuild" branch[1], rather than the master, as it's more up-to- 
date (just not completely finished). It's probably messy and buggy,  
and I apologise for that. I pushed that branch in a hurry.

I'm not sure whether it would be better for someone to continue  
working on the branch and then to rebase on master and merge, or if it  
would be better to just merge now and fix issues later. I'd say the  
former, but someone would have to take up a huge task to refactor the  
PKGBUILD uploading logic.

It's great to finally see some contributions.

[1] http://github.com/sebnow/aur2/tree/pkgbuild




From djszapi at archlinux.us  Sun Nov 15 08:02:10 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Sun, 15 Nov 2009 08:02:10 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 19c740c3cdd90053cb50326cd339f53569cd189d
Message-ID: <200911150702.nAF72AQ8031843@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  19c740c3cdd90053cb50326cd339f53569cd189d (commit)
       via  27d95460c4176bcb8efa2016d4bb8a0d909ac8fa (commit)
       via  882f54aeacd17692baa4e2929302f27641d2e7c0 (commit)
       via  4f47635b8a0434b07732e8511f6fbcd733bea198 (commit)
       via  a556a293d76ad90e74c530ad9ea07e95d65ca70c (commit)
      from  2da02900756ced2e08da28b4e178fadc7a90f5cf (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 19c740c3cdd90053cb50326cd339f53569cd189d
Author: Ismael Carnales <icarnales at gmail.com>
Date:   Sat Nov 14 21:53:32 2009 -0200

    Move default settings to local settings
    
    Defaults to settings for local devel should be provided in the local
    settings file instead of the main settings.py file
    
    Signed-off-by: Ismael Carnales <icarnales at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 27d95460c4176bcb8efa2016d4bb8a0d909ac8fa
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 15 08:00:01 2009 +0100

    Change MEDIA_URL path
    
    * Change for '/media/' instead of 'http://localhost:8000/media/', because it's
    not a good coding practice to code hard 'localhost' and the '8000' port into it.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 882f54aeacd17692baa4e2929302f27641d2e7c0
Author: Ismael Carnales <icarnales at gmail.com>
Date:   Sat Nov 14 20:48:16 2009 -0200

    change ADMIN_MEDIA_PREFIX dir
    
    ADMIN_MEDIA_PREFIX should be different than MEDIA_URL as stated here:
    http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix
    
    If they're equal like now, local media serving fails
    
    Signed-off-by: Ismael Carnales <icarnales at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 4f47635b8a0434b07732e8511f6fbcd733bea198
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 15 01:26:10 2009 +0100

    Replace tabs by spaces in urls.py according to the PPE8

commit a556a293d76ad90e74c530ad9ea07e95d65ca70c
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 14 18:42:17 2009 +0100

    Establish ERR_MSG variable in the manage.py, add docstring
    
    * The best practice is to avoid the hardcoded values into the code.
    * Docstring was added into manage.py
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 archlinux/manage.py                |   20 +++++++++++++++-----
 archlinux/settings.py              |   14 ++------------
 archlinux/settings_local.py.sample |    7 +++++--
 archlinux/urls.py                  |   10 +++++-----
 4 files changed, 27 insertions(+), 24 deletions(-)


hooks/post-receive
-- 
Project aur2 at BerliOS


From icarnales at gmail.com  Sun Nov 15 20:01:20 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sun, 15 Nov 2009 17:01:20 -0200
Subject: [aur2-dev] [PATCH] Import aur app as if it were on project path
Message-ID: <1258311680-7833-1-git-send-email-icarnales@gmail.com>

Importing apps from the project path is the recommended way of doing it
and also makes the aur app importing consistent with the aurprofile app
importing.

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/aur/admin.py                      |    2 +-
 archlinux/aur/forms.py                      |    4 ++--
 archlinux/aur/templatetags/aur_tags.py      |    2 +-
 archlinux/aur/urls.py                       |    4 ++--
 archlinux/aur/views.py                      |    4 ++--
 archlinux/settings.py                       |    2 +-
 archlinux/templates/aur/package_detail.html |    4 ++--
 archlinux/templates/base.html               |    2 +-
 archlinux/urls.py                           |    2 +-
 9 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/archlinux/aur/admin.py b/archlinux/aur/admin.py
index 78c3b04..9cebefb 100644
--- a/archlinux/aur/admin.py
+++ b/archlinux/aur/admin.py
@@ -1,4 +1,4 @@
-from archlinux.aur.models import *
+from aur.models import *
 from django.contrib import admin
 
 admin.site.register(Architecture)
diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
index 2378aef..4337a61 100644
--- a/archlinux/aur/forms.py
+++ b/archlinux/aur/forms.py
@@ -1,8 +1,8 @@
 from django import forms
 from django.core.files import File
 
-from archlinux.aur.models import *
-import archlinux.aur.Package as PKGBUILD
+from aur.models import *
+import aur.Package as PKGBUILD
 
 import os
 import sys
diff --git a/archlinux/aur/templatetags/aur_tags.py b/archlinux/aur/templatetags/aur_tags.py
index 6e767ba..141a21b 100644
--- a/archlinux/aur/templatetags/aur_tags.py
+++ b/archlinux/aur/templatetags/aur_tags.py
@@ -1,7 +1,7 @@
 from django.template import Library
 from django.template.defaultfilters import stringfilter
 from django.contrib.auth.models import User
-from archlinux.aur.models import Package, PackageNotification
+from aur.models import Package, PackageNotification
 import re
 
 register = Library()
diff --git a/archlinux/aur/urls.py b/archlinux/aur/urls.py
index b34631f..4b3a4b4 100644
--- a/archlinux/aur/urls.py
+++ b/archlinux/aur/urls.py
@@ -1,12 +1,12 @@
 from django.conf.urls.defaults import *
-from archlinux.aur.models import Package
+from aur.models import Package
 
 detail_dict = {
     'queryset': Package.objects.all(),
     'template_object_name': 'pkg',
 }
 
-urlpatterns = patterns('archlinux.aur.views',
+urlpatterns = patterns('aur.views',
     url(r'^$', 'search', name='aur-main'),
     url(r'^search/$', 'search', name='aur-search'),
     url(r'^submit/$', 'submit', name='aur-submit_package'),
diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
index 6843d91..e6ec7b7 100644
--- a/archlinux/aur/views.py
+++ b/archlinux/aur/views.py
@@ -13,8 +13,8 @@ from django.core.urlresolvers import reverse
 from django.core import serializers
 from django.utils.translation import ugettext
 
-from archlinux.aur.models import *
-from archlinux.aur.forms import PackageSearchForm, PackageSubmitForm
+from aur.models import *
+from aur.forms import PackageSearchForm, PackageSubmitForm
 
 # Helper functions for permissions
 # This should perhaps be elsewhere. In the future Django may support
diff --git a/archlinux/settings.py b/archlinux/settings.py
index 6429b66..a7d1813 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -56,7 +56,7 @@ INSTALLED_APPS = (
     'django.contrib.sessions',
     'django.contrib.admin',
     'django.contrib.sites',
-    'archlinux.aur',
+    'aur',
     'registration',
     'aurprofile',
     'tagging',
diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
index 891e650..59abf9f 100644
--- a/archlinux/templates/aur/package_detail.html
+++ b/archlinux/templates/aur/package_detail.html
@@ -105,7 +105,7 @@
     <p class="news">{{ comment.message }}</p>
     <br />
     <div style="text-align:right">
-    <form action="{% url archlinux.aur.views.comment object_id=pkg.name %}" method="post">
+    <form action="{% url aur.views.comment object_id=pkg.name %}" method="post">
             <input type="hidden" name="reply_to" value="{{ comment.id }}" />
             <input type="submit" value="{% trans "Reply" %}" />
         </form>
@@ -117,7 +117,7 @@
 <br />
 <h2 class="title">{% trans "Post comment" %}</h2>
 <div class="greybox" style="text-align:right">
-    <form action="{% url archlinux.aur.views.comment object_id=pkg.name %}" method="post">
+    <form action="{% url aur.views.comment object_id=pkg.name %}" method="post">
         <textarea name="message" style="width:100%;" rows="10"></textarea><br />
         <input type="submit" value="{% trans "Reply" %}" />
     </form>
diff --git a/archlinux/templates/base.html b/archlinux/templates/base.html
index b6c8ef7..37b2b99 100644
--- a/archlinux/templates/base.html
+++ b/archlinux/templates/base.html
@@ -41,7 +41,7 @@
                     <li><a href="http://archlinux.org/mailman/listinfo/aur-general">{% trans "Mailing List" %}</a></li>
                     <li><a href="http://bugs.archlinux.org/index.php?tasks=all&amp;project=2">{% trans "Bugs" %}</a></li>
                     {% if user.is_authenticated %}
-                    <li><a href="{% url archlinux.aur.views.submit %}">{% trans "Submit" %}</a></li>
+                    <li><a href="{% url aur.views.submit %}">{% trans "Submit" %}</a></li>
                     {% endif %}
                     <li><a href="/">{% trans "Packages" %}</a></li>
                 </ul>
diff --git a/archlinux/urls.py b/archlinux/urls.py
index de3a92d..2c5dae4 100644
--- a/archlinux/urls.py
+++ b/archlinux/urls.py
@@ -8,7 +8,7 @@ urlpatterns = patterns('',
     (r'^admin/(.*)', admin.site.root),
     (r'^accounts/', include('registration.urls')),
     (r'^profile/', include('aurprofile.urls')),
-    (r'^', include('archlinux.aur.urls')),
+    (r'^', include('aur.urls')),
 )
 
 if settings.DEBUG == True:
-- 
1.6.5.2



From djszapi at archlinux.us  Sun Nov 15 20:30:46 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sun, 15 Nov 2009 20:30:46 +0100
Subject: [aur2-dev] [PATCH] Import aur app as if it were on project path
In-Reply-To: <1258311680-7833-1-git-send-email-icarnales@gmail.com>
References: <1258311680-7833-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911151130s62758187o9ee5fcb83c1e3a26@mail.gmail.com>

On Sun, Nov 15, 2009 at 8:01 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Importing apps from the project path is the recommended way of doing it
> and also makes the aur app importing consistent with the aurprofile app
> importing.
>
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> ?archlinux/aur/admin.py ? ? ? ? ? ? ? ? ? ? ?| ? ?2 +-
> ?archlinux/aur/forms.py ? ? ? ? ? ? ? ? ? ? ?| ? ?4 ++--
> ?archlinux/aur/templatetags/aur_tags.py ? ? ?| ? ?2 +-
> ?archlinux/aur/urls.py ? ? ? ? ? ? ? ? ? ? ? | ? ?4 ++--
> ?archlinux/aur/views.py ? ? ? ? ? ? ? ? ? ? ?| ? ?4 ++--
> ?archlinux/settings.py ? ? ? ? ? ? ? ? ? ? ? | ? ?2 +-
> ?archlinux/templates/aur/package_detail.html | ? ?4 ++--
> ?archlinux/templates/base.html ? ? ? ? ? ? ? | ? ?2 +-
> ?archlinux/urls.py ? ? ? ? ? ? ? ? ? ? ? ? ? | ? ?2 +-
> ?9 files changed, 13 insertions(+), 13 deletions(-)
>
> diff --git a/archlinux/aur/admin.py b/archlinux/aur/admin.py
> index 78c3b04..9cebefb 100644
> --- a/archlinux/aur/admin.py
> +++ b/archlinux/aur/admin.py
> @@ -1,4 +1,4 @@
> -from archlinux.aur.models import *
> +from aur.models import *
> ?from django.contrib import admin
>
> ?admin.site.register(Architecture)
> diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
> index 2378aef..4337a61 100644
> --- a/archlinux/aur/forms.py
> +++ b/archlinux/aur/forms.py
> @@ -1,8 +1,8 @@
> ?from django import forms
> ?from django.core.files import File
>
> -from archlinux.aur.models import *
> -import archlinux.aur.Package as PKGBUILD
> +from aur.models import *
> +import aur.Package as PKGBUILD
>
> ?import os
> ?import sys
> diff --git a/archlinux/aur/templatetags/aur_tags.py b/archlinux/aur/templatetags/aur_tags.py
> index 6e767ba..141a21b 100644
> --- a/archlinux/aur/templatetags/aur_tags.py
> +++ b/archlinux/aur/templatetags/aur_tags.py
> @@ -1,7 +1,7 @@
> ?from django.template import Library
> ?from django.template.defaultfilters import stringfilter
> ?from django.contrib.auth.models import User
> -from archlinux.aur.models import Package, PackageNotification
> +from aur.models import Package, PackageNotification
> ?import re
>
> ?register = Library()
> diff --git a/archlinux/aur/urls.py b/archlinux/aur/urls.py
> index b34631f..4b3a4b4 100644
> --- a/archlinux/aur/urls.py
> +++ b/archlinux/aur/urls.py
> @@ -1,12 +1,12 @@
> ?from django.conf.urls.defaults import *
> -from archlinux.aur.models import Package
> +from aur.models import Package
>
> ?detail_dict = {
> ? ? 'queryset': Package.objects.all(),
> ? ? 'template_object_name': 'pkg',
> ?}
>
> -urlpatterns = patterns('archlinux.aur.views',
> +urlpatterns = patterns('aur.views',
> ? ? url(r'^$', 'search', name='aur-main'),
> ? ? url(r'^search/$', 'search', name='aur-search'),
> ? ? url(r'^submit/$', 'submit', name='aur-submit_package'),
> diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
> index 6843d91..e6ec7b7 100644
> --- a/archlinux/aur/views.py
> +++ b/archlinux/aur/views.py
> @@ -13,8 +13,8 @@ from django.core.urlresolvers import reverse
> ?from django.core import serializers
> ?from django.utils.translation import ugettext
>
> -from archlinux.aur.models import *
> -from archlinux.aur.forms import PackageSearchForm, PackageSubmitForm
> +from aur.models import *
> +from aur.forms import PackageSearchForm, PackageSubmitForm
>
> ?# Helper functions for permissions
> ?# This should perhaps be elsewhere. In the future Django may support
> diff --git a/archlinux/settings.py b/archlinux/settings.py
> index 6429b66..a7d1813 100644
> --- a/archlinux/settings.py
> +++ b/archlinux/settings.py
> @@ -56,7 +56,7 @@ INSTALLED_APPS = (
> ? ? 'django.contrib.sessions',
> ? ? 'django.contrib.admin',
> ? ? 'django.contrib.sites',
> - ? ?'archlinux.aur',
> + ? ?'aur',
> ? ? 'registration',
> ? ? 'aurprofile',
> ? ? 'tagging',
> diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
> index 891e650..59abf9f 100644
> --- a/archlinux/templates/aur/package_detail.html
> +++ b/archlinux/templates/aur/package_detail.html
> @@ -105,7 +105,7 @@
> ? ? <p class="news">{{ comment.message }}</p>
> ? ? <br />
> ? ? <div style="text-align:right">
> - ? ?<form action="{% url archlinux.aur.views.comment object_id=pkg.name %}" method="post">
> + ? ?<form action="{% url aur.views.comment object_id=pkg.name %}" method="post">
> ? ? ? ? ? ? <input type="hidden" name="reply_to" value="{{ comment.id }}" />
> ? ? ? ? ? ? <input type="submit" value="{% trans "Reply" %}" />
> ? ? ? ? </form>
> @@ -117,7 +117,7 @@
> ?<br />
> ?<h2 class="title">{% trans "Post comment" %}</h2>
> ?<div class="greybox" style="text-align:right">
> - ? ?<form action="{% url archlinux.aur.views.comment object_id=pkg.name %}" method="post">
> + ? ?<form action="{% url aur.views.comment object_id=pkg.name %}" method="post">
> ? ? ? ? <textarea name="message" style="width:100%;" rows="10"></textarea><br />
> ? ? ? ? <input type="submit" value="{% trans "Reply" %}" />
> ? ? </form>
> diff --git a/archlinux/templates/base.html b/archlinux/templates/base.html
> index b6c8ef7..37b2b99 100644
> --- a/archlinux/templates/base.html
> +++ b/archlinux/templates/base.html
> @@ -41,7 +41,7 @@
> ? ? ? ? ? ? ? ? ? ? <li><a href="http://archlinux.org/mailman/listinfo/aur-general">{% trans "Mailing List" %}</a></li>
> ? ? ? ? ? ? ? ? ? ? <li><a href="http://bugs.archlinux.org/index.php?tasks=all&amp;project=2">{% trans "Bugs" %}</a></li>
> ? ? ? ? ? ? ? ? ? ? {% if user.is_authenticated %}
> - ? ? ? ? ? ? ? ? ? ?<li><a href="{% url archlinux.aur.views.submit %}">{% trans "Submit" %}</a></li>
> + ? ? ? ? ? ? ? ? ? ?<li><a href="{% url aur.views.submit %}">{% trans "Submit" %}</a></li>
> ? ? ? ? ? ? ? ? ? ? {% endif %}
> ? ? ? ? ? ? ? ? ? ? <li><a href="/">{% trans "Packages" %}</a></li>
> ? ? ? ? ? ? ? ? </ul>
> diff --git a/archlinux/urls.py b/archlinux/urls.py
> index de3a92d..2c5dae4 100644
> --- a/archlinux/urls.py
> +++ b/archlinux/urls.py
> @@ -8,7 +8,7 @@ urlpatterns = patterns('',
> ? ? (r'^admin/(.*)', admin.site.root),
> ? ? (r'^accounts/', include('registration.urls')),
> ? ? (r'^profile/', include('aurprofile.urls')),
> - ? ?(r'^', include('archlinux.aur.urls')),
> + ? ?(r'^', include('aur.urls')),
> ?)
>
> ?if settings.DEBUG == True:
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

I like this patch, I will apply it soon.It's good because apps can be
reached with archlinux.aur absolutely or relatively with aur. I prefer
the relative way to absolute because it will be available in other
project too, meanwhile in this format it should be rewritten if
archlinux name wll change.

Anyway, thanks :)

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Sun Nov 15 22:23:39 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Sun, 15 Nov 2009 22:23:39 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. b60510dfcd99cac8f09ae3e273df310a1afb3849
Message-ID: <200911152123.nAFLNd2a022513@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  b60510dfcd99cac8f09ae3e273df310a1afb3849 (commit)
       via  8a834c19af4f900366762a5a79f89c9910d74f6b (commit)
       via  a4dd23bcbec1d6ec72971eafa4ce959eede30044 (commit)
       via  6653104e93f5a0d5b6cdbaf33f1ead3c522d9410 (commit)
      from  19c740c3cdd90053cb50326cd339f53569cd189d (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit b60510dfcd99cac8f09ae3e273df310a1afb3849
Author: Ismael Carnales <icarnales at gmail.com>
Date:   Sun Nov 15 17:01:20 2009 -0200

    Import aur app as if it were on project path
    
    Importing apps from the project path is the recommended way of doing it
    and also makes the aur app importing consistent with the aurprofile app
    importing.
    
    Signed-off-by: Ismael Carnales <icarnales at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 8a834c19af4f900366762a5a79f89c9910d74f6b
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 15 21:07:11 2009 +0100

    Extend .gitignore file with some pattern
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit a4dd23bcbec1d6ec72971eafa4ce959eede30044
Merge: 19c740c3cdd90053cb50326cd339f53569cd189d 6653104e93f5a0d5b6cdbaf33f1ead3c522d9410
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 15 08:44:13 2009 +0100

    Add unit tests
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 6653104e93f5a0d5b6cdbaf33f1ead3c522d9410
Author: Sebastian Nowicki <sebnow at gmail.com>
Date:   Sun Feb 1 17:36:20 2009 +0900

    Add unit tests
    
    Signed-off-by: Sebastian Nowicki <sebnow at gmail.com>

-----------------------------------------------------------------------

Summary of changes:
 .gitignore                                  |    8 ++-
 README.rst                                  |    5 +
 archlinux/aur/admin.py                      |    2 +-
 archlinux/aur/fixtures/test/packages.json   |   36 ++++++++
 archlinux/aur/fixtures/test/users.json      |   20 +++++
 archlinux/aur/forms.py                      |    4 +-
 archlinux/aur/templatetags/aur_tags.py      |    2 +-
 archlinux/aur/tests.py                      |  122 +++++++++++++++++++++++++++
 archlinux/aur/urls.py                       |    4 +-
 archlinux/aur/views.py                      |    4 +-
 archlinux/settings.py                       |    2 +-
 archlinux/templates/aur/package_detail.html |    4 +-
 archlinux/templates/base.html               |    2 +-
 archlinux/urls.py                           |    2 +-
 14 files changed, 203 insertions(+), 14 deletions(-)
 create mode 100644 archlinux/aur/fixtures/test/packages.json
 create mode 100644 archlinux/aur/fixtures/test/users.json
 create mode 100644 archlinux/aur/tests.py


hooks/post-receive
-- 
Project aur2 at BerliOS


From icarnales at gmail.com  Mon Nov 16 01:09:01 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sun, 15 Nov 2009 22:09:01 -0200
Subject: [aur2-dev] [PATCH] Change reverse view of tests
Message-ID: <1258330141-2498-1-git-send-email-icarnales@gmail.com>

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/aur/tests.py |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/archlinux/aur/tests.py b/archlinux/aur/tests.py
index 0483095..0cbe82a 100644
--- a/archlinux/aur/tests.py
+++ b/archlinux/aur/tests.py
@@ -47,21 +47,21 @@ class AurViewTests(AurTestCase):
 
 class AurAPITests(AurTestCase):
     def test_search_view(self):
-        response = self.client.get(reverse('archlinux.aur.views.api_search', kwargs={
+        response = self.client.get(reverse('aur.views.api_search', kwargs={
             'query': 'package',
             'format': 'json',
         }))
         self.assertEqual(response.status_code, 200)
 
     def test_package_view(self):
-        response = self.client.get(reverse('archlinux.aur.views.api_package_info', kwargs={
+        response = self.client.get(reverse('aur.views.api_package_info', kwargs={
             'object_id' :'unique_package',
             'format': 'json',
         }))
         self.assertEqual(response.status_code, 200)
 
         # Requested package does not exist (404)
-        response = self.client.get(reverse('archlinux.aur.views.api_package_info', kwargs={
+        response = self.client.get(reverse('aur.views.api_package_info', kwargs={
             'object_id' :'DoesNotExist',
             'format': 'json',
         }))
-- 
1.6.5.2



From djszapi at archlinux.us  Mon Nov 16 02:44:30 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Mon, 16 Nov 2009 02:44:30 +0100
Subject: [aur2-dev] [PATCH] Change reverse view of tests
In-Reply-To: <1258330141-2498-1-git-send-email-icarnales@gmail.com>
References: <1258330141-2498-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911151744n206db204g6027c29572af3d96@mail.gmail.com>

On Mon, Nov 16, 2009 at 1:09 AM, Ismael Carnales <icarnales at gmail.com> wrote:
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> ?archlinux/aur/tests.py | ? ?6 +++---
> ?1 files changed, 3 insertions(+), 3 deletions(-)
>
> diff --git a/archlinux/aur/tests.py b/archlinux/aur/tests.py
> index 0483095..0cbe82a 100644
> --- a/archlinux/aur/tests.py
> +++ b/archlinux/aur/tests.py
> @@ -47,21 +47,21 @@ class AurViewTests(AurTestCase):
>
> ?class AurAPITests(AurTestCase):
> ? ? def test_search_view(self):
> - ? ? ? ?response = self.client.get(reverse('archlinux.aur.views.api_search', kwargs={
> + ? ? ? ?response = self.client.get(reverse('aur.views.api_search', kwargs={
> ? ? ? ? ? ? 'query': 'package',
> ? ? ? ? ? ? 'format': 'json',
> ? ? ? ? }))
> ? ? ? ? self.assertEqual(response.status_code, 200)
>
> ? ? def test_package_view(self):
> - ? ? ? ?response = self.client.get(reverse('archlinux.aur.views.api_package_info', kwargs={
> + ? ? ? ?response = self.client.get(reverse('aur.views.api_package_info', kwargs={
> ? ? ? ? ? ? 'object_id' :'unique_package',
> ? ? ? ? ? ? 'format': 'json',
> ? ? ? ? }))
> ? ? ? ? self.assertEqual(response.status_code, 200)
>
> ? ? ? ? # Requested package does not exist (404)
> - ? ? ? ?response = self.client.get(reverse('archlinux.aur.views.api_package_info', kwargs={
> + ? ? ? ?response = self.client.get(reverse('aur.views.api_package_info', kwargs={
> ? ? ? ? ? ? 'object_id' :'DoesNotExist',
> ? ? ? ? ? ? 'format': 'json',
> ? ? ? ? }))
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

Sorry, I will be inactive in the next few days(real life things too),
so I can't apply the patches until I'm ok again, otherwise I modified
the archlinux related deletings after your first patch in my working
branch.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Thu Nov 19 00:32:55 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Thu, 19 Nov 2009 00:32:55 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0
Message-ID: <200911182332.nAINWtMv012698@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0 (commit)
       via  0a5d339a9c35f6b6d485a42deb141485000881ee (commit)
       via  09903abb9144e3755ebcb4db362f974a92d0a3f4 (commit)
       via  01e53c6c62db52c4309033d19e2ee50158396e9a (commit)
       via  b7e4ee575507cca7b61a42c0483c4c8a1bcb9fb3 (commit)
       via  2e5d65398c19bc85d8392ae421a6bdf70f72d4c6 (commit)
      from  b60510dfcd99cac8f09ae3e273df310a1afb3849 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Thu Nov 19 00:28:47 2009 +0100

    Add LICENSE file into the project
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 0a5d339a9c35f6b6d485a42deb141485000881ee
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Thu Nov 19 00:27:30 2009 +0100

    Add HACKING file into the project
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 09903abb9144e3755ebcb4db362f974a92d0a3f4
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Thu Nov 19 00:23:57 2009 +0100

    Add AUTHORS file
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 01e53c6c62db52c4309033d19e2ee50158396e9a
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Wed Nov 18 23:28:10 2009 +0100

    Fix some warnings in forms.py
    
    Fix some of the warnings, like:
    
    * Line too long
    * Bad indentation. Found 20 spaces, expected 16
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit b7e4ee575507cca7b61a42c0483c4c8a1bcb9fb3
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Tue Nov 17 23:24:57 2009 +0100

    Fix tabs to spaces in manage.py
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 2e5d65398c19bc85d8392ae421a6bdf70f72d4c6
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 15 22:09:01 2009 -0200

    Refactor archlinux related changes in tests too
    
    * Delete archlinux 'tag' to reach relative path operation instead of absolute
    one
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 AUTHORS                |   13 ++
 HACKING                |   79 +++++++++++
 LICENSE                |  339 ++++++++++++++++++++++++++++++++++++++++++++++++
 archlinux/aur/forms.py |   23 ++--
 archlinux/aur/tests.py |    6 +-
 archlinux/manage.py    |   10 +-
 6 files changed, 451 insertions(+), 19 deletions(-)
 create mode 100644 AUTHORS
 create mode 100644 HACKING
 create mode 100644 LICENSE


hooks/post-receive
-- 
Project aur2 at BerliOS


From speedvin at archlinux.us  Thu Nov 19 18:44:44 2009
From: speedvin at archlinux.us (member SpeedVin)
Date: Thu, 19 Nov 2009 18:44:44 +0100
Subject: [aur2-dev] Patch to polish translation for Polish translation.
Message-ID: <ea141e7a0911190944p70d7123es6d7cf71059afbe74@mail.gmail.com>

Hello I found I bug (it is?) in Polisch translation in
http://github.com/sebnow/aur2/blob/pkgbuild/archlinux/locale/pl/LC_MESSAGES/django.po
.
This is orginal file:
[code]
# Polish translation

# Copyright (C) 2007 Sebastian Nowicki
# This file is distributed under the same license as the AUR package.
# Sebastian Nowicki <xilonmu at gmail>, 2007
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: 1\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2007-10-04 18:08+0800\n"
"PO-Revision-Date: 2007-10-04 18:08+0800\n"
"Last-Translator: Sebastian Nowicki <xilonmu at gmail.com>\n"
"Language-Team: Polish <pl at li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: templates/base.html:21
msgid "Logged in as"
msgstr "Zalogowany jako"

#: templates/base.html:28
msgid "Get Arch"
msgstr "?ci?gnij Arch"

#: templates/base.html:30 templates/base.html.py:42
msgid "Bugs"
msgstr "B??dy"

#: templates/base.html:31
msgid "Wiki"
msgstr "Wiki"

#: templates/base.html:32
msgid "Forums"
msgstr "Dyskusja"

#: templates/base.html:33
msgid "Home"
msgstr "Dom"

#: templates/base.html:40
msgid "Statistics"
msgstr "Statystyki"

#: templates/base.html:41
msgid "Mailing List"
msgstr "Lista Poctowa"

#: templates/base.html:43
msgid "Account"
msgstr "Konto"

#: templates/base.html:44
msgid "Packages"
msgstr "Pakiety"

#: templates/aur/package_archive.html:6 templates/aur/package_detail.html:13
msgid "Repository"
msgstr "Repozytorium"

#: templates/aur/package_archive.html:7
msgid "Name"
msgstr "Imi?"

#: templates/aur/package_archive.html:8 templates/aur/package_detail.html:19
msgid "Description"
msgstr "Opis"

#: templates/aur/package_archive.html:9 templates/aur/package_detail.html:16
msgid "Category"
msgstr "Kategoria"

#: templates/aur/package_archive.html:10 templates/aur/package_detail.html:28
msgid "Maintainer"
msgstr "Opiekun"

#: templates/aur/package_archive.html:11 templates/aur/package_detail.html:31
msgid "Last Updated"
msgstr "Ostatnio Aktualizowano"

#: templates/aur/account_detail.html:7
msgid "Username"
msgstr "U?ytkownik"

#: templates/aur/account_detail.html:11
msgid "Email"
msgstr "Adres e-mail"

#: templates/aur/account_detail.html:15
msgid "Password"
msgstr "Has?o"

#: templates/aur/account_detail.html:19
msgid "Re-type Password"
msgstr "Has?o (ponownie)"

#: templates/aur/account_detail.html:23
msgid "Real Name"
msgstr "Imi? i nazwisko"

#: templates/aur/account_detail.html:27
msgid "IRC Nick"
msgstr "Ksywa na IRC"

#: templates/aur/account_detail.html:31
msgid "Preferred Language"
msgstr "J?zyk"

#: templates/aur/account_detail.html:40
msgid "Notify on new comment"
msgstr "Zawiadamiaj o nowych komentarzach"

#: templates/aur/account_detail.html:44
msgid "Notify of Out-of-Date packages"
msgstr "Zawiadamiaj o przestarza?ych pakietach"

#: templates/aur/account_detail.html:49
msgid "Update"
msgstr "Aktualizuj"

#: templates/aur/account_detail.html:49
msgid "Reset"
msgstr "Wyczy??"

#: templates/aur/package_detail.html:22
msgid "Architecture"
msgstr "Architektuta"

#: templates/aur/package_detail.html:25
msgid "URL"
msgstr "Adres URL"

#: templates/aur/package_detail.html:40
msgid "Dependencies"
msgstr "Zale?no?ci"

#: templates/aur/package_detail.html:47
msgid "Sources"
msgstr "?r?d?a"
[/code]
This is fixed? file:

[code]
# Polish translation
# Copyright (C) 2007 Sebastian Nowicki
# This file is distributed under the same license as the AUR package.
# Sebastian Nowicki <xilonmu at gmail>, 2007
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: 1\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2007-10-04 18:08+0800\n"
"PO-Revision-Date: 2009-11-19 19:18+0800\n"
"Last-Translator: Patryk <SpeedVin<dot>archlinux<at>us>\n"k
"Language-Team: Polish <pl at li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: templates/base.html:21
msgid "Logged in as"
msgstr "Zalogowany jako"

#: templates/base.html:28
msgid "Get Arch"
msgstr "?ci?gnij Arch"

#: templates/base.html:30 templates/base.html.py:42
msgid "Bugs"
msgstr "B??dy"

#: templates/base.html:31
msgid "Wiki"
msgstr "Wiki"

#: templates/base.html:32
msgid "Forums"
msgstr "Dyskusja"

#: templates/base.html:33
msgid "Home"
msgstr "Dom"

#: templates/base.html:40
msgid "Statistics"
msgstr "Statystyki"

#: templates/base.html:41
msgid "Mailing List"
msgstr "Lista Poc*z*towa"

#: templates/base.html:43
msgid "Account"
msgstr "Konto"

#: templates/base.html:44
msgid "Packages"
msgstr "Pakiety"

#: templates/aur/package_archive.html:6 templates/aur/package_detail.html:13
msgid "Repository"
msgstr "Repozytorium"

#: templates/aur/package_archive.html:7
msgid "Name"
msgstr "Imi?"

#: templates/aur/package_archive.html:8 templates/aur/package_detail.html:19
msgid "Description"
msgstr "Opis"

#: templates/aur/package_archive.html:9 templates/aur/package_detail.html:16
msgid "Category"
msgstr "Kategoria"

#: templates/aur/package_archive.html:10 templates/aur/package_detail.html:28
msgid "Maintainer"
msgstr "Opiekun"

#: templates/aur/package_archive.html:11 templates/aur/package_detail.html:31
msgid "Last Updated"
msgstr "Ostatnio Aktualizowano"

#: templates/aur/account_detail.html:7
msgid "Username"
msgstr "U?ytkownik"

#: templates/aur/account_detail.html:11
msgid "Email"
msgstr "Adres e-mail"

#: templates/aur/account_detail.html:15
msgid "Password"
msgstr "Has?o"

#: templates/aur/account_detail.html:19
msgid "Re-type Password"
msgstr "Has?o (ponownie)"

#: templates/aur/account_detail.html:23
msgid "Real Name"
msgstr "Imi? i nazwisko"

#: templates/aur/account_detail.html:27
msgid "IRC Nick"
msgstr "Ksywa na IRC"

#: templates/aur/account_detail.html:31
msgid "Preferred Language"
msgstr "J?zyk"

#: templates/aur/account_detail.html:40
msgid "Notify on new comment"
msgstr "Zawiadamiaj o nowych komentarzach"

#: templates/aur/account_detail.html:44
msgid "Notify of Out-of-Date packages"
msgstr "Zawiadamiaj o przestarza?ych pakietach"

#: templates/aur/account_detail.html:49
msgid "Update"
msgstr "Aktualizuj"

#: templates/aur/account_detail.html:49
msgid "Reset"
msgstr "Wyczy??"

#: templates/aur/package_detail.html:22
msgid "Architecture"
msgstr "Architektuta"

#: templates/aur/package_detail.html:25
msgid "URL"
msgstr "Adres URL"

#: templates/aur/package_detail.html:40
msgid "Dependencies"
msgstr "Zale?no?ci"

#: templates/aur/package_detail.html:47
msgid "Sources"
msgstr "?r?d?a"
[/code]
I show bug by thickening it.
And we can change Ksywa to Pseudonim :).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/aur2-dev/attachments/20091119/9769b0fb/attachment.html>

From djszapi at archlinux.us  Thu Nov 19 19:05:52 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Thu, 19 Nov 2009 19:05:52 +0100
Subject: [aur2-dev] Patch to polish translation for Polish translation.
In-Reply-To: <ea141e7a0911190944p70d7123es6d7cf71059afbe74@mail.gmail.com>
References: <ea141e7a0911190944p70d7123es6d7cf71059afbe74@mail.gmail.com>
Message-ID: <a362e8010911191005h4260f42aw991249198bbbcc38@mail.gmail.com>

Hello SpeedVin,

* Please subscribe for the list before you send patch.
* Otherwise no need to do translation before any release, because it
will be changed a lot, so keep it for later.

Best Regards,
Laszlo Papp


From speedvin at archlinux.us  Thu Nov 19 21:46:54 2009
From: speedvin at archlinux.us (member SpeedVin)
Date: Thu, 19 Nov 2009 21:46:54 +0100
Subject: [aur2-dev] Patch to polish translation for Polish translation.
Message-ID: <ea141e7a0911191246u7c077e92q3552bdddfe1e9398@mail.gmail.com>

Ok I will keep translating just send me message or just write on mailing
list and I will send you my translation's.
For now I work on Polish and Deustch translation :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/aur2-dev/attachments/20091119/5219490b/attachment.html>

From sebnow at gmail.com  Fri Nov 20 06:35:38 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Fri, 20 Nov 2009 13:35:38 +0800
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0
In-Reply-To: <200911182332.nAINWtMv012698@sheep.berlios.de>
References: <200911182332.nAINWtMv012698@sheep.berlios.de>
Message-ID: <CCDE4E11-ED88-43D2-8FCE-1E0A5F2B8597@gmail.com>


On Nov 19, 2009, at 7:32 AM, djszapi at archlinux.us wrote:

> commit f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Thu Nov 19 00:28:47 2009 +0100
>
>    Add LICENSE file into the project
>
>    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

Who said AUR2 is GPL v2? I'm not sure that it's the most appropriate  
license. I would prefer MIT, personally. Licensing should be discussed  
with all developers involved, and in this case, probably with a few of  
the Archlinux officials as well, for their opinion.

> commit 09903abb9144e3755ebcb4db362f974a92d0a3f4
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Thu Nov 19 00:23:57 2009 +0100
>
>    Add AUTHORS file
>
>    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

You forgot Joerie de Gram, the person who actually started this.

> commit 01e53c6c62db52c4309033d19e2ee50158396e9a
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Wed Nov 18 23:28:10 2009 +0100
>
>    Fix some warnings in forms.py
>
>    Fix some of the warnings, like:
>
>    * Line too long
>    * Bad indentation. Found 20 spaces, expected 16
>
>    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

> -        repository_choices += [(repository.name.lower(),  
> repository.name) for repository in Repository.objects.all()]
> +        repository_choices += [(repository.name.lower(),  
> repository.name) \
> +                for repository in Repository.objects.all()]

Keeping lines under a certain amount of columns is nice, but not at  
the expense of readability. Is this necessary? Perhaps a better way to  
shorten it would be to use a for loop, instead of list comprehensions:

for repository in Repository.objects.all:
	repository_choices.append((repository.name.lower(), repository.name))

(Not tested.)

> -        # Find the packages by searching description and package  
> name or maintainer
> +        # Find the packages by searching description, package name  
> or maintainer

You changed the meaning of the comment. It now implies that it  
searches description OR package name OR maintainer, when in fact it  
searches (description AND package name) OR maintainer. The comma  
should at most be after "package name":

# Find the packages by searching the description and package name, or  
maintainer

> -        # Add path of the tarball/PKGBUILD so we can reference in  
> other places
> +        # Add path of the tarball/PKGBUILD we can reference in  
> other places

Why did you change that? It's now grammatically incorrect.

> -         
> package 
> .repository 
> =Repository.objects.get(name__iexact=self.cleaned_data['repository'])
> +        package.repository = Repository.objects.get(name__iexact =  
> self.cleaned_data['repository'])


This is against PEP8:
> - Don't use spaces around the '=' sign when used to indicate a
>       keyword argument or a default parameter value.
>
>       Yes:
>
>           def complex(real, imag=0.0):
>               return magic(r=real, i=imag)
>
>       No:
>
>           def complex(real, imag = 0.0):
>               return magic(r = real, i = imag)
>
> commit b7e4ee575507cca7b61a42c0483c4c8a1bcb9fb3
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Tue Nov 17 23:24:57 2009 +0100
>
>    Fix tabs to spaces in manage.py
>
>    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

>              if is_tarfile and  
> os.path.exists(os.path.join(tmpdir_sources,
>                 package.name, source_filename)):
> -                    fp = File(open(os.path.join(tmpdir_sources,  
> pkg['name'],
> +                fp = File(open(os.path.join(tmpdir_sources,  
> pkg['name'],
>                          source_filename), "r"))
> -                    source.filename.save('%(name)s/sources/' +  
> source_filename, fp)
> -                    fp.close()
> +                source.filename.save('%(name)s/sources/' +  
> source_filename, fp)
> +                fp.close()

I'd suggest extracting paths of the if expression to variables, e.g.:

source_file = os.path.join(tmpdir_sources, package.name,  
source_filename)
if is_tarfile and os.path.exists(source_file):
     ...

This won't decrease readability.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/aur2-dev/attachments/20091120/c652a1e8/attachment.html>

From djszapi at archlinux.us  Fri Nov 20 06:57:53 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Fri, 20 Nov 2009 06:57:53 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0
In-Reply-To: <CCDE4E11-ED88-43D2-8FCE-1E0A5F2B8597@gmail.com>
References: <200911182332.nAINWtMv012698@sheep.berlios.de>
	<CCDE4E11-ED88-43D2-8FCE-1E0A5F2B8597@gmail.com>
Message-ID: <a362e8010911192157x7ae038c6q95a8e786f26f67d0@mail.gmail.com>

On Fri, Nov 20, 2009 at 6:35 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 19, 2009, at 7:32 AM, djszapi at archlinux.us wrote:
>
> commit f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date: ??Thu Nov 19 00:28:47 2009 +0100
>
> ???Add LICENSE file into the project
>
> ???Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>
> Who said AUR2 is GPL v2? I'm not sure that it's the most appropriate
> license. I would prefer MIT, personally. Licensing should be discussed with
> all developers involved, and in this case, probably with a few of the
> Archlinux officials as well, for their opinion.
>

No one said others too :) I checked archweb_* projects and that was
the license there too, so I think it's reasonable, and at this momment
AUR2 is not an official project, don't forget it, but it can be
changed too.

> commit 09903abb9144e3755ebcb4db362f974a92d0a3f4
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date: ??Thu Nov 19 00:23:57 2009 +0100
>
> ???Add AUTHORS file
>
> ???Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>
> You forgot?Joerie de Gram, the person who actually started this.

I will commit it soon.

>
> - ? ? ? ?# Find the packages by searching description and package name or
> maintainer
>
> + ? ? ? ?# Find the packages by searching description, package name or
> maintainer
>
> You changed the meaning of the comment. It now implies that it searches
> description OR package name OR maintainer, when in fact it searches
> (description AND package name) OR maintainer. The comma should at most be
> after "package name":

Yeah, but please don't use more than 80 characters anymore, because
it's not okay for the coding style, so It's needed to strip, I will
correct it soon, because the original format wasn't okay.

> # Find the packages by searching the description and package name, or
> maintainer
>
> - ? ? ? ?# Add path of the tarball/PKGBUILD so we can reference in other
> places
>
> + ? ? ? ?# Add path of the tarball/PKGBUILD we can reference in other places
>
> Why did you change that? It's now grammatically incorrect.
>

I don't think so, but maybe it's better to follow the way as I
described in the earlier point, you can test your long lines with
pylint easily, it's a good tool, I will correct it soon too.

> -
> ?package.repository=Repository.objects.get(name__iexact=self.cleaned_data['repository'])
>
> + ? ? ? ?package.repository = Repository.objects.get(name__iexact =
> self.cleaned_data['repository'])
>
> This is against PEP8:
>
> - Don't use spaces around the '=' sign when used to indicate a
>       keyword argument or a default parameter value.
>
>       Yes:
>
>           def complex(real, imag=0.0):
>               return magic(r=real, i=imag)
>
>       No:
>
>           def complex(real, imag = 0.0):
>               return magic(r = real, i = imag)
>
> commit b7e4ee575507cca7b61a42c0483c4c8a1bcb9fb3
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date: ??Tue Nov 17 23:24:57 2009 +0100
>
> ???Fix tabs to spaces in manage.py
>
> ???Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>
> ?? ? ? ? ? ? if is_tarfile and os.path.exists(os.path.join(tmpdir_sources,
>
> ?? ? ? ? ? ? ? ?package.name, source_filename)):
>
> - ? ? ? ? ? ? ? ? ? ?fp = File(open(os.path.join(tmpdir_sources,
> pkg['name'],
>
> + ? ? ? ? ? ? ? ?fp = File(open(os.path.join(tmpdir_sources, pkg['name'],
>
> ?? ? ? ? ? ? ? ? ? ? ? ? source_filename), "r"))
>
> - ? ? ? ? ? ? ? ? ? ?source.filename.save('%(name)s/sources/' +
> source_filename, fp)
>
> - ? ? ? ? ? ? ? ? ? ?fp.close()
>
> + ? ? ? ? ? ? ? ?source.filename.save('%(name)s/sources/' + source_filename,
> fp)
>
> + ? ? ? ? ? ? ? ?fp.close()
>
> I'd suggest extracting paths of the if expression to variables, e.g.:
> source_file =?os.path.join(tmpdir_sources, package.name, source_filename)
> if is_tarfile and os.path.exists(source_file):
> ?? ?...
> This won't decrease readability.
>

I think it's a good idea, I will correct it at the weekend.

Thanks all your feedback, Sebastian :)

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Fri Nov 20 07:41:57 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Fri, 20 Nov 2009 07:41:57 +0100
Subject: [aur2-dev]  [Git]Project aur2 at BerliOS branch, master,
	updated. 	b60510dfcd99cac8f09ae3e273df310a1afb3849
Message-ID: <a362e8010911192241r4c4e57d6w2b6fe08d4652da38@mail.gmail.com>

On Fri, Nov 20, 2009 at 7:32 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 20, 2009, at 2:03 PM, Laszlo Papp wrote:
>>
>> There wasn't here 'noisy' merge commit, it worked simply without any
>> problem, and this I've read this solution in a git tutorial.
>>
>> Best Regards,
>> Laszlo Papp
>
> By noisy I mean that there's an unnecessary commit in the log (the merge
> one). Instead of one, there are two. Rebase is much better in these
> situations.

In this special case I don't feel it's problematic side. It's not an
frequent situation, just one time matter.

>
> The mailing list seems to be configured weird. This was supposed to be sent
> to the ML but it was only sent to you?
>

You need to presh to 'Reply-All' button instead of 'Reply'.

Best Regards,
Laszlo Papp


From cmbrannon79 at gmail.com  Mon Nov 23 00:03:43 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Sun, 22 Nov 2009 17:03:43 -0600
Subject: [aur2-dev] [PATCH] Add archlinux/database.sqlite3 to .gitignore.
Message-ID: <4b09c44a.9753f10a.610e.ffffa7c3@mx.google.com>

This is the name of the database file used for testing purposes in the
sample settings file.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 .gitignore |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/.gitignore b/.gitignore
index be4bb51..ac61b59 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,4 +1,5 @@
 archlinux/settings_local.py
+archlinux/database.sqlite3
 *.py[doc]
 *.{s,}o
 *.{l,}a
-- 
1.6.4.4



From djszapi at archlinux.us  Mon Nov 23 00:19:14 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Mon, 23 Nov 2009 00:19:14 +0100
Subject: [aur2-dev] [PATCH] Add archlinux/database.sqlite3 to .gitignore.
In-Reply-To: <4b09c44a.9753f10a.610e.ffffa7c3@mx.google.com>
References: <4b09c44a.9753f10a.610e.ffffa7c3@mx.google.com>
Message-ID: <a362e8010911221519x810d0a6u9b193b6016ee51f6@mail.gmail.com>

On Mon, Nov 23, 2009 at 12:03 AM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:
> This is the name of the database file used for testing purposes in the
> sample settings file.
>
> Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
> ---
> ?.gitignore | ? ?1 +
> ?1 files changed, 1 insertions(+), 0 deletions(-)
>
> diff --git a/.gitignore b/.gitignore
> index be4bb51..ac61b59 100644
> --- a/.gitignore
> +++ b/.gitignore
> @@ -1,4 +1,5 @@
> ?archlinux/settings_local.py
> +archlinux/database.sqlite3
> ?*.py[doc]
> ?*.{s,}o
> ?*.{l,}a
> --
> 1.6.4.4

It seems fine for me, applied in my local branch, I will push it soon, thanks.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Mon Nov 23 00:24:31 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Mon, 23 Nov 2009 00:24:31 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. f52c5a985122947b1ea15a3576d4e98365aab27f
Message-ID: <200911222324.nAMNOVsH006440@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  f52c5a985122947b1ea15a3576d4e98365aab27f (commit)
       via  7349ed8cbb34db08f56eae5f669dbecf32b9adee (commit)
       via  bc0f9870c696c4232e3f92ced9f1a1b3a7c4776d (commit)
      from  f7530b9e3b707cd8f305b89ae95cf8bc6288f9b0 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit f52c5a985122947b1ea15a3576d4e98365aab27f
Author: Christopher Brannon <cmbrannon79 at gmail.com>
Date:   Sun Nov 22 17:03:43 2009 -0600

    Add archlinux/database.sqlite3 to .gitignore.
    
    This is the name of the database file used for testing purposes in the
    sample settings file.
    
    Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 7349ed8cbb34db08f56eae5f669dbecf32b9adee
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 21 15:32:59 2009 +0100

    Refactor archlinux/aur/forms.py
    
    * Extracting paths of the if expression to variables
    * Don't use spaces around the '=' sign according to the PEP8
    * Wrap some comment lines
    * Shorten with for loop, instead of list comprehensions
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit bc0f9870c696c4232e3f92ced9f1a1b3a7c4776d
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 21 15:07:41 2009 +0100

    Add Joerie de Gram to the AUTHORS
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 .gitignore             |    1 +
 AUTHORS                |    2 +-
 archlinux/aur/forms.py |   19 ++++++++++---------
 3 files changed, 12 insertions(+), 10 deletions(-)


hooks/post-receive
-- 
Project aur2 at BerliOS


From cmbrannon79 at gmail.com  Mon Nov 23 13:37:36 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Mon, 23 Nov 2009 06:37:36 -0600
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. f52c5a985122947b1ea15a3576d4e98365aab27f
In-Reply-To: <200911222324.nAMNOVsH006440@sheep.berlios.de>
References: <200911222324.nAMNOVsH006440@sheep.berlios.de>
Message-ID: <4b0a81d3.9653f10a.042d.ffffb949@mx.google.com>

> commit f52c5a985122947b1ea15a3576d4e98365aab27f
> Author: Christopher Brannon <cmbrannon79 at gmail.com>
> Date:   Sun Nov 22 17:03:43 2009 -0600
> 
>     Add archlinux/database.sqlite3 to .gitignore.
>     This is the name of the database file used for testing purposes in the
>     sample settings file.

Sebastian sent me a mail about this one, but I don't think it made it to
the list.  He says that the filename belongs in the local .git/info/exclude,
rather than the shared .gitignore, because it is a local setting.
Feel free to revert my commit if you like.

> commit 7349ed8cbb34db08f56eae5f669dbecf32b9adee
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Sat Nov 21 15:32:59 2009 +0100
> 
>     Refactor archlinux/aur/forms.py

Repository.objects.all is a method, not an iterable.  So line 15 of
archlinux/aur/forms.py should read:
        for repository in Repository.objects.all():

Out of curiosity, are you running the code locally?  This is something that
you could have caught before committing.

PS.  On another note, does anyone know why
the list server for this list doesn't generate a Reply-To: header?
Most mailman list servers do.
I don't know whether this option is global to all lists on a server,
or configurable for a single list in the admin interface.

-- Chris


From icarnales at gmail.com  Mon Nov 23 14:02:43 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Mon, 23 Nov 2009 11:02:43 -0200
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	f52c5a985122947b1ea15a3576d4e98365aab27f
In-Reply-To: <4b0a81d3.9653f10a.042d.ffffb949@mx.google.com>
References: <200911222324.nAMNOVsH006440@sheep.berlios.de> 
	<4b0a81d3.9653f10a.042d.ffffb949@mx.google.com>
Message-ID: <d83f7a8d0911230502n2d8f5334u99adbcd4b19b5478@mail.gmail.com>

> PS. ?On another note, does anyone know why
> the list server for this list doesn't generate a Reply-To: header?
> Most mailman list servers do.
> I don't know whether this option is global to all lists on a server,
> or configurable for a single list in the admin interface.
>

The option is configurated by lists, in the mailman admin inteface, bye!


From djszapi at archlinux.us  Mon Nov 23 20:38:50 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Mon, 23 Nov 2009 20:38:50 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	f52c5a985122947b1ea15a3576d4e98365aab27f
In-Reply-To: <4b0a81d3.9653f10a.042d.ffffb949@mx.google.com>
References: <200911222324.nAMNOVsH006440@sheep.berlios.de>
	<4b0a81d3.9653f10a.042d.ffffb949@mx.google.com>
Message-ID: <a362e8010911231138q6676484clbdf9aa0d6b9cb4c2@mail.gmail.com>

On Mon, Nov 23, 2009 at 1:37 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
>> commit f52c5a985122947b1ea15a3576d4e98365aab27f
>> Author: Christopher Brannon <cmbrannon79 at gmail.com>
>> Date: ? Sun Nov 22 17:03:43 2009 -0600
>>
>> ? ? Add archlinux/database.sqlite3 to .gitignore.
>> ? ? This is the name of the database file used for testing purposes in the
>> ? ? sample settings file.
>
> Sebastian sent me a mail about this one, but I don't think it made it to
> the list. ?He says that the filename belongs in the local .git/info/exclude,
> rather than the shared .gitignore, because it is a local setting.
> Feel free to revert my commit if you like.

I presume its a file that is used for test purposes across all
contributors, so .gitignore is ok for me.

>> commit 7349ed8cbb34db08f56eae5f669dbecf32b9adee
>> Author: Laszlo Papp <djszapi at archlinux.us>
>> Date: ? Sat Nov 21 15:32:59 2009 +0100
>>
>> ? ? Refactor archlinux/aur/forms.py
>
> Repository.objects.all is a method, not an iterable. ?So line 15 of
> archlinux/aur/forms.py should read:
> ? ? ? ?for repository in Repository.objects.all():
>
> Out of curiosity, are you running the code locally? ?This is something that
> you could have caught before committing.

I will look at it, thanks.

> PS. ?On another note, does anyone know why
> the list server for this list doesn't generate a Reply-To: header?
> Most mailman list servers do.
> I don't know whether this option is global to all lists on a server,
> or configurable for a single list in the admin interface.
>
> -- Chris

There is the following option on the admin interface:

Should any existing Reply-To: header found in the original message be
stripped? If so, this will be done regardless of whether an explict
Reply-To: header is added by Mailman or not.

I've switched it.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Wed Nov 25 03:36:55 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Wed, 25 Nov 2009 03:36:55 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 0a09d0f69975c8a387d46b2ac8b5c619c2d3b5f9
Message-ID: <200911250236.nAP2at4N012614@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  0a09d0f69975c8a387d46b2ac8b5c619c2d3b5f9 (commit)
       via  72889c8b4668879680b4126b9b298ab33c6b31da (commit)
       via  d825583df5556c9d875f1f53c2aff0964477fcd8 (commit)
       via  67a1de2c4d09c848be7e9a766d8c9af7ba1ed897 (commit)
      from  f52c5a985122947b1ea15a3576d4e98365aab27f (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 0a09d0f69975c8a387d46b2ac8b5c619c2d3b5f9
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Wed Nov 25 03:26:09 2009 +0100

    Change for aur2-dev mailing list, ./templates/base.html
    
    Change the http://mailman.archlinux.org/mailman/listinfo/aur-general mailing
    list url for https://lists.berlios.de/mailman/listinfo/aur2-dev during clicking
    the Mailing List option on the AUR2 page until it's not an official supported
    application
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 72889c8b4668879680b4126b9b298ab33c6b31da
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Wed Nov 25 03:21:40 2009 +0100

    Fix iterable issue in ./aur/forms.py
    
    It was needed because Repository.objects.all is a method, not an iterable.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit d825583df5556c9d875f1f53c2aff0964477fcd8
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Wed Nov 25 03:12:03 2009 +0100

    Add 'any' to the architectures
    
    Add 'any' to the architectures then initial_data was generated again with the
    following options:
    
    ./manage.py dumpdata aur --indent 4 --format xml > aur/fixtures/initial_data.xml
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 67a1de2c4d09c848be7e9a766d8c9af7ba1ed897
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Mon Nov 23 00:42:23 2009 +0100

    Fix some warnings/errors in aurprofile/forms.py
    
    Fix the following warnings/errors:
    
    * W:  5:ProfileUpdateForm.Meta: Class has no __init__ method
    * C:  4:ProfileUpdateForm: Missing docstring
    * C:  5:ProfileUpdateForm.Meta: Missing docstring
    * Implement better exception handling in this file
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 archlinux/aur/fixtures/initial_data.xml |   15 +++++++++------
 archlinux/aur/forms.py                  |    4 ++--
 archlinux/aurprofile/forms.py           |   16 ++++++++++++++++
 archlinux/templates/base.html           |    3 ++-
 4 files changed, 29 insertions(+), 9 deletions(-)


hooks/post-receive
-- 
Project aur2 at BerliOS


From sebnow at gmail.com  Wed Nov 25 14:58:33 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Wed, 25 Nov 2009 21:58:33 +0800
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 0a09d0f69975c8a387d46b2ac8b5c619c2d3b5f9
In-Reply-To: <200911250236.nAP2at4N012614@sheep.berlios.de>
References: <200911250236.nAP2at4N012614@sheep.berlios.de>
Message-ID: <CC40E7CC-8297-4072-93B2-0D197E647241@gmail.com>


On Nov 25, 2009, at 10:36 AM, djszapi at archlinux.us wrote:

> commit d825583df5556c9d875f1f53c2aff0964477fcd8
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Wed Nov 25 03:12:03 2009 +0100
>
>    Add 'any' to the architectures
>
>    Add 'any' to the architectures then initial_data was generated  
> again with the
>    following options:
>
>    ./manage.py dumpdata aur --indent 4 --format xml > aur/fixtures/ 
> initial_data.xml

Perhaps architectures should be created if they don't exist, like  
licenses?

The commit also moves two repositories in initial_data.xml for no  
apparent reason. Please make commits cleaner (i.e. only changes  
relevant to the commit).

>    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>
> commit 67a1de2c4d09c848be7e9a766d8c9af7ba1ed897
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Mon Nov 23 00:42:23 2009 +0100
>
>    Fix some warnings/errors in aurprofile/forms.py
>
>    Fix the following warnings/errors:
>
>    * W:  5:ProfileUpdateForm.Meta: Class has no __init__ method
>    * C:  4:ProfileUpdateForm: Missing docstring
>    * C:  5:ProfileUpdateForm.Meta: Missing docstring
>    * Implement better exception handling in this file

Could you explain this commit? If the comments are there just to get  
rid of the warnings, then ignore the warnings, otherwise, please  
actually describe the class/method the docstring is for. I also don't  
understand why throw an exception in the __init__ method. Also to get  
rid of the warning? Please don't be so pedantic about it, these tools  
don't always give the best advice, as you can clearly see.



From djszapi at archlinux.us  Wed Nov 25 20:10:35 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Wed, 25 Nov 2009 20:10:35 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	0a09d0f69975c8a387d46b2ac8b5c619c2d3b5f9
In-Reply-To: <CC40E7CC-8297-4072-93B2-0D197E647241@gmail.com>
References: <200911250236.nAP2at4N012614@sheep.berlios.de>
	<CC40E7CC-8297-4072-93B2-0D197E647241@gmail.com>
Message-ID: <a362e8010911251110u356f2eddhc7d0cdd798e9ddda@mail.gmail.com>

On Wed, Nov 25, 2009 at 2:58 PM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 25, 2009, at 10:36 AM, djszapi at archlinux.us wrote:
>
>> commit d825583df5556c9d875f1f53c2aff0964477fcd8
>> Author: Laszlo Papp <djszapi at archlinux.us>
>> Date: ? Wed Nov 25 03:12:03 2009 +0100
>>
>> ? ?Add 'any' to the architectures
>>
>> ? ?Add 'any' to the architectures then initial_data was generated
>> again with the
>> ? ?following options:
>>
>> ? ?./manage.py dumpdata aur --indent 4 --format xml > aur/fixtures/
>> initial_data.xml
>
> Perhaps architectures should be created if they don't exist, like
> licenses?

> The commit also moves two repositories in initial_data.xml for no
> apparent reason. Please make commits cleaner (i.e. only changes
> relevant to the commit).

As the commit says I've just added the relatively new 'any'
architecture that's used recently rather, no else changed here to the
initial_data.xml


>> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>>
>> commit 67a1de2c4d09c848be7e9a766d8c9af7ba1ed897
>> Author: Laszlo Papp <djszapi at archlinux.us>
>> Date: ? Mon Nov 23 00:42:23 2009 +0100
>>
>> ? ?Fix some warnings/errors in aurprofile/forms.py
>>
>> ? ?Fix the following warnings/errors:
>>
>> ? ?* W: ?5:ProfileUpdateForm.Meta: Class has no __init__ method
>> ? ?* C: ?4:ProfileUpdateForm: Missing docstring
>> ? ?* C: ?5:ProfileUpdateForm.Meta: Missing docstring
>> ? ?* Implement better exception handling in this file
>
> Could you explain this commit? If the comments are there just to get
> rid of the warnings, then ignore the warnings, otherwise, please
> actually describe the class/method the docstring is for. I also don't
> understand why throw an exception in the __init__ method. Also to get
> rid of the warning? Please don't be so pedantic about it, these tools
> don't always give the best advice, as you can clearly see.

Yeah, you're right Sebastian, pylint, cppcheck, phplint, php-sat,
phpcs, pdepend are just code syntax and coding style checkers, but I
don't think I'd like to ignore them, it can detect sometimes trivial
bugs, that I can't see at first glance.

Exception:
Because you shouldn't ever be instanciating an object from that class,
it would be an error, But maybe it would be just to leave init out all
together.

Thanks the feedbacks, reviews!

Best Regards,
Laszlo Papp


From cmbrannon79 at gmail.com  Tue Nov 24 15:55:01 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Tue, 24 Nov 2009 08:55:01 -0600
Subject: [aur2-dev] [PATCH 1/2] Misc syntax fixes.
Message-ID: <4b0da78b.0906c00a.16cb.0291@mx.google.com>

* Removed an unnecessary call to os.path.join from the same file.
The pathname had already been constructed.  The call was a no-op.
* Add EOF to the end of parsepkgbuild.sh, so that package uploading works.
* Remove the text "ah" from the middle of a template.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/aur/Package/parsepkgbuild.sh      |    1 +
 archlinux/aur/forms.py                      |    2 +-
 archlinux/templates/aur/package_detail.html |    2 +-
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/archlinux/aur/Package/parsepkgbuild.sh b/archlinux/aur/Package/parsepkgbuild.sh
index f08a8d8..3e262db 100755
--- a/archlinux/aur/Package/parsepkgbuild.sh
+++ b/archlinux/aur/Package/parsepkgbuild.sh
@@ -58,3 +58,4 @@ print_array sha1sums    "\${sha1sums[@]}"
 print_array sha256sums  "\${sha256sums[@]}"
 print_array sha384sums  "\${sha384sums[@]}"
 print_array sha512sums  "\${sha512sums[@]}"
+EOF
diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
index a50f767..b8e41e6 100644
--- a/archlinux/aur/forms.py
+++ b/archlinux/aur/forms.py
@@ -235,7 +235,7 @@ class PackageSubmitForm(forms.Form):
             # If it's a local file, save to disk, otherwise record as url
             source_file = os.path.join(tmpdir_sources, package.name, source_filename)
             if is_tarfile and os.path.exists(source_file):
-                fp = File(open(os.path.join(source_file), "r"))
+                fp = File(open(source_file, "r"))
                 source.filename.save('%(name)s/sources/' + source_filename, fp)
                 fp.close()
             else:
diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
index 59abf9f..b58f49b 100644
--- a/archlinux/templates/aur/package_detail.html
+++ b/archlinux/templates/aur/package_detail.html
@@ -49,7 +49,7 @@
         </tr><tr>
             <th>{% trans "Download" %}</th>
             <td><a href="{{ pkg.tarball.url }}">{{ pkg.get_tarball_basename }}</a></td>
-        </tr>ah
+        </tr>
     </table>
     <br />
     <table width="100%">
-- 
1.6.4.4



From cmbrannon79 at gmail.com  Wed Nov 25 22:46:03 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Wed, 25 Nov 2009 15:46:03 -0600
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
Message-ID: <4b0da799.0407c00a.25d9.0250@mx.google.com>

A Vote object records the fact that a given user voted for a certain
package at a known time.
Voting and unvoting are implemented.  Also, the details page for a package
shows the number of votes that it has received.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/aur/models.py                     |   13 ++++++
 archlinux/aur/templatetags/aur_tags.py      |   10 ++++-
 archlinux/aur/tests.py                      |   59 ++++++++++++++++++++++++++-
 archlinux/aur/urls.py                       |    4 ++
 archlinux/aur/views.py                      |   24 +++++++++++
 archlinux/templates/aur/package_detail.html |    9 ++++
 6 files changed, 117 insertions(+), 2 deletions(-)

diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
index 6bc7a85..4c9bcb8 100644
--- a/archlinux/aur/models.py
+++ b/archlinux/aur/models.py
@@ -1,5 +1,6 @@
 from django.db import models
 from django.db import transaction
+from django.db import IntegrityError
 from django.contrib.auth.models import User
 from django.core.mail import send_mass_mail
 from django.db.models import signals, permalink
@@ -183,6 +184,18 @@ class PackageNotification(models.Model):
                 self.package.name)
 
 
+class Vote(models.Model):
+    user = models.ForeignKey(User)
+    package = models.ForeignKey(Package)
+    when = models.DateTimeField(editable=False, default=datetime.now())
+
+    def __unicode__(self):
+        return u"%s's vote for %s" % (self.user.username,
+                self.package.name)
+
+    class Meta:
+        unique_together = (("user", "package"),)
+
 # Should this be here?
 def email_package_updates(sender, instance, signal, *args, **kwargs):
     from django.conf import settings
diff --git a/archlinux/aur/templatetags/aur_tags.py b/archlinux/aur/templatetags/aur_tags.py
index 141a21b..56a6765 100644
--- a/archlinux/aur/templatetags/aur_tags.py
+++ b/archlinux/aur/templatetags/aur_tags.py
@@ -1,7 +1,7 @@
 from django.template import Library
 from django.template.defaultfilters import stringfilter
 from django.contrib.auth.models import User
-from aur.models import Package, PackageNotification
+from aur.models import Package, PackageNotification, Vote
 import re
 
 register = Library()
@@ -15,6 +15,14 @@ def has_update_notification(user, package):
     return total != 0
 
 @register.filter
+def has_vote(user, package):
+    if not isinstance(user, User):
+        return False
+    total = Vote.objects.filter(user=user,
+        package=package).count()
+    return total != 0
+
+ at register.filter
 @stringfilter
 def merge_query_string(url, query_string):
     """Merge two query strings"""
diff --git a/archlinux/aur/tests.py b/archlinux/aur/tests.py
index 0cbe82a..3c5763e 100644
--- a/archlinux/aur/tests.py
+++ b/archlinux/aur/tests.py
@@ -1,3 +1,4 @@
+from datetime import datetime
 from django.test import TestCase
 from django.core.urlresolvers import reverse
 from django.contrib.auth.models import User
@@ -5,7 +6,7 @@ from django.core import mail
 from django.template import Template, Context
 
 from aur.forms import PackageSearchForm
-from aur.models import Package, PackageNotification
+from aur.models import Package, PackageNotification, Vote
 
 class AurTestCase(TestCase):
     fixtures = ['test/users', 'test/packages']
@@ -45,6 +46,43 @@ class AurViewTests(AurTestCase):
         }))
         self.assertEqual(response.status_code, 404)
 
+    def test_vote_view(self):
+        user = User.objects.get(username='normal_user')
+        package = Package.objects.get(name='unique_package')
+        self.client.login(username=user.username, password='normal_user')
+        response = self.client.get(reverse('aur-vote', kwargs={
+            'object_id': package.name,
+        }))
+        self.assertRedirects(response, reverse('aur-package_detail', kwargs={
+            'slug': package.name,
+        }))
+        self.assertEqual(user.vote_set.count(), 1)
+        self.assertEqual(package.vote_set.count(), 1)
+        response = self.client.get(reverse('aur-vote', kwargs={
+            'object_id': 'DoesNotExist',
+        }))
+        self.assertEqual(response.status_code, 404)
+        # Make sure that we didn't count a vote for a nonexistent package...
+        self.assertEqual(user.vote_set.count(), 1)
+
+    def test_unvote_view(self):
+        package = Package.objects.get(name='unique_package')
+        user = User.objects.get(username='normal_user')
+        Vote(package=package, user=user, when=datetime.now()).save()
+        self.client.login(username=user.username, password='normal_user')
+        response = self.client.get(reverse('aur-unvote', kwargs={
+            'object_id': package.name,
+        }))
+        self.assertRedirects(response, reverse('aur-package_detail', kwargs={
+            'slug': package.name,
+        }))
+        self.assertEqual(package.vote_set.count(), 0)
+        self.assertEqual(user.vote_set.count(), 0)
+        response = self.client.get(reverse('aur-unvote', kwargs={
+            'object_id': 'DoesNotExist',
+        }))
+        self.assertEqual(response.status_code, 404)
+
 class AurAPITests(AurTestCase):
     def test_search_view(self):
         response = self.client.get(reverse('aur.views.api_search', kwargs={
@@ -120,3 +158,22 @@ class AurTemplateTagTests(AurTestCase):
         PackageNotification(package=package, user=user).save()
         self.assertEquals(template.render(context).strip(), "True")
 
+    def test_has_vote(self):
+        user = User.objects.get(username='normal_user')
+        package = Package.objects.get(name='unique_package')
+        context = Context({
+            'user': user,
+            'package': package,
+        })
+        template = Template("""
+            {% load aur_tags %}
+            {% if user|has_vote:package %}
+                True
+            {% else %}
+                False
+            {% endif %}
+        """)
+        self.assertEquals(template.render(context).strip(), "False")
+        Vote(package=package, user=user, when=datetime.now()).save()
+        self.assertEquals(template.render(context).strip(), "True")
+
diff --git a/archlinux/aur/urls.py b/archlinux/aur/urls.py
index 4b3a4b4..0bf2067 100644
--- a/archlinux/aur/urls.py
+++ b/archlinux/aur/urls.py
@@ -14,6 +14,10 @@ urlpatterns = patterns('aur.views',
         name='aur-comment_on_package'),
     url(r'^package/(?P<object_id>[\w_-]+)/flag_out_of_date/$',
         'flag_out_of_date', name='aur-flag_out_of_date'),
+    url(r'^package/(?P<object_id>[\w_-]+)/vote/$',
+        'vote', name='aur-vote'),
+    url(r'^package/(?P<object_id>[\w_-]+)/unvote/$',
+        'unvote', name='aur-unvote'),
     url(r'^package/(?P<object_id>[\w_-]+)/notify_of_updates/$',
         'notify_of_updates', name='aur-notify_of_updates'),
     url(r'^package/(?P<object_id>[\w_-]+)/denotify_of_updates/$',
diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
index e6ec7b7..d68e973 100644
--- a/archlinux/aur/views.py
+++ b/archlinux/aur/views.py
@@ -3,6 +3,7 @@ import os
 import sys
 import tarfile
 import hashlib
+import datetime
 
 from django.shortcuts import render_to_response, get_object_or_404
 from django.http import HttpResponse, HttpResponseRedirect
@@ -12,6 +13,7 @@ from django.contrib.auth.decorators import login_required
 from django.core.urlresolvers import reverse
 from django.core import serializers
 from django.utils.translation import ugettext
+from django.db import IntegrityError
 
 from aur.models import *
 from aur.forms import PackageSearchForm, PackageSubmitForm
@@ -155,6 +157,28 @@ def denotify_of_updates(request, object_id):
     return HttpResponseRedirect(reverse('aur-package_detail',
         args=[object_id,]))
 
+ at login_required
+def vote(request, object_id):
+    """Record a user's vote for a package"""
+    package = get_object_or_404(Package, name=object_id)
+    try:
+        Vote(package=package, user=request.user,
+                when=datetime.now()).save()
+    except IntegrityError: # Ignore the duplicate.  Voter fraud not allowed!
+        pass # Should we complain?
+    return HttpResponseRedirect(reverse('aur-package_detail',
+        args=[object_id,]))
+
+ at login_required
+def unvote(request, object_id):
+    """Remove a user's vote for a package"""
+    try:
+        Vote.objects.get(package__name=object_id, user=request.user).delete()
+    except Vote.DoesNotExist:
+        pass
+    return HttpResponseRedirect(reverse('aur-package_detail',
+        args=[object_id,]))
+
 def api_search(request, query, format):
     results = Package.objects.filter(name__icontains=query)
     data = serializers.serialize(format, results,
diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
index b58f49b..e4516f7 100644
--- a/archlinux/templates/aur/package_detail.html
+++ b/archlinux/templates/aur/package_detail.html
@@ -9,6 +9,12 @@
     <div style="float:right" class="listing">
         <ul class="small">
             <li>
+                {% if user|has_vote:pkg %}
+                <a href="{% url aur-unvote object_id=pkg.name %}">{% trans "Remove my vote" %}</a>
+                {% else %}
+                <a href="{% url aur-vote object_id=pkg.name %}">{% trans "Record my vote for this package" %}</a></li>
+                {% endif %}
+            <li>
                 {% if user|has_update_notification:pkg %}
                 <a href="{% url aur-denotify_of_updates object_id=pkg.name %}">{% trans "Stop notifying me of updates" %}</a>
                 {% else %}
@@ -44,6 +50,9 @@
             <th>{% trans "Maintainer" %}:</th>
             <td>{{ pkg.maintainers.all|join:", " }}</td>
         </tr><tr>
+            <th>{% trans "Votes" %}:</th>
+            <td>{{ pkg.vote_set.count }}</td>
+        </tr><tr>
             <th>{% trans "Last Updated" %}:</th>
             <td>{{ pkg.updated|date:"Y-m-d H:i:s" }}</td>
         </tr><tr>
-- 
1.6.4.4



From djszapi at archlinux.us  Wed Nov 25 23:05:19 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Wed, 25 Nov 2009 23:05:19 +0100
Subject: [aur2-dev] [PATCH 1/2] Misc syntax fixes.
In-Reply-To: <4b0da78b.0906c00a.16cb.0291@mx.google.com>
References: <4b0da78b.0906c00a.16cb.0291@mx.google.com>
Message-ID: <a362e8010911251405l15c0419dj540513c52613a1d3@mail.gmail.com>

On Tue, Nov 24, 2009 at 3:55 PM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:
> * Removed an unnecessary call to os.path.join from the same file.
> The pathname had already been constructed. ?The call was a no-op.
> * Add EOF to the end of parsepkgbuild.sh, so that package uploading works.
> * Remove the text "ah" from the middle of a template.
>
> Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
> ---
> ?archlinux/aur/Package/parsepkgbuild.sh ? ? ?| ? ?1 +
> ?archlinux/aur/forms.py ? ? ? ? ? ? ? ? ? ? ?| ? ?2 +-
> ?archlinux/templates/aur/package_detail.html | ? ?2 +-
> ?3 files changed, 3 insertions(+), 2 deletions(-)
>
> diff --git a/archlinux/aur/Package/parsepkgbuild.sh b/archlinux/aur/Package/parsepkgbuild.sh
> index f08a8d8..3e262db 100755
> --- a/archlinux/aur/Package/parsepkgbuild.sh
> +++ b/archlinux/aur/Package/parsepkgbuild.sh
> @@ -58,3 +58,4 @@ print_array sha1sums ? ?"\${sha1sums[@]}"
> ?print_array sha256sums ?"\${sha256sums[@]}"
> ?print_array sha384sums ?"\${sha384sums[@]}"
> ?print_array sha512sums ?"\${sha512sums[@]}"
> +EOF
> diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
> index a50f767..b8e41e6 100644
> --- a/archlinux/aur/forms.py
> +++ b/archlinux/aur/forms.py
> @@ -235,7 +235,7 @@ class PackageSubmitForm(forms.Form):
> ? ? ? ? ? ? # If it's a local file, save to disk, otherwise record as url
> ? ? ? ? ? ? source_file = os.path.join(tmpdir_sources, package.name, source_filename)
> ? ? ? ? ? ? if is_tarfile and os.path.exists(source_file):
> - ? ? ? ? ? ? ? ?fp = File(open(os.path.join(source_file), "r"))
> + ? ? ? ? ? ? ? ?fp = File(open(source_file, "r"))
> ? ? ? ? ? ? ? ? source.filename.save('%(name)s/sources/' + source_filename, fp)
> ? ? ? ? ? ? ? ? fp.close()
> ? ? ? ? ? ? else:
> diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
> index 59abf9f..b58f49b 100644
> --- a/archlinux/templates/aur/package_detail.html
> +++ b/archlinux/templates/aur/package_detail.html
> @@ -49,7 +49,7 @@
> ? ? ? ? </tr><tr>
> ? ? ? ? ? ? <th>{% trans "Download" %}</th>
> ? ? ? ? ? ? <td><a href="{{ pkg.tarball.url }}">{{ pkg.get_tarball_basename }}</a></td>
> - ? ? ? ?</tr>ah
> + ? ? ? ?</tr>
> ? ? </table>
> ? ? <br />
> ? ? <table width="100%">
> --
> 1.6.4.4
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

I'd wait for Sebastian answer with changing 'parsepkgbuild.sh' file!
He works on the new PKGBUILD parser, I don't know how much this patch
touches his work.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Wed Nov 25 23:14:16 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Wed, 25 Nov 2009 23:14:16 +0100
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <4b0da799.0407c00a.25d9.0250@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
Message-ID: <a362e8010911251414q3b73f9d6oddd712a4d30333d9@mail.gmail.com>

On Wed, Nov 25, 2009 at 10:46 PM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:
> A Vote object records the fact that a given user voted for a certain
> package at a known time.
> Voting and unvoting are implemented. ?Also, the details page for a package
> shows the number of votes that it has received.
>
> Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
> ---
> ?archlinux/aur/models.py ? ? ? ? ? ? ? ? ? ? | ? 13 ++++++
> ?archlinux/aur/templatetags/aur_tags.py ? ? ?| ? 10 ++++-
> ?archlinux/aur/tests.py ? ? ? ? ? ? ? ? ? ? ?| ? 59 ++++++++++++++++++++++++++-
> ?archlinux/aur/urls.py ? ? ? ? ? ? ? ? ? ? ? | ? ?4 ++
> ?archlinux/aur/views.py ? ? ? ? ? ? ? ? ? ? ?| ? 24 +++++++++++
> ?archlinux/templates/aur/package_detail.html | ? ?9 ++++
> ?6 files changed, 117 insertions(+), 2 deletions(-)
>
> diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
> index 6bc7a85..4c9bcb8 100644
> --- a/archlinux/aur/models.py
> +++ b/archlinux/aur/models.py
> @@ -1,5 +1,6 @@
> ?from django.db import models
> ?from django.db import transaction
> +from django.db import IntegrityError
> ?from django.contrib.auth.models import User
> ?from django.core.mail import send_mass_mail
> ?from django.db.models import signals, permalink
> @@ -183,6 +184,18 @@ class PackageNotification(models.Model):
> ? ? ? ? ? ? ? ? self.package.name)
>
>
> +class Vote(models.Model):
> + ? ?user = models.ForeignKey(User)
> + ? ?package = models.ForeignKey(Package)
> + ? ?when = models.DateTimeField(editable=False, default=datetime.now())
> +
> + ? ?def __unicode__(self):
> + ? ? ? ?return u"%s's vote for %s" % (self.user.username,
> + ? ? ? ? ? ? ? ?self.package.name)
> +
> + ? ?class Meta:
> + ? ? ? ?unique_together = (("user", "package"),)
> +
> ?# Should this be here?
> ?def email_package_updates(sender, instance, signal, *args, **kwargs):
> ? ? from django.conf import settings
> diff --git a/archlinux/aur/templatetags/aur_tags.py b/archlinux/aur/templatetags/aur_tags.py
> index 141a21b..56a6765 100644
> --- a/archlinux/aur/templatetags/aur_tags.py
> +++ b/archlinux/aur/templatetags/aur_tags.py
> @@ -1,7 +1,7 @@
> ?from django.template import Library
> ?from django.template.defaultfilters import stringfilter
> ?from django.contrib.auth.models import User
> -from aur.models import Package, PackageNotification
> +from aur.models import Package, PackageNotification, Vote
> ?import re
>
> ?register = Library()
> @@ -15,6 +15,14 @@ def has_update_notification(user, package):
> ? ? return total != 0
>
> ?@register.filter
> +def has_vote(user, package):
> + ? ?if not isinstance(user, User):
> + ? ? ? ?return False
> + ? ?total = Vote.objects.filter(user=user,
> + ? ? ? ?package=package).count()
> + ? ?return total != 0
> +
> + at register.filter
> ?@stringfilter
> ?def merge_query_string(url, query_string):
> ? ? """Merge two query strings"""
> diff --git a/archlinux/aur/tests.py b/archlinux/aur/tests.py
> index 0cbe82a..3c5763e 100644
> --- a/archlinux/aur/tests.py
> +++ b/archlinux/aur/tests.py
> @@ -1,3 +1,4 @@
> +from datetime import datetime
> ?from django.test import TestCase
> ?from django.core.urlresolvers import reverse
> ?from django.contrib.auth.models import User
> @@ -5,7 +6,7 @@ from django.core import mail
> ?from django.template import Template, Context
>
> ?from aur.forms import PackageSearchForm
> -from aur.models import Package, PackageNotification
> +from aur.models import Package, PackageNotification, Vote
>
> ?class AurTestCase(TestCase):
> ? ? fixtures = ['test/users', 'test/packages']
> @@ -45,6 +46,43 @@ class AurViewTests(AurTestCase):
> ? ? ? ? }))
> ? ? ? ? self.assertEqual(response.status_code, 404)
>
> + ? ?def test_vote_view(self):
> + ? ? ? ?user = User.objects.get(username='normal_user')
> + ? ? ? ?package = Package.objects.get(name='unique_package')
> + ? ? ? ?self.client.login(username=user.username, password='normal_user')
> + ? ? ? ?response = self.client.get(reverse('aur-vote', kwargs={
> + ? ? ? ? ? ?'object_id': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertRedirects(response, reverse('aur-package_detail', kwargs={
> + ? ? ? ? ? ?'slug': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(user.vote_set.count(), 1)
> + ? ? ? ?self.assertEqual(package.vote_set.count(), 1)
> + ? ? ? ?response = self.client.get(reverse('aur-vote', kwargs={
> + ? ? ? ? ? ?'object_id': 'DoesNotExist',
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(response.status_code, 404)
> + ? ? ? ?# Make sure that we didn't count a vote for a nonexistent package...
> + ? ? ? ?self.assertEqual(user.vote_set.count(), 1)
> +
> + ? ?def test_unvote_view(self):
> + ? ? ? ?package = Package.objects.get(name='unique_package')
> + ? ? ? ?user = User.objects.get(username='normal_user')
> + ? ? ? ?Vote(package=package, user=user, when=datetime.now()).save()
> + ? ? ? ?self.client.login(username=user.username, password='normal_user')
> + ? ? ? ?response = self.client.get(reverse('aur-unvote', kwargs={
> + ? ? ? ? ? ?'object_id': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertRedirects(response, reverse('aur-package_detail', kwargs={
> + ? ? ? ? ? ?'slug': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(package.vote_set.count(), 0)
> + ? ? ? ?self.assertEqual(user.vote_set.count(), 0)
> + ? ? ? ?response = self.client.get(reverse('aur-unvote', kwargs={
> + ? ? ? ? ? ?'object_id': 'DoesNotExist',
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(response.status_code, 404)
> +
> ?class AurAPITests(AurTestCase):
> ? ? def test_search_view(self):
> ? ? ? ? response = self.client.get(reverse('aur.views.api_search', kwargs={
> @@ -120,3 +158,22 @@ class AurTemplateTagTests(AurTestCase):
> ? ? ? ? PackageNotification(package=package, user=user).save()
> ? ? ? ? self.assertEquals(template.render(context).strip(), "True")
>
> + ? ?def test_has_vote(self):
> + ? ? ? ?user = User.objects.get(username='normal_user')
> + ? ? ? ?package = Package.objects.get(name='unique_package')
> + ? ? ? ?context = Context({
> + ? ? ? ? ? ?'user': user,
> + ? ? ? ? ? ?'package': package,
> + ? ? ? ?})
> + ? ? ? ?template = Template("""
> + ? ? ? ? ? ?{% load aur_tags %}
> + ? ? ? ? ? ?{% if user|has_vote:package %}
> + ? ? ? ? ? ? ? ?True
> + ? ? ? ? ? ?{% else %}
> + ? ? ? ? ? ? ? ?False
> + ? ? ? ? ? ?{% endif %}
> + ? ? ? ?""")
> + ? ? ? ?self.assertEquals(template.render(context).strip(), "False")
> + ? ? ? ?Vote(package=package, user=user, when=datetime.now()).save()
> + ? ? ? ?self.assertEquals(template.render(context).strip(), "True")
> +
> diff --git a/archlinux/aur/urls.py b/archlinux/aur/urls.py
> index 4b3a4b4..0bf2067 100644
> --- a/archlinux/aur/urls.py
> +++ b/archlinux/aur/urls.py
> @@ -14,6 +14,10 @@ urlpatterns = patterns('aur.views',
> ? ? ? ? name='aur-comment_on_package'),
> ? ? url(r'^package/(?P<object_id>[\w_-]+)/flag_out_of_date/$',
> ? ? ? ? 'flag_out_of_date', name='aur-flag_out_of_date'),
> + ? ?url(r'^package/(?P<object_id>[\w_-]+)/vote/$',
> + ? ? ? ?'vote', name='aur-vote'),
> + ? ?url(r'^package/(?P<object_id>[\w_-]+)/unvote/$',
> + ? ? ? ?'unvote', name='aur-unvote'),
> ? ? url(r'^package/(?P<object_id>[\w_-]+)/notify_of_updates/$',
> ? ? ? ? 'notify_of_updates', name='aur-notify_of_updates'),
> ? ? url(r'^package/(?P<object_id>[\w_-]+)/denotify_of_updates/$',
> diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
> index e6ec7b7..d68e973 100644
> --- a/archlinux/aur/views.py
> +++ b/archlinux/aur/views.py
> @@ -3,6 +3,7 @@ import os
> ?import sys
> ?import tarfile
> ?import hashlib
> +import datetime
>
> ?from django.shortcuts import render_to_response, get_object_or_404
> ?from django.http import HttpResponse, HttpResponseRedirect
> @@ -12,6 +13,7 @@ from django.contrib.auth.decorators import login_required
> ?from django.core.urlresolvers import reverse
> ?from django.core import serializers
> ?from django.utils.translation import ugettext
> +from django.db import IntegrityError
>
> ?from aur.models import *
> ?from aur.forms import PackageSearchForm, PackageSubmitForm
> @@ -155,6 +157,28 @@ def denotify_of_updates(request, object_id):
> ? ? return HttpResponseRedirect(reverse('aur-package_detail',
> ? ? ? ? args=[object_id,]))
>
> + at login_required
> +def vote(request, object_id):
> + ? ?"""Record a user's vote for a package"""
> + ? ?package = get_object_or_404(Package, name=object_id)
> + ? ?try:
> + ? ? ? ?Vote(package=package, user=request.user,
> + ? ? ? ? ? ? ? ?when=datetime.now()).save()
> + ? ?except IntegrityError: # Ignore the duplicate. ?Voter fraud not allowed!
> + ? ? ? ?pass # Should we complain?
> + ? ?return HttpResponseRedirect(reverse('aur-package_detail',
> + ? ? ? ?args=[object_id,]))
> +
> + at login_required
> +def unvote(request, object_id):
> + ? ?"""Remove a user's vote for a package"""
> + ? ?try:
> + ? ? ? ?Vote.objects.get(package__name=object_id, user=request.user).delete()
> + ? ?except Vote.DoesNotExist:
> + ? ? ? ?pass
> + ? ?return HttpResponseRedirect(reverse('aur-package_detail',
> + ? ? ? ?args=[object_id,]))
> +
> ?def api_search(request, query, format):
> ? ? results = Package.objects.filter(name__icontains=query)
> ? ? data = serializers.serialize(format, results,
> diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
> index b58f49b..e4516f7 100644
> --- a/archlinux/templates/aur/package_detail.html
> +++ b/archlinux/templates/aur/package_detail.html
> @@ -9,6 +9,12 @@
> ? ? <div style="float:right" class="listing">
> ? ? ? ? <ul class="small">
> ? ? ? ? ? ? <li>
> + ? ? ? ? ? ? ? ?{% if user|has_vote:pkg %}
> + ? ? ? ? ? ? ? ?<a href="{% url aur-unvote object_id=pkg.name %}">{% trans "Remove my vote" %}</a>
> + ? ? ? ? ? ? ? ?{% else %}
> + ? ? ? ? ? ? ? ?<a href="{% url aur-vote object_id=pkg.name %}">{% trans "Record my vote for this package" %}</a></li>
> + ? ? ? ? ? ? ? ?{% endif %}
> + ? ? ? ? ? ?<li>
> ? ? ? ? ? ? ? ? {% if user|has_update_notification:pkg %}
> ? ? ? ? ? ? ? ? <a href="{% url aur-denotify_of_updates object_id=pkg.name %}">{% trans "Stop notifying me of updates" %}</a>
> ? ? ? ? ? ? ? ? {% else %}
> @@ -44,6 +50,9 @@
> ? ? ? ? ? ? <th>{% trans "Maintainer" %}:</th>
> ? ? ? ? ? ? <td>{{ pkg.maintainers.all|join:", " }}</td>
> ? ? ? ? </tr><tr>
> + ? ? ? ? ? ?<th>{% trans "Votes" %}:</th>
> + ? ? ? ? ? ?<td>{{ pkg.vote_set.count }}</td>
> + ? ? ? ?</tr><tr>
> ? ? ? ? ? ? <th>{% trans "Last Updated" %}:</th>
> ? ? ? ? ? ? <td>{{ pkg.updated|date:"Y-m-d H:i:s" }}</td>
> ? ? ? ? </tr><tr>
> --
> 1.6.4.4
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

Would it be problem for you to use my newly updated django-voting-svn
library(or manually installed one) ?
The code would be more simplier/easier to review/understand later, and
maybe it's better to use that is already written. So this app has a
much larger user base and I would think much more tested, and a larger
devel base.
I'm using this django-voting-svn app for the TU voting application too
that I started to write. Is it a big problem for you ?
http://code.google.com/p/django-voting/

Best Regards,
Laszlo Papp


From cmbrannon79 at gmail.com  Thu Nov 26 04:17:40 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Wed, 25 Nov 2009 21:17:40 -0600
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <a362e8010911251414q3b73f9d6oddd712a4d30333d9@mail.gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<a362e8010911251414q3b73f9d6oddd712a4d30333d9@mail.gmail.com>
Message-ID: <4b0df312.9653f10a.0957.109b@mx.google.com>

Laszlo Papp wrote:
> Would it be problem for you to use my newly updated django-voting-svn
> library(or manually installed one) ?

Laszlo,
I'm not quite sure.  One thing that django-voting doesn't do is record
a timestamp for a vote.  This info could be useful in a few circumstances.
It's mentioned briefly on the wiki page.
Other than that, I don't see why it wouldn't work.

-- Chris


From djszapi at archlinux.us  Thu Nov 26 05:02:31 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Thu, 26 Nov 2009 05:02:31 +0100
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <4b0df312.9653f10a.0957.109b@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<a362e8010911251414q3b73f9d6oddd712a4d30333d9@mail.gmail.com>
	<4b0df312.9653f10a.0957.109b@mx.google.com>
Message-ID: <a362e8010911252002t76bfb166w6a4b3166cbacb3b0@mail.gmail.com>

On Thu, Nov 26, 2009 at 4:17 AM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
> Laszlo Papp wrote:
>> Would it be problem for you to use my newly updated django-voting-svn
>> library(or manually installed one) ?
>
> Laszlo,
> I'm not quite sure. ?One thing that django-voting doesn't do is record
> a timestamp for a vote.

You can modify django-voting to your needs  (you could try to get the
author too)
You can extend it with: "forms.DateField(widget=forms.DateInput(...))", but
forms.DateField(widget=forms.DateInput(format='%d-%m-%Y')) works but
throws a form error "Enter a valid date."

> This info could be useful in a few circumstances.
> It's mentioned briefly on the wiki page.
> Other than that, I don't see why it wouldn't work.
>
> -- Chris

I didn't say it woudn't work or it wouldn't be useful, I like your
idea, really, but I suggested an implementation way above that I think
it would be better to follow, so it's up to you :)

Best Regards,
Laszlo Papp


From sebnow at gmail.com  Thu Nov 26 09:22:22 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Thu, 26 Nov 2009 16:22:22 +0800
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated.  0a09d0f69975c8a387d46b2ac8b5c619c2d3b5f9
In-Reply-To: <a362e8010911251110u356f2eddhc7d0cdd798e9ddda@mail.gmail.com>
References: <200911250236.nAP2at4N012614@sheep.berlios.de>
	<CC40E7CC-8297-4072-93B2-0D197E647241@gmail.com>
	<a362e8010911251110u356f2eddhc7d0cdd798e9ddda@mail.gmail.com>
Message-ID: <8921DC42-09B6-46BA-8BAE-719C868D9311@gmail.com>


On Nov 26, 2009, at 3:10 AM, Laszlo Papp wrote:

> On Wed, Nov 25, 2009 at 2:58 PM, Sebastian Nowicki  
> <sebnow at gmail.com> wrote:
>>
>> On Nov 25, 2009, at 10:36 AM, djszapi at archlinux.us wrote:
>>
>>> commit d825583df5556c9d875f1f53c2aff0964477fcd8
>>> Author: Laszlo Papp <djszapi at archlinux.us>
>>> Date:   Wed Nov 25 03:12:03 2009 +0100
>>>
>>>    Add 'any' to the architectures
>>>
>>>    Add 'any' to the architectures then initial_data was generated
>>> again with the
>>>    following options:
>>>
>>>    ./manage.py dumpdata aur --indent 4 --format xml > aur/fixtures/
>>> initial_data.xml
>>
>> Perhaps architectures should be created if they don't exist, like
>> licenses?
>
>> The commit also moves two repositories in initial_data.xml for no
>> apparent reason. Please make commits cleaner (i.e. only changes
>> relevant to the commit).
>
> As the commit says I've just added the relatively new 'any'
> architecture that's used recently rather, no else changed here to the
> initial_data.xml

Look at the commit diff.

>>>    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>>>
>>> commit 67a1de2c4d09c848be7e9a766d8c9af7ba1ed897
>>> Author: Laszlo Papp <djszapi at archlinux.us>
>>> Date:   Mon Nov 23 00:42:23 2009 +0100
>>>
>>>    Fix some warnings/errors in aurprofile/forms.py
>>>
>>>    Fix the following warnings/errors:
>>>
>>>    * W:  5:ProfileUpdateForm.Meta: Class has no __init__ method
>>>    * C:  4:ProfileUpdateForm: Missing docstring
>>>    * C:  5:ProfileUpdateForm.Meta: Missing docstring
>>>    * Implement better exception handling in this file
>>
>> Could you explain this commit? If the comments are there just to get
>> rid of the warnings, then ignore the warnings, otherwise, please
>> actually describe the class/method the docstring is for. I also don't
>> understand why throw an exception in the __init__ method. Also to get
>> rid of the warning? Please don't be so pedantic about it, these tools
>> don't always give the best advice, as you can clearly see.
>
> Yeah, you're right Sebastian, pylint, cppcheck, phplint, php-sat,
> phpcs, pdepend are just code syntax and coding style checkers, but I
> don't think I'd like to ignore them, it can detect sometimes trivial
> bugs, that I can't see at first glance.

I agree in general, but not when the warning relates to a comment -  
there can't be a bug involved ;).

> Exception:
> Because you shouldn't ever be instanciating an object from that class,
> it would be an error, But maybe it would be just to leave init out all
> together.
>
> Thanks the feedbacks, reviews!
>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev



From sebnow at gmail.com  Thu Nov 26 09:37:13 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Thu, 26 Nov 2009 16:37:13 +0800
Subject: [aur2-dev] [PATCH 1/2] Misc syntax fixes.
In-Reply-To: <a362e8010911251405l15c0419dj540513c52613a1d3@mail.gmail.com>
References: <4b0da78b.0906c00a.16cb.0291@mx.google.com>
	<a362e8010911251405l15c0419dj540513c52613a1d3@mail.gmail.com>
Message-ID: <9A4893EA-64E6-4172-AB88-7A47C4CE77D5@gmail.com>

On Nov 26, 2009, at 6:05 AM, Laszlo Papp wrote:

> On Tue, Nov 24, 2009 at 3:55 PM, Christopher Brannon
> <cmbrannon79 at gmail.com> wrote:
>> * Removed an unnecessary call to os.path.join from the same file.
>> The pathname had already been constructed.  The call was a no-op.
>> * Add EOF to the end of parsepkgbuild.sh, so that package uploading  
>> works.

Oops. Oddly enough package uploading worked for me.

>> * Remove the text "ah" from the middle of a template.

I'd prefer that these were 3 separate patches (as they are 3 different  
logical units of change), but it looks good. Thanks.

> I'd wait for Sebastian answer with changing 'parsepkgbuild.sh' file!
> He works on the new PKGBUILD parser, I don't know how much this patch
> touches his work.

My changes remove the whole file :P. It probably will cause a  
conflict, but it will be easily solved with `git rm parsepkgbuild.sh`.



From sebnow at gmail.com  Thu Nov 26 09:55:25 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Thu, 26 Nov 2009 16:55:25 +0800
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <4b0da799.0407c00a.25d9.0250@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
Message-ID: <D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>


On Nov 26, 2009, at 5:46 AM, Christopher Brannon wrote:

> A Vote object records the fact that a given user voted for a certain
> package at a known time.
> Voting and unvoting are implemented.  Also, the details page for a  
> package
> shows the number of votes that it has received.

I haven't tested it, but it looks fine (bonus points for adding  
tests!), at least from a technical point of view. I'm not sure if this  
should be in the AUR (I know it's in the current one). The "vote"  
feature has been criticized many times, and I believe, after  
discussing it at length, a download counter was in favor of voting. I  
suppose this should be discussed again, or simply added now, and  
potentially removed later on, in favor of download-counting.

A quick run through, from the top of my head:

Voting pros:
* Easy to implement. It doesn't require a "proxy" page to track each  
download.

Voting cons:
* It doesn't really indicate how many people use a package. It simply  
shows that it's in favor of being put into community - this is  
Archlinux specific behaviour, btw.
* The user has to manually go to the website (or use a 3rd party  
client) to vote.

Download counter pros:
* It more accurately shows the popularity of a package.
* A popularity statistic could potentially be created using time,  
package version, and the download counter. I.e., the popularity decays  
with time, but is reset with each new version, or something like that.

Download counter cons:
* There's potential for abuse. A user can only vote once, but  
downloading requires no authentication - bots could continuously  
download a package to increase the counter.
* The "proxy" page required to increase the download counter might be  
a nuisance.

> Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
> ---
> archlinux/aur/models.py                     |   13 ++++++
> archlinux/aur/templatetags/aur_tags.py      |   10 ++++-
> archlinux/aur/tests.py                      |   59 ++++++++++++++++++ 
> ++++++++-
> archlinux/aur/urls.py                       |    4 ++
> archlinux/aur/views.py                      |   24 +++++++++++
> archlinux/templates/aur/package_detail.html |    9 ++++
> 6 files changed, 117 insertions(+), 2 deletions(-)
>
> diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
> index 6bc7a85..4c9bcb8 100644
> --- a/archlinux/aur/models.py
> +++ b/archlinux/aur/models.py
> @@ -1,5 +1,6 @@
> from django.db import models
> from django.db import transaction
> +from django.db import IntegrityError
> from django.contrib.auth.models import User
> from django.core.mail import send_mass_mail
> from django.db.models import signals, permalink
> @@ -183,6 +184,18 @@ class PackageNotification(models.Model):
>                 self.package.name)
>
>
> +class Vote(models.Model):
> +    user = models.ForeignKey(User)
> +    package = models.ForeignKey(Package)
> +    when = models.DateTimeField(editable=False,  
> default=datetime.now())

Perhaps this should be:

when = models.DateTimeField(editable=False, auto_now_add=True)

> DateField.auto_now_add Automatically set the field to now when the  
> object is first created. Useful for creation of timestamps. Note  
> that the current date isalways used; it's not just a default value  
> that you can override.

It seems editable=False might not be necessary in this case.

> [snip]
>
> + at login_required
> +def vote(request, object_id):
> +    """Record a user's vote for a package"""
> +    package = get_object_or_404(Package, name=object_id)
> +    try:
> +        Vote(package=package, user=request.user,
> +                when=datetime.now()).save()

Setting auto_now_add=True would make setting the when parameter  
unnecessary.



From icarnales at gmail.com  Thu Nov 26 11:58:15 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Thu, 26 Nov 2009 08:58:15 -0200
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>
Message-ID: <d83f7a8d0911260258o56e36e73uabb5b5acf88c7235@mail.gmail.com>

Hi, the use of auto_now and auto_now_add has been very "controversial"
in the last time [1], I think it would be better to just override the
Vote saving method to add the date.

Also I suggest using a more "standard" name for the creation date of
the vote (looks like in this project this name would be "added"), for
consistency and to have the posibility in the future of abstracting
the behaviour to a mixin class for example [2].

I see that in the aur app code the timestamping is done in a "mixed
way" (having a defalt for one field and setting the other on save
method) I think is much consistent doing both things on save method
(so you don't have the logic scattered in the model). If you're ok
with this, later I'll send a patch to change this.

byebye!

[1]: http://www.b-list.org/weblog/2006/nov/02/django-tips-auto-populated-fields/
[2]: http://www.eflorenzano.com/blog/post/exploring-mixins-django-model-inheritance/

> Perhaps this should be:
>
> when = models.DateTimeField(editable=False, auto_now_add=True)
>
>> DateField.auto_now_add Automatically set the field to now when the
>> object is first created. Useful for creation of timestamps. Note
>> that the current date isalways used; it's not just a default value
>> that you can override.
>
> It seems editable=False might not be necessary in this case.
>
>> [snip]
>>
>> + at login_required
>> +def vote(request, object_id):
>> + ? ?"""Record a user's vote for a package"""
>> + ? ?package = get_object_or_404(Package, name=object_id)
>> + ? ?try:
>> + ? ? ? ?Vote(package=package, user=request.user,
>> + ? ? ? ? ? ? ? ?when=datetime.now()).save()
>
> Setting auto_now_add=True would make setting the when parameter
> unnecessary.


From sebnow at gmail.com  Thu Nov 26 13:11:04 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Thu, 26 Nov 2009 20:11:04 +0800
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <d83f7a8d0911260258o56e36e73uabb5b5acf88c7235@mail.gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>
	<d83f7a8d0911260258o56e36e73uabb5b5acf88c7235@mail.gmail.com>
Message-ID: <E4E8572F-53F7-482E-94D8-7A9DD926AF11@gmail.com>


On Nov 26, 2009, at 6:58 PM, Ismael Carnales wrote:

> Hi, the use of auto_now and auto_now_add has been very "controversial"
> in the last time [1], I think it would be better to just override the
> Vote saving method to add the date.
>
> Also I suggest using a more "standard" name for the creation date of
> the vote (looks like in this project this name would be "added"), for
> consistency and to have the posibility in the future of abstracting
> the behaviour to a mixin class for example [2].
>
> I see that in the aur app code the timestamping is done in a "mixed
> way" (having a defalt for one field and setting the other on save
> method) I think is much consistent doing both things on save method
> (so you don't have the logic scattered in the model). If you're ok
> with this, later I'll send a patch to change this.

If I remember correctly this was done before auto_now_add was  
available, so this was the only way to do it. I don't really mind  
either way (although auto_now_add results in less code), as long as  
the date doesn't have to be set whenever a new Vote is created.

> byebye!
>
> [1]: http://www.b-list.org/weblog/2006/nov/02/django-tips-auto-populated-fields/
> [2]: http://www.eflorenzano.com/blog/post/exploring-mixins-django-model-inheritance/
>
>> Perhaps this should be:
>>
>> when = models.DateTimeField(editable=False, auto_now_add=True)
>>
>>> DateField.auto_now_add Automatically set the field to now when the
>>> object is first created. Useful for creation of timestamps. Note
>>> that the current date isalways used; it's not just a default value
>>> that you can override.
>>
>> It seems editable=False might not be necessary in this case.
>>
>>> [snip]
>>>
>>> + at login_required
>>> +def vote(request, object_id):
>>> +    """Record a user's vote for a package"""
>>> +    package = get_object_or_404(Package, name=object_id)
>>> +    try:
>>> +        Vote(package=package, user=request.user,
>>> +                when=datetime.now()).save()
>>
>> Setting auto_now_add=True would make setting the when parameter
>> unnecessary.
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev



From sebnow at gmail.com  Thu Nov 26 14:22:28 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Thu, 26 Nov 2009 21:22:28 +0800
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <4b0df312.9653f10a.0957.109b@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<a362e8010911251414q3b73f9d6oddd712a4d30333d9@mail.gmail.com>
	<4b0df312.9653f10a.0957.109b@mx.google.com>
Message-ID: <EA20D885-F3E9-4178-8EFF-3C5938199F99@gmail.com>


On Nov 26, 2009, at 11:17 AM, Chris Brannon wrote:

> Laszlo Papp wrote:
>> Would it be problem for you to use my newly updated django-voting-svn
>> library(or manually installed one) ?
>
> Laszlo,
> I'm not quite sure.  One thing that django-voting doesn't do is record
> a timestamp for a vote.  This info could be useful in a few  
> circumstances.
> It's mentioned briefly on the wiki page.
> Other than that, I don't see why it wouldn't work.
>
> -- Chris
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev

Using django-voting (or another voting app) would be good, if it's  
compatible. However this is a simple model, so if it's too much  
effort, I don't think it's worth it and a "custom" model is fine.


From icarnales at gmail.com  Thu Nov 26 16:55:49 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Thu, 26 Nov 2009 13:55:49 -0200
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <EA20D885-F3E9-4178-8EFF-3C5938199F99@gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<a362e8010911251414q3b73f9d6oddd712a4d30333d9@mail.gmail.com> 
	<4b0df312.9653f10a.0957.109b@mx.google.com>
	<EA20D885-F3E9-4178-8EFF-3C5938199F99@gmail.com>
Message-ID: <d83f7a8d0911260755u46b1fbfn4aba846350c51484@mail.gmail.com>

Regarding the django-voting issue, this app has other voting usage
pattern in mind, as it says in the docs is based on the CheeseRater
code that manages votes as +1 or -1 (upvotes or downvotes). As the
project doesn't seem to have "much" movement, some commits in Aug of
this year and the rest in 2008
http://code.google.com/p/django-voting/source/list, so maybe a simple
custom solution would work fine here.

bye!

On Thu, Nov 26, 2009 at 11:22 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 26, 2009, at 11:17 AM, Chris Brannon wrote:
>
>> Laszlo Papp wrote:
>>> Would it be problem for you to use my newly updated django-voting-svn
>>> library(or manually installed one) ?
>>
>> Laszlo,
>> I'm not quite sure. ?One thing that django-voting doesn't do is record
>> a timestamp for a vote. ?This info could be useful in a few
>> circumstances.
>> It's mentioned briefly on the wiki page.
>> Other than that, I don't see why it wouldn't work.
>>
>> -- Chris
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>
> Using django-voting (or another voting app) would be good, if it's
> compatible. However this is a simple model, so if it's too much
> effort, I don't think it's worth it and a "custom" model is fine.
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From cmbrannon79 at gmail.com  Thu Nov 26 18:32:43 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Thu, 26 Nov 2009 11:32:43 -0600
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>
Message-ID: <4b0ebb78.cf02be0a.2282.30bd@mx.google.com>

Sebastian Nowicki wrote:
> I haven't tested it, but it looks fine (bonus points for adding  
> tests!), at least from a technical point of view.

Unfortunately, the test harness isn't quite working for me.  I get
an error from django-registration, but that may be because of a problem
with my setup.
Here's my traceback:

Traceback (most recent call last):
  File "build/bdist.linux-i686/egg/registration/tests.py", line 141, in test_management_command
    management.call_command('cleanupregistration')
  File "/usr/lib/python2.6/site-packages/django/core/management/__init__.py", line 155, in call_command
    raise CommandError, "Unknown command: %r" % name
CommandError: Unknown command: 'cleanupregistration'

And then I get 4 test failures: 2 from existing tests, 2 from tests that
I added.
Here's a sample traceback:

FAIL: test_search_view (aur.tests.AurViewTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/repo/arch/aur2/archlinux/aur/tests.py", line 29, in test_search_view
    'slug': 'unique_package',
  File "/usr/lib/python2.6/site-packages/django/test/testcases.py", line 315, in assertRedirects
    (path, redirect_response.status_code, target_status_code))
AssertionError: Couldn't retrieve redirection page '/package/unique_package/': response code was 404 (expected 200)

I'm embarrassingly new to Django (started learning it last week), so I'm
not quite sure why this fails.
Manual tests of the vote code in a web browser succeed just fine, though.

> and I believe, after  
> discussing it at length, a download counter was in favor of voting. I  
> suppose this should be discussed again, or simply added now, and  
> potentially removed later on, in favor of download-counting.

Yes, this is a perennial debate topic!
Either solution is fine with me.  Voting always seemed good, because
it requires active user effort [1].

I suppose that the abuse of the download counter could be lessened by
tracking IP addresses.  That has its own problems.  E.G., multiple
boxen behind one public IP address, people with many shell accounts or
friends, Big Brother is watching, et cetera.

*SNIP*
> Setting auto_now_add=True would make setting the when parameter  
> unnecessary.

Ok, thanks.  I didn't notice that one.

-- Chris


From icarnales at gmail.com  Thu Nov 26 19:35:21 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Thu, 26 Nov 2009 16:35:21 -0200
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <4b0ebb78.cf02be0a.2282.30bd@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com> 
	<4b0ebb78.cf02be0a.2282.30bd@mx.google.com>
Message-ID: <d83f7a8d0911261035i419c4dd7o2cc7d0b5417421f8@mail.gmail.com>

> Here's a sample traceback:
>
> FAIL: test_search_view (aur.tests.AurViewTests)
> ----------------------------------------------------------------------
> Traceback (most recent call last):
> ?File "/home/repo/arch/aur2/archlinux/aur/tests.py", line 29, in test_search_view
> ? ?'slug': 'unique_package',
> ?File "/usr/lib/python2.6/site-packages/django/test/testcases.py", line 315, in assertRedirects
> ? ?(path, redirect_response.status_code, target_status_code))
> AssertionError: Couldn't retrieve redirection page '/package/unique_package/': response code was 404 (expected 200)
>

I had and have the same issues with 2 tests of the aur app that needs
data form json fixtures. Apparently the fixtures are not getting
loaded when running the tests and that makes them fail.

Sebnow: do you have this tests errors too?

bye!


From sebnow at gmail.com  Fri Nov 27 06:05:34 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Fri, 27 Nov 2009 13:05:34 +0800
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <d83f7a8d0911261035i419c4dd7o2cc7d0b5417421f8@mail.gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>
	<4b0ebb78.cf02be0a.2282.30bd@mx.google.com>
	<d83f7a8d0911261035i419c4dd7o2cc7d0b5417421f8@mail.gmail.com>
Message-ID: <3B956D51-73E2-4F08-AF85-8003BACFE593@gmail.com>


On Nov 27, 2009, at 2:35 AM, Ismael Carnales wrote:

>> Here's a sample traceback:
>>
>> FAIL: test_search_view (aur.tests.AurViewTests)
>> ----------------------------------------------------------------------
>> Traceback (most recent call last):
>>  File "/home/repo/arch/aur2/archlinux/aur/tests.py", line 29, in  
>> test_search_view
>>    'slug': 'unique_package',
>>  File "/usr/lib/python2.6/site-packages/django/test/testcases.py",  
>> line 315, in assertRedirects
>>    (path, redirect_response.status_code, target_status_code))
>> AssertionError: Couldn't retrieve redirection page '/package/ 
>> unique_package/': response code was 404 (expected 200)
>>
>
> I had and have the same issues with 2 tests of the aur app that needs
> data form json fixtures. Apparently the fixtures are not getting
> loaded when running the tests and that makes them fail.
>
> Sebnow: do you have this tests errors too?
>
> bye!
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev

Yes, a few tests do fail (not sure why, I haven't looked into it). One  
of the notification tests is particularly disturbing, as the actual  
value changes with each run of the tests. It's possible that the  
actual tests are buggy, so it might be tricky to debug.

As for the problem with tests in the registration app, you can omit  
those tests and only run AUR tests as so: python manage.py test aur.


From icarnales at gmail.com  Fri Nov 27 15:19:52 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 12:19:52 -0200
Subject: [aur2-dev] [PATCH] Fix failing aur tests
Message-ID: <1259331592-5974-1-git-send-email-icarnales@gmail.com>

* Added slug to the packages fixture

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/aur/fixtures/test/packages.json |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/archlinux/aur/fixtures/test/packages.json b/archlinux/aur/fixtures/test/packages.json
index 081ebb6..07afe83 100644
--- a/archlinux/aur/fixtures/test/packages.json
+++ b/archlinux/aur/fixtures/test/packages.json
@@ -3,7 +3,8 @@
         "pk": 1,
         "model": "aur.package",
         "fields": {
-			"name": "unique_package",
+            "name": "unique_package",
+            "slug": "unique_package",
             "tags": ["unique"],
             "updated": "2009-01-01 00:00:00",
             "added": "2009-01-01 00:00:00",
-- 
1.6.5.2



From cmbrannon79 at gmail.com  Fri Nov 27 15:46:20 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Fri, 27 Nov 2009 08:46:20 -0600
Subject: [aur2-dev] [PATCH] Fix failing aur tests
In-Reply-To: <1259331592-5974-1-git-send-email-icarnales@gmail.com>
References: <1259331592-5974-1-git-send-email-icarnales@gmail.com>
Message-ID: <4b0fe5f8.9553f10a.61b1.505e@mx.google.com>

> * Added slug to the packages fixture

Aha!  That was brilliant!
The code in tests.py does as it should now.

-- Chris


From icarnales at gmail.com  Fri Nov 27 15:48:40 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 12:48:40 -0200
Subject: [aur2-dev] [PATCH] Fix failing aur tests
In-Reply-To: <4b0fe5f8.9553f10a.61b1.505e@mx.google.com>
References: <1259331592-5974-1-git-send-email-icarnales@gmail.com> 
	<4b0fe5f8.9553f10a.61b1.505e@mx.google.com>
Message-ID: <d83f7a8d0911270648j46dd802crd6775c0638ae086d@mail.gmail.com>

Thanks! Had a hard time finding that one :)

Sebnow: how was the fixture for the test generated? because it was
missing the slug field value, maybe there's something wrong with the
package slug generation.

bye!

On Fri, Nov 27, 2009 at 12:46 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
>> * Added slug to the packages fixture
>
> Aha! ?That was brilliant!
> The code in tests.py does as it should now.
>
> -- Chris
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From sebnow at gmail.com  Fri Nov 27 16:36:05 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Fri, 27 Nov 2009 23:36:05 +0800
Subject: [aur2-dev] [PATCH] Fix failing aur tests
In-Reply-To: <d83f7a8d0911270648j46dd802crd6775c0638ae086d@mail.gmail.com>
References: <1259331592-5974-1-git-send-email-icarnales@gmail.com>
	<4b0fe5f8.9553f10a.61b1.505e@mx.google.com>
	<d83f7a8d0911270648j46dd802crd6775c0638ae086d@mail.gmail.com>
Message-ID: <F9B1EAB6-CCE9-4BEE-A27B-5E5A81488EA4@gmail.com>


On Nov 27, 2009, at 10:19 PM, Ismael Carnales wrote:

> * Added slug to the packages fixture
>
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> archlinux/aur/fixtures/test/packages.json |    3 ++-
> 1 files changed, 2 insertions(+), 1 deletions(-)
>
> diff --git a/archlinux/aur/fixtures/test/packages.json b/archlinux/ 
> aur/fixtures/test/packages.json
> index 081ebb6..07afe83 100644
> --- a/archlinux/aur/fixtures/test/packages.json
> +++ b/archlinux/aur/fixtures/test/packages.json
> @@ -3,7 +3,8 @@
>         "pk": 1,
>         "model": "aur.package",
>         "fields": {
> -			"name": "unique_package",
> +            "name": "unique_package",
> +            "slug": "unique_package",
>             "tags": ["unique"],
>             "updated": "2009-01-01 00:00:00",
>             "added": "2009-01-01 00:00:00",
> -- 
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev

Thanks! Applied in my github repo. I need to figure out how to  
activate my berlios account to be able to push to that repo :/.

On Nov 27, 2009, at 10:48 PM, Ismael Carnales wrote:

> Thanks! Had a hard time finding that one :)
>
> Sebnow: how was the fixture for the test generated? because it was
> missing the slug field value, maybe there's something wrong with the
> package slug generation.

I think I might have actually done it by hand, it would certainly  
explain the contrived dates. Maybe back then the slug wasn't used or  
something. There's no way I would have committed the unit tests if  
they failed.

> bye!
>
> On Fri, Nov 27, 2009 at 12:46 PM, Chris Brannon  
> <cmbrannon79 at gmail.com> wrote:
>>> * Added slug to the packages fixture
>>
>> Aha!  That was brilliant!
>> The code in tests.py does as it should now.
>>
>> -- Chris
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev



From icarnales at gmail.com  Fri Nov 27 17:21:34 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 14:21:34 -0200
Subject: [aur2-dev] Extrange error when uploading some packages
Message-ID: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>

Hi, i'm getting this strange traceback: http://dpaste.com/125925/ when
uploading some packages, I'm attaching 2 PKGBUILDS that throw me the
pasted error. Any ideas?

bye!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PKGBUILD
Type: application/octet-stream
Size: 531 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/aur2-dev/attachments/20091127/bb728c7f/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PKGBUILD
Type: application/octet-stream
Size: 494 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/aur2-dev/attachments/20091127/bb728c7f/attachment-0001.obj>

From sebnow at gmail.com  Fri Nov 27 17:42:10 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sat, 28 Nov 2009 00:42:10 +0800
Subject: [aur2-dev] Extrange error when uploading some packages
In-Reply-To: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
Message-ID: <B324F08E-CA2C-4BBB-9E1A-2C4EEEBF535D@gmail.com>


On Nov 28, 2009, at 12:21 AM, Ismael Carnales wrote:

> Hi, i'm getting this strange traceback: http://dpaste.com/125925/ when
> uploading some packages, I'm attaching 2 PKGBUILDS that throw me the
> pasted error. Any ideas?
>
> bye!
> <PKGBUILD><PKGBUILD>_______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev

I hate these exceptions. Try commenting out lines related to  
transaction management (@transaction.commit_manually,  
transaction.commit()), and upload the PKGBUILDs again. This time it  
should throw the real exception.

I have a feeling this might be related to the lack of EOF in  
parsepkgbuild.sh, that Christopher Brannon fixed in [PATCH 1/2] Misc  
syntax fixes.



From icarnales at gmail.com  Fri Nov 27 17:23:56 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 14:23:56 -0200
Subject: [aur2-dev] Test data
Message-ID: <d83f7a8d0911270823t530b8fc7q594d6ef7a2bff12f@mail.gmail.com>

Hi, I asked this before to Lazlo but didn't get any response. Does
anyone have some "real" test data exported from the running AUR?

It will be good to have such data to test the project, if not maybe we
can contact the current AUR maintainers and try to get a dump/

What do you think?

bye!


From icarnales at gmail.com  Fri Nov 27 18:16:23 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 15:16:23 -0200
Subject: [aur2-dev] [PATCH 1/2] Fix unvote view
In-Reply-To: <4b0da799.0407c00a.25d9.0250@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
Message-ID: <1259342183-12403-1-git-send-email-icarnales@gmail.com>

* get the package using get_object_or_404
* search vote by package object

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/aur/views.py |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
index d68e973..70b3b85 100644
--- a/archlinux/aur/views.py
+++ b/archlinux/aur/views.py
@@ -172,8 +172,9 @@ def vote(request, object_id):
 @login_required
 def unvote(request, object_id):
     """Remove a user's vote for a package"""
+    package = get_object_or_404(Package, name=object_id)
     try:
-        Vote.objects.get(package__name=object_id, user=request.user).delete()
+        Vote.objects.get(package=package, user=request.user).delete()
     except Vote.DoesNotExist:
         pass
     return HttpResponseRedirect(reverse('aur-package_detail',
-- 
1.6.5.2

I'm sending a patch that goes on top of Christopher patch for adding Voting.
Don't know if this is the correct way to do this (sending changes of another
person patches), if not, please tell me the correct way to do this :)

I'm CCing Christopher directly so he can review my proposed changes.

bye!


From cmbrannon79 at gmail.com  Fri Nov 27 18:26:54 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Fri, 27 Nov 2009 11:26:54 -0600
Subject: [aur2-dev] Extrange error when uploading some packages
In-Reply-To: <B324F08E-CA2C-4BBB-9E1A-2C4EEEBF535D@gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
	<B324F08E-CA2C-4BBB-9E1A-2C4EEEBF535D@gmail.com>
Message-ID: <4b100b9a.8802be0a.68ee.5702@mx.google.com>

> I have a feeling this might be related to the lack of EOF in  
> parsepkgbuild.sh, that Christopher Brannon fixed in [PATCH 1/2] Misc  
> syntax fixes.

It works here.  Your uploading a tarball containing a directory named
virtualenv-commands, having a PKGBUILD, right?
I did get these exceptions earlier, when I misnamed the directory.
I somehow managed to call it virtualenv, and in that case, I got the
same results that you did.

In any case, it is behaving badly when the package name disagrees with
the name of the tree in the tarball.

-- Chris


From icarnales at gmail.com  Fri Nov 27 18:21:49 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 15:21:49 -0200
Subject: [aur2-dev] [PATCH 2/2] Minor refactoring to voting
In-Reply-To: <1259342183-12403-1-git-send-email-icarnales@gmail.com>
References: <1259342183-12403-1-git-send-email-icarnales@gmail.com>
Message-ID: <1259342509-12502-1-git-send-email-icarnales@gmail.com>

* Rename when to added (for consistency with other models)
* Remove passing vote date to constructor (let default value)

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/aur/models.py |    2 +-
 archlinux/aur/tests.py  |    4 ++--
 archlinux/aur/views.py  |    3 +--
 3 files changed, 4 insertions(+), 5 deletions(-)

diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
index 4c9bcb8..0f286cd 100644
--- a/archlinux/aur/models.py
+++ b/archlinux/aur/models.py
@@ -187,7 +187,7 @@ class PackageNotification(models.Model): class Vote(models.Model): user = models.ForeignKey(User)
     package = models.ForeignKey(Package)
-    when = models.DateTimeField(editable=False, default=datetime.now())
+    added = models.DateTimeField(editable=False, default=datetime.now())
 
     def __unicode__(self):
         return u"%s's vote for %s" % (self.user.username,
diff --git a/archlinux/aur/tests.py b/archlinux/aur/tests.py
index 3c5763e..9528a3b 100644
--- a/archlinux/aur/tests.py
+++ b/archlinux/aur/tests.py
@@ -68,7 +68,7 @@ class AurViewTests(AurTestCase):
     def test_unvote_view(self):
         package = Package.objects.get(name='unique_package')
         user = User.objects.get(username='normal_user')
-        Vote(package=package, user=user, when=datetime.now()).save()
+        Vote(package=package, user=user).save()
         self.client.login(username=user.username, password='normal_user')
         response = self.client.get(reverse('aur-unvote', kwargs={
             'object_id': package.name,
@@ -174,6 +174,6 @@ class AurTemplateTagTests(AurTestCase):
             {% endif %}
         """)
         self.assertEquals(template.render(context).strip(), "False")
-        Vote(package=package, user=user, when=datetime.now()).save()
+        Vote(package=package, user=user).save()
         self.assertEquals(template.render(context).strip(), "True")
 
diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
index 70b3b85..5f379a0 100644
--- a/archlinux/aur/views.py
+++ b/archlinux/aur/views.py
@@ -162,8 +162,7 @@ def vote(request, object_id):
     """Record a user's vote for a package"""
     package = get_object_or_404(Package, name=object_id)
     try:
-        Vote(package=package, user=request.user,
-                when=datetime.now()).save()
+        Vote(package=package, user=request.user).save()
     except IntegrityError: # Ignore the duplicate.  Voter fraud not allowed!
         pass # Should we complain?
     return HttpResponseRedirect(reverse('aur-package_detail',
-- 
1.6.5.2

This are some suggested changes over the proposed code. I've renamed "when" to "added" to keep consistence with the other models. For the same reason I haven't used auto_now_add, and kept the editable=False and default (I think this could be a global models.py change). I also removed the use of when in the constructor of Vote letting the default value do the job.

CCing Christopher for review again.

byebye!


From djszapi at archlinux.us  Fri Nov 27 18:23:53 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Fri, 27 Nov 2009 18:23:53 +0100
Subject: [aur2-dev] Test data
In-Reply-To: <d83f7a8d0911270823t530b8fc7q594d6ef7a2bff12f@mail.gmail.com>
References: <d83f7a8d0911270823t530b8fc7q594d6ef7a2bff12f@mail.gmail.com>
Message-ID: <a362e8010911270923y6b2c19cbl6c2f690bb1cbb1e0@mail.gmail.com>

On Fri, Nov 27, 2009 at 5:23 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Hi, I asked this before to Lazlo but didn't get any response. Does
> anyone have some "real" test data exported from the running AUR?

My name is Laszlo. Otherwise I told it more times not to contact with
me in private mail about AUR2 since this list was established. :) More
people can see your comment/post here, thanks.

I used these scripts:
http://projects.archlinux.org/aur.git/tree/support/schema

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Fri Nov 27 18:30:27 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Fri, 27 Nov 2009 18:30:27 +0100
Subject: [aur2-dev] [PATCH] Fix failing aur tests
In-Reply-To: <F9B1EAB6-CCE9-4BEE-A27B-5E5A81488EA4@gmail.com>
References: <1259331592-5974-1-git-send-email-icarnales@gmail.com>
	<4b0fe5f8.9553f10a.61b1.505e@mx.google.com>
	<d83f7a8d0911270648j46dd802crd6775c0638ae086d@mail.gmail.com>
	<F9B1EAB6-CCE9-4BEE-A27B-5E5A81488EA4@gmail.com>
Message-ID: <a362e8010911270930s45804d3ew14b3612de5a6f7bb@mail.gmail.com>

On Fri, Nov 27, 2009 at 4:36 PM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 27, 2009, at 10:19 PM, Ismael Carnales wrote:
>
>> * Added slug to the packages fixture
>>
>> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
>> ---
>> archlinux/aur/fixtures/test/packages.json | ? ?3 ++-
>> 1 files changed, 2 insertions(+), 1 deletions(-)
>>
>> diff --git a/archlinux/aur/fixtures/test/packages.json b/archlinux/
>> aur/fixtures/test/packages.json
>> index 081ebb6..07afe83 100644
>> --- a/archlinux/aur/fixtures/test/packages.json
>> +++ b/archlinux/aur/fixtures/test/packages.json
>> @@ -3,7 +3,8 @@
>> ? ? ? ? "pk": 1,
>> ? ? ? ? "model": "aur.package",
>> ? ? ? ? "fields": {
>> - ? ? ? ? ? ? ? ? ? ? "name": "unique_package",
>> + ? ? ? ? ? ?"name": "unique_package",
>> + ? ? ? ? ? ?"slug": "unique_package",
>> ? ? ? ? ? ? "tags": ["unique"],
>> ? ? ? ? ? ? "updated": "2009-01-01 00:00:00",
>> ? ? ? ? ? ? "added": "2009-01-01 00:00:00",
>> --
>> 1.6.5.2
>>
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>
> Thanks! Applied in my github repo. I need to figure out how to
> activate my berlios account to be able to push to that repo :/.

Ohh Sebastian, don't you have that account yet ? :)
I will apply it later, thanks.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Fri Nov 27 18:28:05 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Fri, 27 Nov 2009 18:28:05 +0100
Subject: [aur2-dev] [PATCH 1/2] Fix unvote view
In-Reply-To: <1259342183-12403-1-git-send-email-icarnales@gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<1259342183-12403-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911270928s31b81b9dia6acead39ffc916b@mail.gmail.com>

> I'm sending a patch that goes on top of Christopher patch for adding Voting.
> Don't know if this is the correct way to do this (sending changes of another
> person patches), if not, please tell me the correct way to do this :)
>
> I'm CCing Christopher directly so he can review my proposed changes.

We don't take the effort of other people, the best way is maybe to
recommend your ideas to him, as me and Sebastian and others did it
earlier :)

I'm not sure now what to do with Vote and Download Counter matter, any
opinion ? My opinion is here that both of them are not the most
correct implementation, but maybe Download counting can be manipulated
easier.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Fri Nov 27 18:35:23 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 15:35:23 -0200
Subject: [aur2-dev] Test data
In-Reply-To: <a362e8010911270923y6b2c19cbl6c2f690bb1cbb1e0@mail.gmail.com>
References: <d83f7a8d0911270823t530b8fc7q594d6ef7a2bff12f@mail.gmail.com> 
	<a362e8010911270923y6b2c19cbl6c2f690bb1cbb1e0@mail.gmail.com>
Message-ID: <d83f7a8d0911270935p29fdb594hf0e5e9cc77d147e4@mail.gmail.com>

Sorry for the name mismach!

And thanks for the script tip, I will use it to generate some data.

bye!

On Fri, Nov 27, 2009 at 3:23 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Fri, Nov 27, 2009 at 5:23 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> Hi, I asked this before to Lazlo but didn't get any response. Does
>> anyone have some "real" test data exported from the running AUR?
>
> My name is Laszlo. Otherwise I told it more times not to contact with
> me in private mail about AUR2 since this list was established. :) More
> people can see your comment/post here, thanks.
>
> I used these scripts:
> http://projects.archlinux.org/aur.git/tree/support/schema
>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From icarnales at gmail.com  Fri Nov 27 18:39:01 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 15:39:01 -0200
Subject: [aur2-dev] [PATCH 1/2] Fix unvote view
In-Reply-To: <a362e8010911270928s31b81b9dia6acead39ffc916b@mail.gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<1259342183-12403-1-git-send-email-icarnales@gmail.com> 
	<a362e8010911270928s31b81b9dia6acead39ffc916b@mail.gmail.com>
Message-ID: <d83f7a8d0911270939w4110b7c0u9e0360498bc6430e@mail.gmail.com>

On Fri, Nov 27, 2009 at 3:28 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
>> I'm sending a patch that goes on top of Christopher patch for adding Voting.
>> Don't know if this is the correct way to do this (sending changes of another
>> person patches), if not, please tell me the correct way to do this :)
>>
>> I'm CCing Christopher directly so he can review my proposed changes.
>
> We don't take the effort of other people, the best way is maybe to
> recommend your ideas to him, as me and Sebastian and others did it
> earlier :)

That's why I sent the patch directly to him too, and that's why I
coded over unapplied patches to help him with his effort. In no way I
was "taking" anything.


From icarnales at gmail.com  Fri Nov 27 18:41:28 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 15:41:28 -0200
Subject: [aur2-dev] Extrange error when uploading some packages
In-Reply-To: <4b100b9a.8802be0a.68ee.5702@mx.google.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com> 
	<B324F08E-CA2C-4BBB-9E1A-2C4EEEBF535D@gmail.com>
	<4b100b9a.8802be0a.68ee.5702@mx.google.com>
Message-ID: <d83f7a8d0911270941p2a1589dcka9af643f402c2493@mail.gmail.com>

Ehm .. I think it was my mistake this time Chris, I was uploading
directly the PKGBUILDS (wich worked perfectly for some packages, I'm
attaching an exmple). Using a makepkg --source over the PKGBUILDS that
failed fixed the issue.

Thanks, bye!

On Fri, Nov 27, 2009 at 3:26 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
>> I have a feeling this might be related to the lack of EOF in
>> parsepkgbuild.sh, that Christopher Brannon fixed in [PATCH 1/2] Misc
>> syntax fixes.
>
> It works here. ?Your uploading a tarball containing a directory named
> virtualenv-commands, having a PKGBUILD, right?
> I did get these exceptions earlier, when I misnamed the directory.
> I somehow managed to call it virtualenv, and in that case, I got the
> same results that you did.
>
> In any case, it is behaving badly when the package name disagrees with
> the name of the tree in the tarball.
>
> -- Chris
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From icarnales at gmail.com  Fri Nov 27 18:42:13 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 15:42:13 -0200
Subject: [aur2-dev] Extrange error when uploading some packages
In-Reply-To: <d83f7a8d0911270941p2a1589dcka9af643f402c2493@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com> 
	<B324F08E-CA2C-4BBB-9E1A-2C4EEEBF535D@gmail.com>
	<4b100b9a.8802be0a.68ee.5702@mx.google.com> 
	<d83f7a8d0911270941p2a1589dcka9af643f402c2493@mail.gmail.com>
Message-ID: <d83f7a8d0911270942j7911edf5o6b333a2baa1680d2@mail.gmail.com>

Forgot to add the attach xD, sorry for the spamming.

On Fri, Nov 27, 2009 at 3:41 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Ehm .. I think it was my mistake this time Chris, I was uploading
> directly the PKGBUILDS (wich worked perfectly for some packages, I'm
> attaching an exmple). Using a makepkg --source over the PKGBUILDS that
> failed fixed the issue.
>
> Thanks, bye!
>
> On Fri, Nov 27, 2009 at 3:26 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
>>> I have a feeling this might be related to the lack of EOF in
>>> parsepkgbuild.sh, that Christopher Brannon fixed in [PATCH 1/2] Misc
>>> syntax fixes.
>>
>> It works here. ?Your uploading a tarball containing a directory named
>> virtualenv-commands, having a PKGBUILD, right?
>> I did get these exceptions earlier, when I misnamed the directory.
>> I somehow managed to call it virtualenv, and in that case, I got the
>> same results that you did.
>>
>> In any case, it is behaving badly when the package name disagrees with
>> the name of the tree in the tarball.
>>
>> -- Chris
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PKGBUILD
Type: application/octet-stream
Size: 1265 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/aur2-dev/attachments/20091127/a7b2b05d/attachment.obj>

From icarnales at gmail.com  Fri Nov 27 18:54:38 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 15:54:38 -0200
Subject: [aur2-dev] Extrange error when uploading some packages
In-Reply-To: <d83f7a8d0911270941p2a1589dcka9af643f402c2493@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com> 
	<B324F08E-CA2C-4BBB-9E1A-2C4EEEBF535D@gmail.com>
	<4b100b9a.8802be0a.68ee.5702@mx.google.com> 
	<d83f7a8d0911270941p2a1589dcka9af643f402c2493@mail.gmail.com>
Message-ID: <d83f7a8d0911270954v61827680w17d22aedc78ae191@mail.gmail.com>

Investigating the mather further, I've seen that PKGBUILD without tar
file is supported.

Following Sebnow's directions, I've found that the error (now in its
true form http://dpaste.com/125950/) doesn't show when parsing CVS,
SVN, GIT PKGBUILDS because they don't have a sources field.

I'll try to fix it and send a patch, bye!

On Fri, Nov 27, 2009 at 3:41 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Ehm .. I think it was my mistake this time Chris, I was uploading
> directly the PKGBUILDS (wich worked perfectly for some packages, I'm
> attaching an exmple). Using a makepkg --source over the PKGBUILDS that
> failed fixed the issue.
>
> Thanks, bye!
>
> On Fri, Nov 27, 2009 at 3:26 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
>>> I have a feeling this might be related to the lack of EOF in
>>> parsepkgbuild.sh, that Christopher Brannon fixed in [PATCH 1/2] Misc
>>> syntax fixes.
>>
>> It works here. ?Your uploading a tarball containing a directory named
>> virtualenv-commands, having a PKGBUILD, right?
>> I did get these exceptions earlier, when I misnamed the directory.
>> I somehow managed to call it virtualenv, and in that case, I got the
>> same results that you did.
>>
>> In any case, it is behaving badly when the package name disagrees with
>> the name of the tree in the tarball.
>>
>> -- Chris
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>


From cmbrannon79 at gmail.com  Fri Nov 27 19:13:20 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Fri, 27 Nov 2009 12:13:20 -0600
Subject: [aur2-dev] [PATCH 1/2] Fix unvote view
In-Reply-To: <d83f7a8d0911270939w4110b7c0u9e0360498bc6430e@mail.gmail.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<1259342183-12403-1-git-send-email-icarnales@gmail.com>
	<a362e8010911270928s31b81b9dia6acead39ffc916b@mail.gmail.com>
	<d83f7a8d0911270939w4110b7c0u9e0360498bc6430e@mail.gmail.com>
Message-ID: <4b10167c.1708c00a.2643.37e7@mx.google.com>

Ismael Carnales wrote:
> That's why I sent the patch directly to him too, and that's why I
> coded over unapplied patches to help him with his effort. In no way I
> was "taking" anything.

Right.  You're cool!

Your patches look good, especially #1.  My original unvote code was
violating one of the test cases: unvoting a non-existent package should
give a 404 response, not a redirect.

With the change in patch #2, are you wanting to eventually make a base
class with one field named "added"?  That's what it looks like to me.

As for the default=datetime.now() in the definition of Vote, it is only
evaluated once, at server startup.
So unless there's some other logic to set the timestamp, such
as auto_now_add or a save() method, all votes made during a given run of
the application will have the same timestamp.

-- Chris


From icarnales at gmail.com  Fri Nov 27 19:11:06 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 16:11:06 -0200
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
Message-ID: <1259345466-14111-1-git-send-email-icarnales@gmail.com>

This fixes the uploading of single PKGBUILD files that contain a source
field.
---
 archlinux/aur/forms.py |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
index a50f767..1d626a1 100644
--- a/archlinux/aur/forms.py
+++ b/archlinux/aur/forms.py
@@ -141,6 +141,7 @@ class PackageSubmitForm(forms.Form):
         import tarfile
         pkg = self.cleaned_data['package']
         tmpdir = os.path.dirname(pkg['filename'])
+        tmpdir_sources = os.path.join(tmpdir, 'sources')
         updating = False
         creating = False
         try:
@@ -194,7 +195,6 @@ class PackageSubmitForm(forms.Form):
             pkgbuild = pkg['filename']
         else:
             is_tarfile = True
-            tmpdir_sources = os.path.join(tmpdir, 'sources')
             tar.extractall(tmpdir_sources)
             pkgbuild = os.path.join(tmpdir_sources, pkg['name'], 'PKGBUILD')
         # Remove all sources. It's easier and cleaner this way.
-- 
1.6.5.2



From icarnales at gmail.com  Fri Nov 27 19:39:25 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 16:39:25 -0200
Subject: [aur2-dev] [PATCH 1/2] Fix unvote view
In-Reply-To: <4b10167c.1708c00a.2643.37e7@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<1259342183-12403-1-git-send-email-icarnales@gmail.com> 
	<a362e8010911270928s31b81b9dia6acead39ffc916b@mail.gmail.com> 
	<d83f7a8d0911270939w4110b7c0u9e0360498bc6430e@mail.gmail.com> 
	<4b10167c.1708c00a.2643.37e7@mx.google.com>
Message-ID: <d83f7a8d0911271039y5fb3a9fby5d61c97531b6b2de@mail.gmail.com>

On Fri, Nov 27, 2009 at 4:13 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
> Ismael Carnales wrote:
>> That's why I sent the patch directly to him too, and that's why I
>> coded over unapplied patches to help him with his effort. In no way I
>> was "taking" anything.
>
> Right. ?You're cool!
>
> Your patches look good, especially #1. ?My original unvote code was
> violating one of the test cases: unvoting a non-existent package should
> give a 404 response, not a redirect.
>

Yup, I corrected it following the expected behaviour for the test +1
for your tests! :)

> With the change in patch #2, are you wanting to eventually make a base
> class with one field named "added"? ?That's what it looks like to me.
>

You are correct here, I was only following the previous code and
suggesting from "when" to "added" field to be consistent with the
Package and Comment model, in the future that can be factored out to a
base class.

> As for the default=datetime.now() in the definition of Vote, it is only
> evaluated once, at server startup.
> So unless there's some other logic to set the timestamp, such
> as auto_now_add or a save() method, all votes made during a given run of
> the application will have the same timestamp.
>

You're ab-so-lu-te-ly right about this, I was blind following the
previous code, not seeing that it was wrong, I'm sending a patch to
use auto_now_add and auto_now in the other models, I suggest using
them in Vote too.

byebye!

> -- Chris
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From icarnales at gmail.com  Fri Nov 27 19:35:22 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 16:35:22 -0200
Subject: [aur2-dev] [PATCH] Fix added date on Package and Comment models
Message-ID: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>

From: Ismael Carnales <icarnales at gmail.com>

The added datetime for Packages and Comments was getting set in the
default value (always the datetime from server start), now using
auto_now_create and auto_now for updated

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/aur/models.py |    7 +++----
 1 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
index 6bc7a85..abdc5ef 100644
--- a/archlinux/aur/models.py
+++ b/archlinux/aur/models.py
@@ -94,8 +94,8 @@ class Package(models.Model):
     provides = models.ManyToManyField(Provision, null=True, blank=True)
     deleted = models.BooleanField(default=False)
     outdated = models.BooleanField(default=False)
-    added = models.DateTimeField(editable=False, default=datetime.now())
-    updated = models.DateTimeField()
+    added = models.DateTimeField(auto_now_add=True)
+    updated = models.DateTimeField(auto_now=True)
     groups = models.ManyToManyField(Group, null=True, blank=True)
 
     def __unicode__(self):
@@ -114,7 +114,6 @@ class Package(models.Model):
     get_absolute_url = permalink(get_absolute_url)
 
     def save(self):
-        self.updated = datetime.now()
         if not self.slug:
             import re
             slug = re.sub('[^\w\s-]', '', self.name).strip().lower()
@@ -166,7 +165,7 @@ class Comment(models.Model):
     parent = models.ForeignKey('self', null=True, blank=True)
     user = models.ForeignKey(User)
     message = models.TextField()
-    added = models.DateTimeField(editable=False, default=datetime.now())
+    added = models.DateTimeField(auto_now_add=True)
     ip = models.IPAddressField()
     hidden = models.BooleanField(default=False)
 
-- 
1.6.5.2



From djszapi at archlinux.us  Fri Nov 27 21:16:54 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Fri, 27 Nov 2009 21:16:54 +0100
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <1259345466-14111-1-git-send-email-icarnales@gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
	<1259345466-14111-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com>

On Fri, Nov 27, 2009 at 7:11 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> This fixes the uploading of single PKGBUILD files that contain a source
> field.
> ---
> ?archlinux/aur/forms.py | ? ?2 +-
> ?1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
> index a50f767..1d626a1 100644
> --- a/archlinux/aur/forms.py
> +++ b/archlinux/aur/forms.py
> @@ -141,6 +141,7 @@ class PackageSubmitForm(forms.Form):
> ? ? ? ? import tarfile
> ? ? ? ? pkg = self.cleaned_data['package']
> ? ? ? ? tmpdir = os.path.dirname(pkg['filename'])
> + ? ? ? ?tmpdir_sources = os.path.join(tmpdir, 'sources')
> ? ? ? ? updating = False
> ? ? ? ? creating = False
> ? ? ? ? try:
> @@ -194,7 +195,6 @@ class PackageSubmitForm(forms.Form):
> ? ? ? ? ? ? pkgbuild = pkg['filename']
> ? ? ? ? else:
> ? ? ? ? ? ? is_tarfile = True
> - ? ? ? ? ? ?tmpdir_sources = os.path.join(tmpdir, 'sources')
> ? ? ? ? ? ? tar.extractall(tmpdir_sources)
> ? ? ? ? ? ? pkgbuild = os.path.join(tmpdir_sources, pkg['name'], 'PKGBUILD')
> ? ? ? ? # Remove all sources. It's easier and cleaner this way.
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

I like this patch from Louipc:
http://projects.archlinux.org/aur.git/commit/?id=de7c9ab787baf7c12e44c17d75b3b6cfe1c2bd97
This feature should be removed, maybe.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Fri Nov 27 21:45:16 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 18:45:16 -0200
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com> 
	<1259345466-14111-1-git-send-email-icarnales@gmail.com>
	<a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com>
Message-ID: <d83f7a8d0911271245w76a50f0fn61248fad63977e5f@mail.gmail.com>

So we are removing single PKGBUILD support?

bye!

On Fri, Nov 27, 2009 at 6:16 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Fri, Nov 27, 2009 at 7:11 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> This fixes the uploading of single PKGBUILD files that contain a source
>> field.
>> ---
>> ?archlinux/aur/forms.py | ? ?2 +-
>> ?1 files changed, 1 insertions(+), 1 deletions(-)
>>
>> diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
>> index a50f767..1d626a1 100644
>> --- a/archlinux/aur/forms.py
>> +++ b/archlinux/aur/forms.py
>> @@ -141,6 +141,7 @@ class PackageSubmitForm(forms.Form):
>> ? ? ? ? import tarfile
>> ? ? ? ? pkg = self.cleaned_data['package']
>> ? ? ? ? tmpdir = os.path.dirname(pkg['filename'])
>> + ? ? ? ?tmpdir_sources = os.path.join(tmpdir, 'sources')
>> ? ? ? ? updating = False
>> ? ? ? ? creating = False
>> ? ? ? ? try:
>> @@ -194,7 +195,6 @@ class PackageSubmitForm(forms.Form):
>> ? ? ? ? ? ? pkgbuild = pkg['filename']
>> ? ? ? ? else:
>> ? ? ? ? ? ? is_tarfile = True
>> - ? ? ? ? ? ?tmpdir_sources = os.path.join(tmpdir, 'sources')
>> ? ? ? ? ? ? tar.extractall(tmpdir_sources)
>> ? ? ? ? ? ? pkgbuild = os.path.join(tmpdir_sources, pkg['name'], 'PKGBUILD')
>> ? ? ? ? # Remove all sources. It's easier and cleaner this way.
>> --
>> 1.6.5.2
>>
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>
> I like this patch from Louipc:
> http://projects.archlinux.org/aur.git/commit/?id=de7c9ab787baf7c12e44c17d75b3b6cfe1c2bd97
> This feature should be removed, maybe.
>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From djszapi at archlinux.us  Fri Nov 27 21:47:56 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Fri, 27 Nov 2009 21:47:56 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
Message-ID: <200911272047.nARKluqi026399@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  61008e056097dcd6542880ad6ffd1a9cbd9ee6e7 (commit)
       via  1741b3d31b0745b40f601c6507567c7eb4c4edfa (commit)
      from  0a09d0f69975c8a387d46b2ac8b5c619c2d3b5f9 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
Author: Ismael Carnales <icarnales at gmail.com>
Date:   Fri Nov 27 12:19:52 2009 -0200

    Fix failing aur tests
    
    * Added slug to the packages fixture
    
    Signed-off-by: Ismael Carnales <icarnales at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 1741b3d31b0745b40f601c6507567c7eb4c4edfa
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Thu Nov 26 23:37:13 2009 +0100

    Change 'password (again)' for 'Confirm password
    
    Change the silly 'password (again)' for 'Confirm password', because it describes
    better its purpose, and this is the one of the used, standard message here.
    
    New Subclass was established (AurRegistrationForm), because the original string
    was established in the django-registration module, and it's no worth to modify it.
    The password2 label of the mentionod class was refactored
    
    The desited link should have established in the main urls.py according to the
    accouns/register page and AurRegistrationForm subclass, so involving  it before
    the original registration.views.register including.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 archlinux/aur/fixtures/test/packages.json |    3 ++-
 archlinux/aur/forms.py                    |    9 +++++++++
 archlinux/urls.py                         |    3 +++
 3 files changed, 14 insertions(+), 1 deletions(-)


hooks/post-receive
-- 
Project aur2 at BerliOS


From icarnales at gmail.com  Fri Nov 27 23:41:48 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 20:41:48 -0200
Subject: [aur2-dev] "Offtopic": development workflow
Message-ID: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com>

Sorry for the slightly "offtopic" posting, but anyone can spare some
time and tell me or point me to some resource about why is better
using the send-paths workflow than the pull-from-here workflow? I
mean, everytime I send a patch and it gets applied upstream then I get
it back in my repo with other id (as it was applied and commited, not
fetched and merged).

What's the correct strategy for me a a non-commiter contributor to
have my "development" repo published for other non-commiters to pull
on? If I'm constantly rebasing it again upstream it doesn't work as a
remote for any other person.

I hope someone finds the time to talk about this issue. Thanks, bye!

P.S: I'm new to git, maybe I'm missing something crucial ...


From djszapi at archlinux.us  Fri Nov 27 23:57:08 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Fri, 27 Nov 2009 23:57:08 +0100
Subject: [aur2-dev] "Offtopic": development workflow
In-Reply-To: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com>
References: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com>
Message-ID: <a362e8010911271457w786eb30dq94f6d42e90f9d28a@mail.gmail.com>

On Fri, Nov 27, 2009 at 11:41 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Sorry for the slightly "offtopic" posting, but anyone can spare some
> time and tell me or point me to some resource about why is better
> using the send-paths workflow than the pull-from-here workflow? I
> mean, everytime I send a patch and it gets applied upstream then I get
> it back in my repo with other id (as it was applied and commited, not
> fetched and merged).
>
> What's the correct strategy for me a a non-commiter contributor to
> have my "development" repo published for other non-commiters to pull
> on? If I'm constantly rebasing it again upstream it doesn't work as a
> remote for any other person.
>
> I hope someone finds the time to talk about this issue. Thanks, bye!
>
> P.S: I'm new to git, maybe I'm missing something crucial ...
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

You can set up your repository and say it to me after  your patch was
agreed, but I think it's a good way to send it to the developer
mailing list as inline text with git-send-email, because it's easy to
review them for others to quote your patches, so if your patch was
agreed, you can say 'You applied in your branch' and point the desired
URL/Repository, and I will pull them before pushing, after your
pulling request e.g.

Other developers do so too, just see the pacman project, or git
project, or other projects on the http://repo.or.cz/ site or on other
git hosting sites.

But otherwise in those projects where I contributed, I've never had my
own repository, and it's not problem for me to handle in local these
changes/rebasings/pullings/pushings, but you can do that direction,
anyway, no problem for me.

You can find it here some related hosting services:
http://git.or.cz/gitwiki/GitHosting

Best Regards,
Laszlo Papp


From cmbrannon79 at gmail.com  Sat Nov 28 00:01:15 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Fri, 27 Nov 2009 17:01:15 -0600
Subject: [aur2-dev] "Offtopic": development workflow
In-Reply-To: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com>
References: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com>
Message-ID: <4b1059f6.9753f10a.349f.68f3@mx.google.com>

Ismael Carnales wrote:
> What's the correct strategy for me a a non-commiter contributor to
> have my "development" repo published for other non-commiters to pull
> on? If I'm constantly rebasing it again upstream it doesn't work as a
> remote for any other person.
> 
> P.S: I'm new to git, maybe I'm missing something crucial ...

Ismael,
My master branch is always in sync with the master branch of the main
repo.  I never commit to it directly.  Instead, I keep a branch named
cmbwork, to which I commit.  I merge the master branch into cmbwork as
changes are applied upstream.
I don't know whether this is the correct strategy for you, but it works
well for me.

-- Chris


From djszapi at archlinux.us  Sat Nov 28 00:12:51 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 00:12:51 +0100
Subject: [aur2-dev] "Offtopic": development workflow
In-Reply-To: <4b1059f6.9753f10a.349f.68f3@mx.google.com>
References: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com>
	<4b1059f6.9753f10a.349f.68f3@mx.google.com>
Message-ID: <a362e8010911271512r58a203b6j60ba4d098257456c@mail.gmail.com>

On Sat, Nov 28, 2009 at 12:01 AM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
> Ismael Carnales wrote:
>> What's the correct strategy for me a a non-commiter contributor to
>> have my "development" repo published for other non-commiters to pull
>> on? If I'm constantly rebasing it again upstream it doesn't work as a
>> remote for any other person.
>>
>> P.S: I'm new to git, maybe I'm missing something crucial ...
>
> Ismael,
> My master branch is always in sync with the master branch of the main
> repo. ?I never commit to it directly. ?Instead, I keep a branch named
> cmbwork, to which I commit. ?I merge the master branch into cmbwork as
> changes are applied upstream.
> I don't know whether this is the correct strategy for you, but it works
> well for me.
>
> -- Chris

I think it's correct, Chris.

Like in pacman, git related wikipage,  you can do a 'working' branch
or with name you like (maybe I told it to you earlier)
http://wiki.archlinux.org/index.php/Super_Quick_Git_Guide

Maybe I'm wrong, but I followed these rules in my contributions. Maybe
because of that thing, I didn't produce the best patches all the time,
and my patches were needed to review.

If I remember well, in case of pacman project, only the core
developers have got their own repositories, but you can create a one,
not a big deal or problem for me :)

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 28 00:28:30 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 21:28:30 -0200
Subject: [aur2-dev] "Offtopic": development workflow
In-Reply-To: <a362e8010911271457w786eb30dq94f6d42e90f9d28a@mail.gmail.com>
References: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com> 
	<a362e8010911271457w786eb30dq94f6d42e90f9d28a@mail.gmail.com>
Message-ID: <d83f7a8d0911271528gf87d34dl25489b226f1b999d@mail.gmail.com>

Thanks for your reply.

On Fri, Nov 27, 2009 at 8:57 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Fri, Nov 27, 2009 at 11:41 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> Sorry for the slightly "offtopic" posting, but anyone can spare some
>> time and tell me or point me to some resource about why is better
>> using the send-paths workflow than the pull-from-here workflow? I
>> mean, everytime I send a patch and it gets applied upstream then I get
>> it back in my repo with other id (as it was applied and commited, not
>> fetched and merged).
>>
>> What's the correct strategy for me a a non-commiter contributor to
>> have my "development" repo published for other non-commiters to pull
>> on? If I'm constantly rebasing it again upstream it doesn't work as a
>> remote for any other person.
>>
>> I hope someone finds the time to talk about this issue. Thanks, bye!
>>
>> P.S: I'm new to git, maybe I'm missing something crucial ...
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>
> You can set up your repository and say it to me after ?your patch was
> agreed, but I think it's a good way to send it to the developer
> mailing list as inline text with git-send-email, because it's easy to
> review them for others to quote your patches, so if your patch was
> agreed, you can say 'You applied in your branch' and point the desired
> URL/Repository, and I will pull them before pushing, after your
> pulling request e.g.

This is the way I'm used to contributing to scrapy (managed with hg),
I work in a patch queue, on top of a clone of the mine repo, when I'm
finished I send the patch for reviewing and if it's ok I apply it into
my clone and then the commiters pull from mine and push to the "main"
repo.

I'll try to send the patchs by email and pull requests, (I just
discovered git request-pull wich outputs a nice log of changes) this
way history is preserved and I get the same changesets when the
patches are applied upstream.

>
> Other developers do so too, just see the pacman project, or git
> project, or other projects on the http://repo.or.cz/ site or on other
> git hosting sites.
>
> But otherwise in those projects where I contributed, I've never had my
> own repository, and it's not problem for me to handle in local these
> changes/rebasings/pullings/pushings, but you can do that direction,
> anyway, no problem for me.
>
> You can find it here some related hosting services:
> http://git.or.cz/gitwiki/GitHosting

Thanks, I already have a fork on github, http://github.com/void/aur2
with the master branch following upstream and a new voting branch with
the patch from Chris and some patches of mine on top, so I can follow
that work in parallel.

>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From icarnales at gmail.com  Sat Nov 28 00:33:04 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Fri, 27 Nov 2009 21:33:04 -0200
Subject: [aur2-dev] "Offtopic": development workflow
In-Reply-To: <4b1059f6.9753f10a.349f.68f3@mx.google.com>
References: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com> 
	<4b1059f6.9753f10a.349f.68f3@mx.google.com>
Message-ID: <d83f7a8d0911271533w118a6612t896ff31a5a23a6ed@mail.gmail.com>

Thank you for your response :)

On Fri, Nov 27, 2009 at 9:01 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
> Ismael Carnales wrote:
>> What's the correct strategy for me a a non-commiter contributor to
>> have my "development" repo published for other non-commiters to pull
>> on? If I'm constantly rebasing it again upstream it doesn't work as a
>> remote for any other person.
>>
>> P.S: I'm new to git, maybe I'm missing something crucial ...
>
> Ismael,
> My master branch is always in sync with the master branch of the main
> repo. ?I never commit to it directly. ?Instead, I keep a branch named
> cmbwork, to which I commit. ?I merge the master branch into cmbwork as
> changes are applied upstream.
> I don't know whether this is the correct strategy for you, but it works
> well for me.

This is what I'm doing, locally I keep master synced with upstream,
and do topic branches for all my work, then I send the patches with
the differences from master (upstream).

But the problem is that in the meantime I have no place with all my
"new work" to test some new things, I think the best thing to do will
be having another merge branch (like your cmbwork) where I merge my
topic branches and push it to github so other people can see/use my
work when it's not in upstream yet.

Another thing I'm finding not so easy is keeping the topic branches
synced somewhere so I can keep developing in two machines, maybe I
will have to push them to github too :)

>
> -- Chris
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From sebnow at gmail.com  Sat Nov 28 05:19:45 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sat, 28 Nov 2009 12:19:45 +0800
Subject: [aur2-dev] [PATCH] Fix failing aur tests
In-Reply-To: <a362e8010911270930s45804d3ew14b3612de5a6f7bb@mail.gmail.com>
References: <1259331592-5974-1-git-send-email-icarnales@gmail.com>
	<4b0fe5f8.9553f10a.61b1.505e@mx.google.com>
	<d83f7a8d0911270648j46dd802crd6775c0638ae086d@mail.gmail.com>
	<F9B1EAB6-CCE9-4BEE-A27B-5E5A81488EA4@gmail.com>
	<a362e8010911270930s45804d3ew14b3612de5a6f7bb@mail.gmail.com>
Message-ID: <E5418DE2-DB4F-454B-A0EC-9F4A61D9DDFF@gmail.com>


On Nov 28, 2009, at 1:30 AM, Laszlo Papp wrote:

> On Fri, Nov 27, 2009 at 4:36 PM, Sebastian Nowicki  
> <sebnow at gmail.com> wrote:
>>
>> On Nov 27, 2009, at 10:19 PM, Ismael Carnales wrote:
>>
>>> * Added slug to the packages fixture
>>>
>>> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
>>> ---
>>> archlinux/aur/fixtures/test/packages.json |    3 ++-
>>> 1 files changed, 2 insertions(+), 1 deletions(-)
>>>
>>> diff --git a/archlinux/aur/fixtures/test/packages.json b/archlinux/
>>> aur/fixtures/test/packages.json
>>> index 081ebb6..07afe83 100644
>>> --- a/archlinux/aur/fixtures/test/packages.json
>>> +++ b/archlinux/aur/fixtures/test/packages.json
>>> @@ -3,7 +3,8 @@
>>>         "pk": 1,
>>>         "model": "aur.package",
>>>         "fields": {
>>> -                     "name": "unique_package",
>>> +            "name": "unique_package",
>>> +            "slug": "unique_package",
>>>             "tags": ["unique"],
>>>             "updated": "2009-01-01 00:00:00",
>>>             "added": "2009-01-01 00:00:00",
>>> --
>>> 1.6.5.2
>>>
>>> _______________________________________________
>>> aur2-dev mailing list
>>> aur2-dev at lists.berlios.de
>>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>> Thanks! Applied in my github repo. I need to figure out how to
>> activate my berlios account to be able to push to that repo :/.
>
> Ohh Sebastian, don't you have that account yet ? :)
> I will apply it later, thanks.
>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev

I was able to get the admins to activate it, but I still didn't have  
access to the git repository. I'll try again soon.


From sebnow at gmail.com  Sat Nov 28 05:52:07 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sat, 28 Nov 2009 12:52:07 +0800
Subject: [aur2-dev] "Offtopic": development workflow
In-Reply-To: <d83f7a8d0911271533w118a6612t896ff31a5a23a6ed@mail.gmail.com>
References: <d83f7a8d0911271441r116ac4bn53d46f6752fe160f@mail.gmail.com>
	<4b1059f6.9753f10a.349f.68f3@mx.google.com>
	<d83f7a8d0911271533w118a6612t896ff31a5a23a6ed@mail.gmail.com>
Message-ID: <C2105D26-89EE-4EA8-AA3C-B8B7AA40F2E3@gmail.com>


On Nov 28, 2009, at 7:33 AM, Ismael Carnales wrote:

> Thank you for your response :)
>
> On Fri, Nov 27, 2009 at 9:01 PM, Chris Brannon  
> <cmbrannon79 at gmail.com> wrote:
>> Ismael Carnales wrote:
>>> What's the correct strategy for me a a non-commiter contributor to
>>> have my "development" repo published for other non-commiters to pull
>>> on? If I'm constantly rebasing it again upstream it doesn't work  
>>> as a
>>> remote for any other person.
>>>
>>> P.S: I'm new to git, maybe I'm missing something crucial ...
>>
>> Ismael,
>> My master branch is always in sync with the master branch of the main
>> repo.  I never commit to it directly.  Instead, I keep a branch named
>> cmbwork, to which I commit.  I merge the master branch into cmbwork  
>> as
>> changes are applied upstream.
>> I don't know whether this is the correct strategy for you, but it  
>> works
>> well for me.
>
> This is what I'm doing, locally I keep master synced with upstream,
> and do topic branches for all my work, then I send the patches with
> the differences from master (upstream).
>
> But the problem is that in the meantime I have no place with all my
> "new work" to test some new things, I think the best thing to do will
> be having another merge branch (like your cmbwork) where I merge my
> topic branches and push it to github so other people can see/use my
> work when it's not in upstream yet.
>
> Another thing I'm finding not so easy is keeping the topic branches
> synced somewhere so I can keep developing in two machines, maybe I
> will have to push them to github too :)

The strategies I'm familiar with have pretty much been discussed  
already. If you use topic branches, once the commits are merged into  
the upstream master branch, you could simply delete the topic branch  
and pull changes from upstream into master.

I don't think having a "working" branch is strictly necessary. It  
should be possible to use the master branch as your "working" branch,  
and just `git rebase -i upstream/master` when new commits come in.  
This should put your changes on top of the upstream changes. Of course  
attention should be payed as to which commits are getting rebased.

As for send-mail vs pull request, I don't mind either way. Sending  
patch mails is good for review purposes, as Laszlo pointed out, but  
pull requests are actually easier for developers. Some information is  
lost in patches, such as which commit the patch is based on. Using  
github makes the process even easier, since there's a "pull request"  
feature, and a "fork" tab, allowing to integrate through a web  
interface.

Please do send patches to the list so that they can be peer-reviewed.  
If you wish to send a pull-request you can do that also.



From sebnow at gmail.com  Sat Nov 28 06:09:01 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sat, 28 Nov 2009 13:09:01 +0800
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <200911272047.nARKluqi026399@sheep.berlios.de>
References: <200911272047.nARKluqi026399@sheep.berlios.de>
Message-ID: <CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>


On Nov 28, 2009, at 4:47 AM, djszapi at archlinux.us wrote:
> commit 1741b3d31b0745b40f601c6507567c7eb4c4edfa
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date:   Thu Nov 26 23:37:13 2009 +0100
>
>    Change 'password (again)' for 'Confirm password
>
>    Change the silly 'password (again)' for 'Confirm password',  
> because it describes
>    better its purpose, and this is the one of the used, standard  
> message here.
>
>    New Subclass was established (AurRegistrationForm), because the  
> original string
>    was established in the django-registration module, and it's no  
> worth to modify it.
>    The password2 label of the mentionod class was refactored
>
>    The desited link should have established in the main urls.py  
> according to the
>    accouns/register page and AurRegistrationForm subclass, so  
> involving  it before
>    the original registration.views.register including.
>
>    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

The AurRegistrationForm should be put in aurprofile, not in the aur  
app, as it has nothing to do with packages. "attrs_dict" should  
probably not be global, and in fact it could just be specified inline.  
Is it worth "hacking" this here? Maybe the upstream author would like  
this patch in django-registration. It'd be as simple as changing one  
line (upstream) then.



From sebnow at gmail.com  Sat Nov 28 06:01:45 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sat, 28 Nov 2009 13:01:45 +0800
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <d83f7a8d0911271245w76a50f0fn61248fad63977e5f@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
	<1259345466-14111-1-git-send-email-icarnales@gmail.com>
	<a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com>
	<d83f7a8d0911271245w76a50f0fn61248fad63977e5f@mail.gmail.com>
Message-ID: <A816C2BD-CA24-42C0-9069-0F053528A01C@gmail.com>


On Nov 28, 2009, at 4:45 AM, Ismael Carnales wrote:

> So we are removing single PKGBUILD support?
>
> bye!

Perhaps it's not a bad idea. Keeping consistent with the current AUR  
is a good idea. People at the moment are used to uploading PKGBUILDs  
(rather than tarballs) and complain. However, in some time (definitely  
before AUR2 gets released) people will be used to uploading tarballs,  
so allowing PKGBUILD uploads would be confusing again.

On the other hand it's not much code to support this feature.



From djszapi at archlinux.us  Sat Nov 28 06:13:43 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 06:13:43 +0100
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <A816C2BD-CA24-42C0-9069-0F053528A01C@gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
	<1259345466-14111-1-git-send-email-icarnales@gmail.com>
	<a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com>
	<d83f7a8d0911271245w76a50f0fn61248fad63977e5f@mail.gmail.com>
	<A816C2BD-CA24-42C0-9069-0F053528A01C@gmail.com>
Message-ID: <a362e8010911272113m227a08bet96270fcaeb450c68@mail.gmail.com>

On Sat, Nov 28, 2009 at 6:01 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 28, 2009, at 4:45 AM, Ismael Carnales wrote:
>
>> So we are removing single PKGBUILD support?
>>
>> bye!

Yeah, I'd like to implement it, I will apply it soon. The simplicity,
unity is my purpose here too.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Sat Nov 28 06:23:03 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 06:23:03 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de>
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
Message-ID: <a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com>

On Sat, Nov 28, 2009 at 6:09 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 28, 2009, at 4:47 AM, djszapi at archlinux.us wrote:
>> commit 1741b3d31b0745b40f601c6507567c7eb4c4edfa
>> Author: Laszlo Papp <djszapi at archlinux.us>
>> Date: ? Thu Nov 26 23:37:13 2009 +0100
>>
>> ? ?Change 'password (again)' for 'Confirm password
>>
>> ? ?Change the silly 'password (again)' for 'Confirm password',
>> because it describes
>> ? ?better its purpose, and this is the one of the used, standard
>> message here.
>>
>> ? ?New Subclass was established (AurRegistrationForm), because the
>> original string
>> ? ?was established in the django-registration module, and it's no
>> worth to modify it.
>> ? ?The password2 label of the mentionod class was refactored
>>
>> ? ?The desited link should have established in the main urls.py
>> according to the
>> ? ?accouns/register page and AurRegistrationForm subclass, so
>> involving ?it before
>> ? ?the original registration.views.register including.
>>
>> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>
> The AurRegistrationForm should be put in aurprofile, not in the aur
> app, as it has nothing to do with packages. "attrs_dict" should
> probably not be global, and in fact it could just be specified inline.

I will put it in the aurprofile, maybe you're right.

"attrs_dict" is global in the registration module too, so I wanted to
remain consistent with that module I modify, so It's ok for me.

> Is it worth "hacking" this here? Maybe the upstream author would like
> this patch in django-registration. It'd be as simple as changing one
> line (upstream) then.

Sebastian :) You know upstream authors, it's not easy to reach any
result in this regard in some cases even this needs just a string
modification in the module, but I sent it to him of course earlier.
Hope the best.

Best Regards,
Laszlo Papp


From sebnow at gmail.com  Sat Nov 28 06:44:17 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sat, 28 Nov 2009 13:44:17 +0800
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated.  61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de>
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
	<a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com>
Message-ID: <08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>


On Nov 28, 2009, at 1:23 PM, Laszlo Papp wrote:

> On Sat, Nov 28, 2009 at 6:09 AM, Sebastian Nowicki  
> <sebnow at gmail.com> wrote:
>>
>> On Nov 28, 2009, at 4:47 AM, djszapi at archlinux.us wrote:
>>
>> The AurRegistrationForm should be put in aurprofile, not in the aur
>> app, as it has nothing to do with packages. "attrs_dict" should
>> probably not be global, and in fact it could just be specified  
>> inline.
>
> I will put it in the aurprofile, maybe you're right.
>
> "attrs_dict" is global in the registration module too, so I wanted to
> remain consistent with that module I modify, so It's ok for me.

You're not modifying a module, you're extending a class. The location  
of "attrs_dict" is irrelevant for the class you're extending, however  
you are polluting the local namespace.

>
>> Is it worth "hacking" this here? Maybe the upstream author would like
>> this patch in django-registration. It'd be as simple as changing one
>> line (upstream) then.
>
> Sebastian :) You know upstream authors, it's not easy to reach any
> result in this regard in some cases even this needs just a string
> modification in the module, but I sent it to him of course earlier.
> Hope the best.

Ok, cool.



From djszapi at archlinux.us  Sat Nov 28 06:52:14 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 06:52:14 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de>
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
	<a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com>
	<08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>
Message-ID: <a362e8010911272152u4f61d7e8rc4be45af53beba61@mail.gmail.com>

On Sat, Nov 28, 2009 at 6:44 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 28, 2009, at 1:23 PM, Laszlo Papp wrote:
>
>> On Sat, Nov 28, 2009 at 6:09 AM, Sebastian Nowicki
>> <sebnow at gmail.com> wrote:
>>>
>>> On Nov 28, 2009, at 4:47 AM, djszapi at archlinux.us wrote:
>>>
>>> The AurRegistrationForm should be put in aurprofile, not in the aur
>>> app, as it has nothing to do with packages. "attrs_dict" should
>>> probably not be global, and in fact it could just be specified
>>> inline.
>>
>> I will put it in the aurprofile, maybe you're right.
>>
>> "attrs_dict" is global in the registration module too, so I wanted to
>> remain consistent with that module I modify, so It's ok for me.
>
> You're not modifying a module, you're extending a class. The location
> of "attrs_dict" is irrelevant for the class you're extending, however
> you are polluting the local namespace.

Yeah, I didn't do that as you see in my patch and commit message, I
established a subclass for it. Maybe global attrs_dict isn't such a
big problem, but maybe I'm wrong. :) But you if think so, it can be
suggested to the module authors too with the other request, and I will
modify it in AUR2 source code when I move it into the aurprofile.

Thanks the feedback!

Best Regards,
Laszlo Papp


From sebnow at gmail.com  Sat Nov 28 07:12:17 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sat, 28 Nov 2009 14:12:17 +0800
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated.  61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <a362e8010911272152u4f61d7e8rc4be45af53beba61@mail.gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de>
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
	<a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com>
	<08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>
	<a362e8010911272152u4f61d7e8rc4be45af53beba61@mail.gmail.com>
Message-ID: <E42436A7-8BA9-403D-839D-0D05FF5722D9@gmail.com>


On Nov 28, 2009, at 1:52 PM, Laszlo Papp wrote:

> On Sat, Nov 28, 2009 at 6:44 AM, Sebastian Nowicki  
> <sebnow at gmail.com> wrote:
>>
>> On Nov 28, 2009, at 1:23 PM, Laszlo Papp wrote:
>>
>>> On Sat, Nov 28, 2009 at 6:09 AM, Sebastian Nowicki
>>> <sebnow at gmail.com> wrote:
>>>>
>>>> On Nov 28, 2009, at 4:47 AM, djszapi at archlinux.us wrote:
>>>>
>>>> The AurRegistrationForm should be put in aurprofile, not in the aur
>>>> app, as it has nothing to do with packages. "attrs_dict" should
>>>> probably not be global, and in fact it could just be specified
>>>> inline.
>>>
>>> I will put it in the aurprofile, maybe you're right.
>>>
>>> "attrs_dict" is global in the registration module too, so I wanted  
>>> to
>>> remain consistent with that module I modify, so It's ok for me.
>>
>> You're not modifying a module, you're extending a class. The location
>> of "attrs_dict" is irrelevant for the class you're extending, however
>> you are polluting the local namespace.
>
> Yeah, I didn't do that as you see in my patch and commit message, I
> established a subclass for it. Maybe global attrs_dict isn't such a
> big problem, but maybe I'm wrong. :) But you if think so, it can be
> suggested to the module authors too with the other request, and I will
> modify it in AUR2 source code when I move it into the aurprofile.
>
> Thanks the feedback!

Why suggest it to django-registration authors? It has nothing to do  
with them. AurRegistrationForm is completely separate, you can do  
whatever you like there. attrs_dict can be anywhere.



From djszapi at archlinux.us  Sat Nov 28 07:27:21 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 07:27:21 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <E42436A7-8BA9-403D-839D-0D05FF5722D9@gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de>
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
	<a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com>
	<08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>
	<a362e8010911272152u4f61d7e8rc4be45af53beba61@mail.gmail.com>
	<E42436A7-8BA9-403D-839D-0D05FF5722D9@gmail.com>
Message-ID: <a362e8010911272227q872071fr6e303435139f98c@mail.gmail.com>

On Sat, Nov 28, 2009 at 7:12 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 28, 2009, at 1:52 PM, Laszlo Papp wrote:
>
>> On Sat, Nov 28, 2009 at 6:44 AM, Sebastian Nowicki
>> <sebnow at gmail.com> wrote:
>>>
>>> On Nov 28, 2009, at 1:23 PM, Laszlo Papp wrote:
>>>
>>>> On Sat, Nov 28, 2009 at 6:09 AM, Sebastian Nowicki
>>>> <sebnow at gmail.com> wrote:
>>>>>
>>>>> On Nov 28, 2009, at 4:47 AM, djszapi at archlinux.us wrote:
>>>>>
>>>>> The AurRegistrationForm should be put in aurprofile, not in the aur
>>>>> app, as it has nothing to do with packages. "attrs_dict" should
>>>>> probably not be global, and in fact it could just be specified
>>>>> inline.
>>>>
>>>> I will put it in the aurprofile, maybe you're right.
>>>>
>>>> "attrs_dict" is global in the registration module too, so I wanted
>>>> to
>>>> remain consistent with that module I modify, so It's ok for me.
>>>
>>> You're not modifying a module, you're extending a class. The location
>>> of "attrs_dict" is irrelevant for the class you're extending, however
>>> you are polluting the local namespace.
>>
>> Yeah, I didn't do that as you see in my patch and commit message, I
>> established a subclass for it. Maybe global attrs_dict isn't such a
>> big problem, but maybe I'm wrong. :) But you if think so, it can be
>> suggested to the module authors too with the other request, and I will
>> modify it in AUR2 source code when I move it into the aurprofile.
>>
>> Thanks the feedback!
>
> Why suggest it to django-registration authors? It has nothing to do
> with them. AurRegistrationForm is completely separate, you can do
> whatever you like there. attrs_dict can be anywhere.

I said if you think so, not more, and I told to you that too I can
change attrs_dict when I move the snippet of code to the aurprofile,
so don't worry :)

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Sat Nov 28 10:09:24 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Sat, 28 Nov 2009 10:09:24 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. a73808e21190571c5a50e0e2847a6bd9cea5d910
Message-ID: <200911280909.nAS99OJv010194@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  a73808e21190571c5a50e0e2847a6bd9cea5d910 (commit)
       via  87af85f10a2e4ee0be918df9404078d589391034 (commit)
       via  86c6dd586f08807f64f2394b791dce9a991f5ace (commit)
      from  61008e056097dcd6542880ad6ffd1a9cbd9ee6e7 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit a73808e21190571c5a50e0e2847a6bd9cea5d910
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 28 09:33:04 2009 +0100

    Refactor account registration, keep one account for one mail
    
    Refactor the account registration with the help of new version of
    django-registration module which provides facility for it with the
    RegistrationFormUniqueEmail element to reject those requirements to register an
    account in which cases an account was registered earlier for that email address
    
    The implementation touched the urls.py file to introduce the backend facility in
    the new module in he accounts and account/register regards.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 87af85f10a2e4ee0be918df9404078d589391034
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 28 04:35:45 2009 +0100

    Add DEFAULT_FROM_ADRESS to settings_local.py.sample
    
    Add the email address into the settings_local.py.sample what will service the
    account registration procedure with sending activation/registration email.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 86c6dd586f08807f64f2394b791dce9a991f5ace
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 28 00:23:14 2009 +0100

    Remove Community repository from Submit select/option box
    
    Remove the community repository from the package submitting page, because
    community repository isn't handled by AUR anymore, and no need to involve
    option/select field for it.
    
    The implementation touched the aur/fixtures/initial_data.xml changing, so
    removing that objects from there, and making a manage.py flush to recreate
    the real data after deleting it on the admin interface.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 archlinux/aur/fixtures/initial_data.xml |    3 ---
 archlinux/settings_local.py.sample      |    3 +++
 archlinux/urls.py                       |    8 +++++---
 3 files changed, 8 insertions(+), 6 deletions(-)


hooks/post-receive
-- 
Project aur2 at BerliOS


From icarnales at gmail.com  Sat Nov 28 17:38:41 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 14:38:41 -0200
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <a362e8010911272227q872071fr6e303435139f98c@mail.gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de> 
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
	<a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com> 
	<08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>
	<a362e8010911272152u4f61d7e8rc4be45af53beba61@mail.gmail.com> 
	<E42436A7-8BA9-403D-839D-0D05FF5722D9@gmail.com>
	<a362e8010911272227q872071fr6e303435139f98c@mail.gmail.com>
Message-ID: <d83f7a8d0911280838j9b63af3s260172f361184896@mail.gmail.com>

Also, isn't "required" attribute part of the form field not the form
widget? I think attrs_dict is not needed at atll because required is
an attr of the field. Also is worth using a lint tool on your code,
there are double spacing an extra whitespace in parens on the end.

byebye!

On Sat, Nov 28, 2009 at 4:27 AM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 28, 2009 at 7:12 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>>
>> On Nov 28, 2009, at 1:52 PM, Laszlo Papp wrote:
>>
>>> On Sat, Nov 28, 2009 at 6:44 AM, Sebastian Nowicki
>>> <sebnow at gmail.com> wrote:
>>>>
>>>> On Nov 28, 2009, at 1:23 PM, Laszlo Papp wrote:
>>>>
>>>>> On Sat, Nov 28, 2009 at 6:09 AM, Sebastian Nowicki
>>>>> <sebnow at gmail.com> wrote:
>>>>>>
>>>>>> On Nov 28, 2009, at 4:47 AM, djszapi at archlinux.us wrote:
>>>>>>
>>>>>> The AurRegistrationForm should be put in aurprofile, not in the aur
>>>>>> app, as it has nothing to do with packages. "attrs_dict" should
>>>>>> probably not be global, and in fact it could just be specified
>>>>>> inline.
>>>>>
>>>>> I will put it in the aurprofile, maybe you're right.
>>>>>
>>>>> "attrs_dict" is global in the registration module too, so I wanted
>>>>> to
>>>>> remain consistent with that module I modify, so It's ok for me.
>>>>
>>>> You're not modifying a module, you're extending a class. The location
>>>> of "attrs_dict" is irrelevant for the class you're extending, however
>>>> you are polluting the local namespace.
>>>
>>> Yeah, I didn't do that as you see in my patch and commit message, I
>>> established a subclass for it. Maybe global attrs_dict isn't such a
>>> big problem, but maybe I'm wrong. :) But you if think so, it can be
>>> suggested to the module authors too with the other request, and I will
>>> modify it in AUR2 source code when I move it into the aurprofile.
>>>
>>> Thanks the feedback!
>>
>> Why suggest it to django-registration authors? It has nothing to do
>> with them. AurRegistrationForm is completely separate, you can do
>> whatever you like there. attrs_dict can be anywhere.
>
> I said if you think so, not more, and I told to you that too I can
> change attrs_dict when I move the snippet of code to the aurprofile,
> so don't worry :)
>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From icarnales at gmail.com  Sat Nov 28 17:41:04 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 14:41:04 -0200
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <A816C2BD-CA24-42C0-9069-0F053528A01C@gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com> 
	<1259345466-14111-1-git-send-email-icarnales@gmail.com>
	<a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com> 
	<d83f7a8d0911271245w76a50f0fn61248fad63977e5f@mail.gmail.com> 
	<A816C2BD-CA24-42C0-9069-0F053528A01C@gmail.com>
Message-ID: <d83f7a8d0911280841s6cc43ed1j97f32da0b6b39979@mail.gmail.com>

On Sat, Nov 28, 2009 at 3:01 AM, Sebastian Nowicki <sebnow at gmail.com> wrote:
>
> On Nov 28, 2009, at 4:45 AM, Ismael Carnales wrote:
>
>> So we are removing single PKGBUILD support?
>>
>> bye!
>
> Perhaps it's not a bad idea. Keeping consistent with the current AUR
> is a good idea. People at the moment are used to uploading PKGBUILDs
> (rather than tarballs) and complain. However, in some time (definitely
> before AUR2 gets released) people will be used to uploading tarballs,
> so allowing PKGBUILD uploads would be confusing again.
>

This makes sense, we could establish it as a "policy" for development,
I mean following the procedural changes of the main AUR project.

> On the other hand it's not much code to support this feature.
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From icarnales at gmail.com  Sat Nov 28 17:42:29 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 14:42:29 -0200
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <a362e8010911272113m227a08bet96270fcaeb450c68@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com> 
	<1259345466-14111-1-git-send-email-icarnales@gmail.com>
	<a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com> 
	<d83f7a8d0911271245w76a50f0fn61248fad63977e5f@mail.gmail.com> 
	<A816C2BD-CA24-42C0-9069-0F053528A01C@gmail.com>
	<a362e8010911272113m227a08bet96270fcaeb450c68@mail.gmail.com>
Message-ID: <d83f7a8d0911280842m4ddb6629w32823619ed860bae@mail.gmail.com>

>>> So we are removing single PKGBUILD support?
>>>
>>> bye!
>
> Yeah, I'd like to implement it, I will apply it soon. The simplicity,
> unity is my purpose here too.

This means that you're working in removing the feature? If not tell me
and I will take care of it.

byebye!

>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From djszapi at archlinux.us  Sat Nov 28 17:44:03 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 17:44:03 +0100
Subject: [aur2-dev] [PATCH] Fix single PKGBUILD file upload
In-Reply-To: <d83f7a8d0911280842m4ddb6629w32823619ed860bae@mail.gmail.com>
References: <d83f7a8d0911270821n4e9114cak25fe7eac02b9c31d@mail.gmail.com>
	<1259345466-14111-1-git-send-email-icarnales@gmail.com>
	<a362e8010911271216h686701e8y7e765d6493a7d640@mail.gmail.com>
	<d83f7a8d0911271245w76a50f0fn61248fad63977e5f@mail.gmail.com>
	<A816C2BD-CA24-42C0-9069-0F053528A01C@gmail.com>
	<a362e8010911272113m227a08bet96270fcaeb450c68@mail.gmail.com>
	<d83f7a8d0911280842m4ddb6629w32823619ed860bae@mail.gmail.com>
Message-ID: <a362e8010911280844y716a8bf0qda3b12e08170fb1@mail.gmail.com>

On Sat, Nov 28, 2009 at 5:42 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>>>> So we are removing single PKGBUILD support?
>>>>
>>>> bye!
>>
>> Yeah, I'd like to implement it, I will apply it soon. The simplicity,
>> unity is my purpose here too.
>
> This means that you're working in removing the feature? If not tell me
> and I will take care of it.

I've implemented it on my working branch, you will see it after the
next push operation, but thanks.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 28 17:50:01 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 14:50:01 -0200
Subject: [aur2-dev] [PATCH] Fix added date on Package and Comment models
In-Reply-To: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
References: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
Message-ID: <d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>

Sorry for asking, but someone cares to comment on this patch?
Currently the "added" date of the Comment model for example is totally
broken, I think we must fixit, with this implementation (not my
preferred as I commented earlier) or with other.

This is other thing I don't like much about the patch-sending
workflow, is easy for patches to get lost in tons of mails. Darcs has
a nice feature called darcswatch for keep track of patches:
http://darcs.nomeata.de/darcswatch/documentation.html do you know if
something like this exists for git?

bye!

On Fri, Nov 27, 2009 at 4:35 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> From: Ismael Carnales <icarnales at gmail.com>
>
> The added datetime for Packages and Comments was getting set in the
> default value (always the datetime from server start), now using
> auto_now_create and auto_now for updated
>
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> ?archlinux/aur/models.py | ? ?7 +++----
> ?1 files changed, 3 insertions(+), 4 deletions(-)
>
> diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
> index 6bc7a85..abdc5ef 100644
> --- a/archlinux/aur/models.py
> +++ b/archlinux/aur/models.py
> @@ -94,8 +94,8 @@ class Package(models.Model):
> ? ? provides = models.ManyToManyField(Provision, null=True, blank=True)
> ? ? deleted = models.BooleanField(default=False)
> ? ? outdated = models.BooleanField(default=False)
> - ? ?added = models.DateTimeField(editable=False, default=datetime.now())
> - ? ?updated = models.DateTimeField()
> + ? ?added = models.DateTimeField(auto_now_add=True)
> + ? ?updated = models.DateTimeField(auto_now=True)
> ? ? groups = models.ManyToManyField(Group, null=True, blank=True)
>
> ? ? def __unicode__(self):
> @@ -114,7 +114,6 @@ class Package(models.Model):
> ? ? get_absolute_url = permalink(get_absolute_url)
>
> ? ? def save(self):
> - ? ? ? ?self.updated = datetime.now()
> ? ? ? ? if not self.slug:
> ? ? ? ? ? ? import re
> ? ? ? ? ? ? slug = re.sub('[^\w\s-]', '', self.name).strip().lower()
> @@ -166,7 +165,7 @@ class Comment(models.Model):
> ? ? parent = models.ForeignKey('self', null=True, blank=True)
> ? ? user = models.ForeignKey(User)
> ? ? message = models.TextField()
> - ? ?added = models.DateTimeField(editable=False, default=datetime.now())
> + ? ?added = models.DateTimeField(auto_now_add=True)
> ? ? ip = models.IPAddressField()
> ? ? hidden = models.BooleanField(default=False)
>
> --
> 1.6.5.2
>
>


From djszapi at archlinux.us  Sat Nov 28 17:52:42 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 17:52:42 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <d83f7a8d0911280838j9b63af3s260172f361184896@mail.gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de>
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
	<a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com>
	<08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>
	<a362e8010911272152u4f61d7e8rc4be45af53beba61@mail.gmail.com>
	<E42436A7-8BA9-403D-839D-0D05FF5722D9@gmail.com>
	<a362e8010911272227q872071fr6e303435139f98c@mail.gmail.com>
	<d83f7a8d0911280838j9b63af3s260172f361184896@mail.gmail.com>
Message-ID: <a362e8010911280852u13b68a53qe3e6fd6cbe0bd601@mail.gmail.com>

On Sat, Nov 28, 2009 at 5:38 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Also, isn't "required" attribute part of the form field not the form
> widget? I think attrs_dict is not needed at atll because required is
> an attr of the field. Also is worth using a lint tool on your code,
> there are double spacing an extra whitespace in parens on the end.
>
> byebye!

Please stop top posting, maybe I told it to you earlier!

Otherwise If i didn't insert that I got runtime error, but as I told
it earlier more times, I will review this patch again, when I will
have time to move into the aurprofile.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 28 17:55:25 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 14:55:25 -0200
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	61008e056097dcd6542880ad6ffd1a9cbd9ee6e7
In-Reply-To: <a362e8010911280852u13b68a53qe3e6fd6cbe0bd601@mail.gmail.com>
References: <200911272047.nARKluqi026399@sheep.berlios.de> 
	<CC20A434-569F-4A1A-B499-AA78E2E52518@gmail.com>
	<a362e8010911272123w1d325233rc227491ce1450c5b@mail.gmail.com> 
	<08C0B262-DB8C-41A7-AC2F-11CAED79E782@gmail.com>
	<a362e8010911272152u4f61d7e8rc4be45af53beba61@mail.gmail.com> 
	<E42436A7-8BA9-403D-839D-0D05FF5722D9@gmail.com>
	<a362e8010911272227q872071fr6e303435139f98c@mail.gmail.com> 
	<d83f7a8d0911280838j9b63af3s260172f361184896@mail.gmail.com> 
	<a362e8010911280852u13b68a53qe3e6fd6cbe0bd601@mail.gmail.com>
Message-ID: <d83f7a8d0911280855g6d579386wa228bea6c7b77c63@mail.gmail.com>

> Please stop top posting, maybe I told it to you earlier!

What do you mean with "top posting"?

>
> Otherwise If i didn't insert that I got runtime error, but as I told
> it earlier more times, I will review this patch again, when I will
> have time to move into the aurprofile.

I was only helping you with the code review of the patch.

>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From djszapi at archlinux.us  Sat Nov 28 17:58:07 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 17:58:07 +0100
Subject: [aur2-dev] [PATCH] Fix added date on Package and Comment models
In-Reply-To: <d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>
References: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
	<d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>
Message-ID: <a362e8010911280858k62b6646eh9a0b59e0bc5785cf@mail.gmail.com>

On Sat, Nov 28, 2009 at 5:50 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> Sorry for asking, but someone cares to comment on this patch?
> Currently the "added" date of the Comment model for example is totally
> broken, I think we must fixit, with this implementation (not my
> preferred as I commented earlier) or with other.

Stop top posting !

http://www.caliburn.nl/topposting.html

Ismael, it's Saturday here (weekend), not everybody can see just your
patches in every hour/minute, please be more patient, and this mailing
list hasn't got so much active members, just some, but I guess you
realised it, so we have got work, job, family, hobby too near this
project, don't hurry us, please.


> This is other thing I don't like much about the patch-sending
> workflow, is easy for patches to get lost in tons of mails. Darcs has
> a nice feature called darcswatch for keep track of patches:
> http://darcs.nomeata.de/darcswatch/documentation.html do you know if
> something like this exists for git?
>
> bye!

If you can't accept this patch-sending workflow, don't send patches,
that's the best way to avoid your frustrations.
I wouldn't like to change this conventation that I saw in every
project where I contributed in my freetime, that's the way in pacman,
current aur, git, aif, and in other projects that I know.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 28 18:09:02 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 15:09:02 -0200
Subject: [aur2-dev] [PATCH] Fix added date on Package and Comment models
In-Reply-To: <a362e8010911280858k62b6646eh9a0b59e0bc5785cf@mail.gmail.com>
References: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com> 
	<d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com> 
	<a362e8010911280858k62b6646eh9a0b59e0bc5785cf@mail.gmail.com>
Message-ID: <d83f7a8d0911280909w5dd56e23g7c7d36d2bd32130e@mail.gmail.com>

On Sat, Nov 28, 2009 at 2:58 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 28, 2009 at 5:50 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> Sorry for asking, but someone cares to comment on this patch?
>> Currently the "added" date of the Comment model for example is totally
>> broken, I think we must fixit, with this implementation (not my
>> preferred as I commented earlier) or with other.
>
> Stop top posting !
>
> http://www.caliburn.nl/topposting.html
>
> Ismael, it's Saturday here (weekend), not everybody can see just your
> patches in every hour/minute, please be more patient, and this mailing
> list hasn't got so much active members, just some, but I guess you
> realised it, so we have got work, job, family, hobby too near this
> project, don't hurry us, please.
>

Laszlo, you misunderstood my intentions once again, I only was trying
to get attention to the patch (but not for inmediate reply), so it
doesn't get lost.

>
>> This is other thing I don't like much about the patch-sending
>> workflow, is easy for patches to get lost in tons of mails. Darcs has
>> a nice feature called darcswatch for keep track of patches:
>> http://darcs.nomeata.de/darcswatch/documentation.html do you know if
>> something like this exists for git?
>>
>> bye!
>
> If you can't accept this patch-sending workflow, don't send patches,
> that's the best way to avoid your frustrations.
> I wouldn't like to change this conventation that I saw in every
> project where I contributed in my freetime, that's the way in pacman,
> current aur, git, aif, and in other projects that I know.\\

You missed my point here, I was asking about if there's something like
darcswatch or a way to keep track of patches, not changing the
workflow, the same would happen with pull requests.

Ah, and is Saturday here too, I don't feel like fighting :)

>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From cmbrannon79 at gmail.com  Sat Nov 28 17:57:28 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Sat, 28 Nov 2009 10:57:28 -0600
Subject: [aur2-dev] [PATCH] Change the "added" field in Vote to use
	auto_now_add.
Message-ID: <4b115c39.9653f10a.084a.7f57@mx.google.com>

It's consistent with the rest of the code, and
creation timestamps are constructed automatically.
---
 archlinux/aur/models.py |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
index 5a8c641..03dc672 100644
--- a/archlinux/aur/models.py
+++ b/archlinux/aur/models.py
@@ -186,7 +186,7 @@ class PackageNotification(models.Model):
 class Vote(models.Model):
     user = models.ForeignKey(User)
     package = models.ForeignKey(Package)
-    added = models.DateTimeField(editable=False, default=datetime.now())
+    added = models.DateTimeField(auto_now_add=True)
 
     def __unicode__(self):
         return u"%s's vote for %s" % (self.user.username,
-- 
1.6.4.4



From djszapi at archlinux.us  Sat Nov 28 18:29:15 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 18:29:15 +0100
Subject: [aur2-dev] [PATCH] Change the "added" field in Vote to use
	auto_now_add.
In-Reply-To: <4b115c39.9653f10a.084a.7f57@mx.google.com>
References: <4b115c39.9653f10a.084a.7f57@mx.google.com>
Message-ID: <a362e8010911280929y1aacbd3dvbbb1fa358754e68c@mail.gmail.com>

On Sat, Nov 28, 2009 at 5:57 PM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:
> It's consistent with the rest of the code, and
> creation timestamps are constructed automatically.
> ---
> ?archlinux/aur/models.py | ? ?2 +-
> ?1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
> index 5a8c641..03dc672 100644
> --- a/archlinux/aur/models.py
> +++ b/archlinux/aur/models.py
> @@ -186,7 +186,7 @@ class PackageNotification(models.Model):
> ?class Vote(models.Model):
> ? ? user = models.ForeignKey(User)
> ? ? package = models.ForeignKey(Package)
> - ? ?added = models.DateTimeField(editable=False, default=datetime.now())
> + ? ?added = models.DateTimeField(auto_now_add=True)
>
> ? ? def __unicode__(self):
> ? ? ? ? return u"%s's vote for %s" % (self.user.username,
> --
> 1.6.4.4
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

It seems fine for me, thanks your effort.

Can I apply all Vote related patches, how did you, Sebastian and
others decide in this regard, which implementation we should follow,
voting, download counting, pkgstat way ?

Best Regards,
Laszlo Papp


From cmbrannon79 at gmail.com  Sat Nov 28 18:22:28 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Sat, 28 Nov 2009 11:22:28 -0600
Subject: [aur2-dev] [PATCH] Fix added date on Package and Comment models
In-Reply-To: <d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>
References: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
	<d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>
Message-ID: <4b115c0e.9553f10a.6014.ffff802e@mx.google.com>

Ismael Carnales wrote:
> Sorry for asking, but someone cares to comment on this patch?
> Currently the "added" date of the Comment model for example is totally
> broken, I think we must fixit, with this implementation (not my
> preferred as I commented earlier) or with other.

I applied this locally yesterday, and it seems good.
I'll be sending along the same change for Vote momentarily, in case
everyone decides to hold on to the Vote code.

Ismael, like I said yesterday, feel free to change my code if you wish,
especially if you are changing related things.

-- Chris


From icarnales at gmail.com  Sat Nov 28 18:35:57 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 15:35:57 -0200
Subject: [aur2-dev] [PATCH] Change the "added" field in Vote to use
	auto_now_add.
In-Reply-To: <a362e8010911280929y1aacbd3dvbbb1fa358754e68c@mail.gmail.com>
References: <4b115c39.9653f10a.084a.7f57@mx.google.com>
	<a362e8010911280929y1aacbd3dvbbb1fa358754e68c@mail.gmail.com>
Message-ID: <d83f7a8d0911280935j2d209b83i5092699063dc2962@mail.gmail.com>

On Sat, Nov 28, 2009 at 3:29 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 28, 2009 at 5:57 PM, Christopher Brannon
> <cmbrannon79 at gmail.com> wrote:
>> It's consistent with the rest of the code, and
>> creation timestamps are constructed automatically.
>> ---
>> ?archlinux/aur/models.py | ? ?2 +-
>> ?1 files changed, 1 insertions(+), 1 deletions(-)
>>
>> diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
>> index 5a8c641..03dc672 100644
>> --- a/archlinux/aur/models.py
>> +++ b/archlinux/aur/models.py
>> @@ -186,7 +186,7 @@ class PackageNotification(models.Model):
>> ?class Vote(models.Model):
>> ? ? user = models.ForeignKey(User)
>> ? ? package = models.ForeignKey(Package)
>> - ? ?added = models.DateTimeField(editable=False, default=datetime.now())
>> + ? ?added = models.DateTimeField(auto_now_add=True)
>>
>> ? ? def __unicode__(self):
>> ? ? ? ? return u"%s's vote for %s" % (self.user.username,
>> --
>> 1.6.4.4
>>
>> _______________________________________________
>> aur2-dev mailing list
>> aur2-dev at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/aur2-dev
>>
>
> It seems fine for me, thanks your effort.
>
> Can I apply all Vote related patches, how did you, Sebastian and
> others decide in this regard, which implementation we should follow,
> voting, download counting, pkgstat way ?

I think by now we can use the "follow the main AUR app policy" and
implement the voting as we already have the code from Chris, this
could be changed later.

So its a +1 for appliying voting patches.

bye!

> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From djszapi at archlinux.us  Sat Nov 28 18:42:45 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 18:42:45 +0100
Subject: [aur2-dev] [PATCH] Fix added date on Package and Comment models
In-Reply-To: <d83f7a8d0911280909w5dd56e23g7c7d36d2bd32130e@mail.gmail.com>
References: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
	<d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>
	<a362e8010911280858k62b6646eh9a0b59e0bc5785cf@mail.gmail.com>
	<d83f7a8d0911280909w5dd56e23g7c7d36d2bd32130e@mail.gmail.com>
Message-ID: <a362e8010911280942n6aa266d6v6192269c9373aac7@mail.gmail.com>

> You missed my point here, I was asking about if there's something like
> darcswatch or a way to keep track of patches, not changing the
> workflow, the same would happen with pull requests.

Maybe this one:
http://ozlabs.org/~jk/projects/patchwork/

> Ah, and is Saturday here too, I don't feel like fighting :)

If you will be more patient and keep some basic things there won't be
any problem, I'm sure in it.

Anyway, Your attention is right to develop AUR2, at least I admire it :)

Best Regards,
Laszlo Papp


From cmbrannon79 at gmail.com  Sat Nov 28 18:48:50 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Sat, 28 Nov 2009 11:48:50 -0600
Subject: [aur2-dev] [PATCH] Change the "added" field in Vote to use
	auto_now_add.
In-Reply-To: <a362e8010911280929y1aacbd3dvbbb1fa358754e68c@mail.gmail.com>
References: <4b115c39.9653f10a.084a.7f57@mx.google.com>
	<a362e8010911280929y1aacbd3dvbbb1fa358754e68c@mail.gmail.com>
Message-ID: <4b11623c.9453f10a.21f4.7f97@mx.google.com>

Laszlo Papp wrote:
> Can I apply all Vote related patches, how did you, Sebastian and
> others decide in this regard, which implementation we should follow,
> voting, download counting, pkgstat way ?

I can't really speak for everyone, but from what I can tell, nobody has
a problem with keeping the voting code around for now.  If they do, they
haven't expressed it.  I'd say, go ahead and apply it, though it may be
replaced with a better mechanism at a later date.

-- Chris


From icarnales at gmail.com  Sat Nov 28 18:51:07 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 15:51:07 -0200
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	a73808e21190571c5a50e0e2847a6bd9cea5d910
In-Reply-To: <200911280909.nAS99OJv010194@sheep.berlios.de>
References: <200911280909.nAS99OJv010194@sheep.berlios.de>
Message-ID: <d83f7a8d0911280951p28d5c5dcx497c4b1ecaacf6da@mail.gmail.com>

On Sat, Nov 28, 2009 at 7:09 AM,  <djszapi at archlinux.us> wrote:
> This is an automated email from the git hooks/post-receive script. It was
> generated because a ref change was pushed to the repository containing
> the project "Project aur2 at BerliOS".
>
> The branch, master has been updated
> ? ? ? via ?a73808e21190571c5a50e0e2847a6bd9cea5d910 (commit)
> ? ? ? via ?87af85f10a2e4ee0be918df9404078d589391034 (commit)
> ? ? ? via ?86c6dd586f08807f64f2394b791dce9a991f5ace (commit)
> ? ? ?from ?61008e056097dcd6542880ad6ffd1a9cbd9ee6e7 (commit)
>
> Those revisions listed above that are new to this repository have
> not appeared on any other notification email; so we list those
> revisions in full, below.
>
> - Log -----------------------------------------------------------------
> commit a73808e21190571c5a50e0e2847a6bd9cea5d910
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date: ? Sat Nov 28 09:33:04 2009 +0100
>
> ? ?Refactor account registration, keep one account for one mail
>
> ? ?Refactor the account registration with the help of new version of
> ? ?django-registration module which provides facility for it with the
> ? ?RegistrationFormUniqueEmail element to reject those requirements to register an
> ? ?account in which cases an account was registered earlier for that email address
>
> ? ?The implementation touched the urls.py file to introduce the backend facility in
> ? ?the new module in he accounts and account/register regards.
>
> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>

What django-registration version is needed now? This commit breaks my
installation with django-registration 0.7 (last official release) are
we followig trunk now? or using 0.8alphra?. If yes, maybe is better to
hold this patch until 0.8 gets released, bye!

> commit 87af85f10a2e4ee0be918df9404078d589391034
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date: ? Sat Nov 28 04:35:45 2009 +0100
>
> ? ?Add DEFAULT_FROM_ADRESS to settings_local.py.sample
>
> ? ?Add the email address into the settings_local.py.sample what will service the
> ? ?account registration procedure with sending activation/registration email.
>
> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>
> commit 86c6dd586f08807f64f2394b791dce9a991f5ace
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date: ? Sat Nov 28 00:23:14 2009 +0100
>
> ? ?Remove Community repository from Submit select/option box
>
> ? ?Remove the community repository from the package submitting page, because
> ? ?community repository isn't handled by AUR anymore, and no need to involve
> ? ?option/select field for it.
>
> ? ?The implementation touched the aur/fixtures/initial_data.xml changing, so
> ? ?removing that objects from there, and making a manage.py flush to recreate
> ? ?the real data after deleting it on the admin interface.
>
> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>
> -----------------------------------------------------------------------
>
> Summary of changes:
> ?archlinux/aur/fixtures/initial_data.xml | ? ?3 ---
> ?archlinux/settings_local.py.sample ? ? ?| ? ?3 +++
> ?archlinux/urls.py ? ? ? ? ? ? ? ? ? ? ? | ? ?8 +++++---
> ?3 files changed, 8 insertions(+), 6 deletions(-)
>
>
> hooks/post-receive
> --
> Project aur2 at BerliOS
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From djszapi at archlinux.us  Sat Nov 28 18:54:35 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 18:54:35 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	a73808e21190571c5a50e0e2847a6bd9cea5d910
In-Reply-To: <d83f7a8d0911280951p28d5c5dcx497c4b1ecaacf6da@mail.gmail.com>
References: <200911280909.nAS99OJv010194@sheep.berlios.de>
	<d83f7a8d0911280951p28d5c5dcx497c4b1ecaacf6da@mail.gmail.com>
Message-ID: <a362e8010911280954r7225f508h6458e8ea3d477776@mail.gmail.com>

On Sat, Nov 28, 2009 at 6:51 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> On Sat, Nov 28, 2009 at 7:09 AM, ?<djszapi at archlinux.us> wrote:
>> This is an automated email from the git hooks/post-receive script. It was
>> generated because a ref change was pushed to the repository containing
>> the project "Project aur2 at BerliOS".
>>
>> The branch, master has been updated
>> ? ? ? via ?a73808e21190571c5a50e0e2847a6bd9cea5d910 (commit)
>> ? ? ? via ?87af85f10a2e4ee0be918df9404078d589391034 (commit)
>> ? ? ? via ?86c6dd586f08807f64f2394b791dce9a991f5ace (commit)
>> ? ? ?from ?61008e056097dcd6542880ad6ffd1a9cbd9ee6e7 (commit)
>>
>> Those revisions listed above that are new to this repository have
>> not appeared on any other notification email; so we list those
>> revisions in full, below.
>>
>> - Log -----------------------------------------------------------------
>> commit a73808e21190571c5a50e0e2847a6bd9cea5d910
>> Author: Laszlo Papp <djszapi at archlinux.us>
>> Date: ? Sat Nov 28 09:33:04 2009 +0100
>>
>> ? ?Refactor account registration, keep one account for one mail
>>
>> ? ?Refactor the account registration with the help of new version of
>> ? ?django-registration module which provides facility for it with the
>> ? ?RegistrationFormUniqueEmail element to reject those requirements to register an
>> ? ?account in which cases an account was registered earlier for that email address
>>
>> ? ?The implementation touched the urls.py file to introduce the backend facility in
>> ? ?the new module in he accounts and account/register regards.
>>
>> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>>
>
> What django-registration version is needed now? This commit breaks my
> installation with django-registration 0.7 (last official release) are
> we followig trunk now? or using 0.8alphra?. If yes, maybe is better to
> hold this patch until 0.8 gets released, bye!

>0.7

I spoke with the author of django-registration and he told me he
couldn't have time to maintain it anymore, and I've adopted it, and
I've updated immediately, so you can update it from AUR directly.

It works fine for me here after the update procedure.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 28 19:01:00 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 16:01:00 -0200
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	a73808e21190571c5a50e0e2847a6bd9cea5d910
In-Reply-To: <a362e8010911280954r7225f508h6458e8ea3d477776@mail.gmail.com>
References: <200911280909.nAS99OJv010194@sheep.berlios.de> 
	<d83f7a8d0911280951p28d5c5dcx497c4b1ecaacf6da@mail.gmail.com> 
	<a362e8010911280954r7225f508h6458e8ea3d477776@mail.gmail.com>
Message-ID: <d83f7a8d0911281001g2ba594b7td97a42de52e74667@mail.gmail.com>

On Sat, Nov 28, 2009 at 3:54 PM, Laszlo Papp <djszapi at archlinux.us> wrote:
> On Sat, Nov 28, 2009 at 6:51 PM, Ismael Carnales <icarnales at gmail.com> wrote:
>> On Sat, Nov 28, 2009 at 7:09 AM, ?<djszapi at archlinux.us> wrote:
>>> This is an automated email from the git hooks/post-receive script. It was
>>> generated because a ref change was pushed to the repository containing
>>> the project "Project aur2 at BerliOS".
>>>
>>> The branch, master has been updated
>>> ? ? ? via ?a73808e21190571c5a50e0e2847a6bd9cea5d910 (commit)
>>> ? ? ? via ?87af85f10a2e4ee0be918df9404078d589391034 (commit)
>>> ? ? ? via ?86c6dd586f08807f64f2394b791dce9a991f5ace (commit)
>>> ? ? ?from ?61008e056097dcd6542880ad6ffd1a9cbd9ee6e7 (commit)
>>>
>>> Those revisions listed above that are new to this repository have
>>> not appeared on any other notification email; so we list those
>>> revisions in full, below.
>>>
>>> - Log -----------------------------------------------------------------
>>> commit a73808e21190571c5a50e0e2847a6bd9cea5d910
>>> Author: Laszlo Papp <djszapi at archlinux.us>
>>> Date: ? Sat Nov 28 09:33:04 2009 +0100
>>>
>>> ? ?Refactor account registration, keep one account for one mail
>>>
>>> ? ?Refactor the account registration with the help of new version of
>>> ? ?django-registration module which provides facility for it with the
>>> ? ?RegistrationFormUniqueEmail element to reject those requirements to register an
>>> ? ?account in which cases an account was registered earlier for that email address
>>>
>>> ? ?The implementation touched the urls.py file to introduce the backend facility in
>>> ? ?the new module in he accounts and account/register regards.
>>>
>>> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>
>>>
>>
>> What django-registration version is needed now? This commit breaks my
>> installation with django-registration 0.7 (last official release) are
>> we followig trunk now? or using 0.8alphra?. If yes, maybe is better to
>> hold this patch until 0.8 gets released, bye!
>
>>0.7
>
> I spoke with the author of django-registration and he told me he
> couldn't have time to maintain it anymore, and I've adopted it, and
> I've updated immediately, so you can update it from AUR directly.
>

The author of django-registration? Jammes Bennet? I think you mean the
maintainer of the django-registration package on the AUR. As I see in
the PKGBUILD from the AUR you're using 0.8alpha1, this is not an
official release yet, so it's not tracked by Python package managers
like easy_install or pip, you should make a note of it and change the
pip-requirements.txt file of the project.

Btw: As I said earlier I think is better to hold off this patch until
0.8 gets officially released, we cannot depend on the developers
intalling python packages from the aur. And I think is better tracking
official releases of 3rd pary apps.

bye!

> It works fine for me here after the update procedure.
>
> Best Regards,
> Laszlo Papp
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>


From djszapi at archlinux.us  Sat Nov 28 19:42:50 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 19:42:50 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	a73808e21190571c5a50e0e2847a6bd9cea5d910
In-Reply-To: <d83f7a8d0911281001g2ba594b7td97a42de52e74667@mail.gmail.com>
References: <200911280909.nAS99OJv010194@sheep.berlios.de>
	<d83f7a8d0911280951p28d5c5dcx497c4b1ecaacf6da@mail.gmail.com>
	<a362e8010911280954r7225f508h6458e8ea3d477776@mail.gmail.com>
	<d83f7a8d0911281001g2ba594b7td97a42de52e74667@mail.gmail.com>
Message-ID: <a362e8010911281042g72c3f98fl391e302f903fca6c@mail.gmail.com>

> The author of django-registration? Jammes Bennet? I think you mean the
> maintainer of the django-registration package on the AUR. As I see in
> the PKGBUILD from the AUR you're using 0.8alpha1, this is not an
> official release yet, so it's not tracked by Python package managers
> like easy_install or pip, you should make a note of it and change the
> pip-requirements.txt file of the project.

Have you ever used *-{svn,git,cvs,etc} packages ? It's newer than
alpha with the latest commits.
But anyway, I will update the dependencies list with other
dependencies like voting too.

> Btw: As I said earlier I think is better to hold off this patch until
> 0.8 gets officially released, we cannot depend on the developers
> intalling python packages from the aur. And I think is better tracking
> official releases of 3rd pary apps.
>
> bye!

I didn't catch your point here too, because if a new developer would
come to contribute in this project, he should install it from AUR
anyway (as he should do it in case of earlier versions too), so it's
not an overhead or something, and you update it too easily.

Some other basic things:

1) Don't keep the last lines from the previous mail(s), after your
last comment in your reply, because they're not relevant in the reply
mail in that case.

2) Your english is not the best one(or you didn't check your mails
before posting, and you're in big hurry) that's not problem, but you
could do against, but I try to suggest a checker solution for you in
vim:

map sc :setlocal spell spelllang=en_gb<CR>

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sat Nov 28 20:18:49 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 17:18:49 -0200
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	a73808e21190571c5a50e0e2847a6bd9cea5d910
In-Reply-To: <a362e8010911281042g72c3f98fl391e302f903fca6c@mail.gmail.com>
References: <200911280909.nAS99OJv010194@sheep.berlios.de> 
	<d83f7a8d0911280951p28d5c5dcx497c4b1ecaacf6da@mail.gmail.com> 
	<a362e8010911280954r7225f508h6458e8ea3d477776@mail.gmail.com> 
	<d83f7a8d0911281001g2ba594b7td97a42de52e74667@mail.gmail.com> 
	<a362e8010911281042g72c3f98fl391e302f903fca6c@mail.gmail.com>
Message-ID: <d83f7a8d0911281118s1a24a80ch717640827c72450b@mail.gmail.com>

> Have you ever used *-{svn,git,cvs,etc} packages ? It's newer than
> alpha with the latest commits.
> But anyway, I will update the dependencies list with other
> dependencies like voting too.
>

Oh my ... of course I've used. I'm talking about general python
development, there's a packaging for python projects independent of
the packaging of the linux distro, take a look at easy_install and
pip.

Btw: Voting? aren't we going to use Chris patches?

> I didn't catch your point here too, because if a new developer would
> come to contribute in this project, he should install it from AUR
> anyway (as he should do it in case of earlier versions too), so it's
> not an overhead or something, and you update it too easily.

New developers probably will set a virtualenv for aur2 project and
install packages using easy_install or pip, that's why this project
provides a pip-requirements.txt file with the packages needed to run
it, and your patch changes the dep of django-registration from >=7.0
to >=8.1alplha (which isn't released) so we will need to use the hg
version here.

byebye!


From djszapi at archlinux.us  Sat Nov 28 20:57:43 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 20:57:43 +0100
Subject: [aur2-dev] [PATCH 1/2] Misc syntax fixes.
In-Reply-To: <9A4893EA-64E6-4172-AB88-7A47C4CE77D5@gmail.com>
References: <4b0da78b.0906c00a.16cb.0291@mx.google.com>
	<a362e8010911251405l15c0419dj540513c52613a1d3@mail.gmail.com>
	<9A4893EA-64E6-4172-AB88-7A47C4CE77D5@gmail.com>
Message-ID: <a362e8010911281157s6c22e479mf444d620b22adb5@mail.gmail.com>

>>> * Remove the text "ah" from the middle of a template.
>
> I'd prefer that these were 3 separate patches (as they are 3 different
> logical units of change), but it looks good. Thanks.

I think so too, could you send again, Chris as 3 separate patches,
then I will apply it ?
I'd modify the top line for starting with imperative word, like Fix
Misc syntax instead of Misc syntax fixes (just an example).

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Sat Nov 28 21:01:39 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 21:01:39 +0100
Subject: [aur2-dev] [PATCH 2/2] Add voting for packages.
In-Reply-To: <4b0ebb78.cf02be0a.2282.30bd@mx.google.com>
References: <4b0da799.0407c00a.25d9.0250@mx.google.com>
	<D8A684DB-6051-4D6C-8CF8-F959F5873EF1@gmail.com>
	<4b0ebb78.cf02be0a.2282.30bd@mx.google.com>
Message-ID: <a362e8010911281201w5fec925pcd3304a6e8ea7eee@mail.gmail.com>

> *SNIP*
>> Setting auto_now_add=True would make setting the when parameter
>> unnecessary.
>
> Ok, thanks. ?I didn't notice that one.
>
> -- Chris

Would you be so kind as to send again the patch, Chris with those
modifications ideas that were taken ?

Best Regards,
Laszlo Papp


From cmbrannon79 at gmail.com  Sat Nov 28 21:14:23 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Sat, 28 Nov 2009 14:14:23 -0600
Subject: [aur2-dev] [PATCH 1/4] Add EOF to the end of parsepkgbuild.sh.
Message-ID: <4b118a02.9453f10a.21f4.ffff8582@mx.google.com>

I needed to do this, because the script wouldn't work over here.  Package
uploading didn't work for me, but now it does.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/aur/Package/parsepkgbuild.sh |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/archlinux/aur/Package/parsepkgbuild.sh b/archlinux/aur/Package/parsepkgbuild.sh
index f08a8d8..3e262db 100755
--- a/archlinux/aur/Package/parsepkgbuild.sh
+++ b/archlinux/aur/Package/parsepkgbuild.sh
@@ -58,3 +58,4 @@ print_array sha1sums    "\${sha1sums[@]}"
 print_array sha256sums  "\${sha256sums[@]}"
 print_array sha384sums  "\${sha384sums[@]}"
 print_array sha512sums  "\${sha512sums[@]}"
+EOF
-- 
1.6.4.4



From cmbrannon79 at gmail.com  Sat Nov 28 21:16:08 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Sat, 28 Nov 2009 14:16:08 -0600
Subject: [aur2-dev] [PATCH 2/4] Remove a word from the middle of a template.
Message-ID: <4b118a1a.9753f10a.316e.ffff85e7@mx.google.com>

Somehow, the word "ah" was in the middle of the package details template,
and it doesn't belong.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/templates/aur/package_detail.html |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
index 59abf9f..b58f49b 100644
--- a/archlinux/templates/aur/package_detail.html
+++ b/archlinux/templates/aur/package_detail.html
@@ -49,7 +49,7 @@
         </tr><tr>
             <th>{% trans "Download" %}</th>
             <td><a href="{{ pkg.tarball.url }}">{{ pkg.get_tarball_basename }}</a></td>
-        </tr>ah
+        </tr>
     </table>
     <br />
     <table width="100%">
-- 
1.6.4.4



From cmbrannon79 at gmail.com  Sat Nov 28 21:17:46 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Sat, 28 Nov 2009 14:17:46 -0600
Subject: [aur2-dev] [PATCH 3/4] Remove an unneeded call to os.path.join.
Message-ID: <4b118a24.9453f10a.1e2d.ffff8699@mx.google.com>

The call had one argument, so it was a no-op.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/aur/forms.py |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
index 82254b0..5fcfd46 100644
--- a/archlinux/aur/forms.py
+++ b/archlinux/aur/forms.py
@@ -240,7 +240,7 @@ class PackageSubmitForm(forms.Form):
             # If it's a local file, save to disk, otherwise record as url
             source_file = os.path.join(tmpdir_sources, package.name, source_filename)
             if is_tarfile and os.path.exists(source_file):
-                fp = File(open(os.path.join(source_file), "r"))
+                fp = File(open(source_file, "r"))
                 source.filename.save('%(name)s/sources/' + source_filename, fp)
                 fp.close()
             else:
-- 
1.6.4.4



From cmbrannon79 at gmail.com  Sat Nov 28 21:20:00 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Sat, 28 Nov 2009 14:20:00 -0600
Subject: [aur2-dev] [PATCH 4/4] Add voting for packages.
Message-ID: <4b118a35.9653f10a.0843.ffff89a2@mx.google.com>

A Vote object records the fact that a given user voted for a certain
package at a known time.
Voting and unvoting are implemented.  Also, the details page for a package
shows the number of votes that it has received.

Per discussions on the mailing list, the DateTime field is declared with
auto_now_add=True, so we don't have to save timestamps manually on creation of votes.

This patch incorporates the following changes by Ismael Carnales:
1. Use get_package_or_404 in unvote, from views.py.  Trying to remove
a vote for a non-existent package should produce a 404 HTTP response.
2. The timestamp in the Vote class should be named "added" for consistency,
rather than "when", which was the name used in the original patch.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/aur/models.py                     |   13 ++++++
 archlinux/aur/templatetags/aur_tags.py      |   10 ++++-
 archlinux/aur/tests.py                      |   59 ++++++++++++++++++++++++++-
 archlinux/aur/urls.py                       |    4 ++
 archlinux/aur/views.py                      |   24 +++++++++++
 archlinux/templates/aur/package_detail.html |    9 ++++
 6 files changed, 117 insertions(+), 2 deletions(-)

diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
index 6bc7a85..f399200 100644
--- a/archlinux/aur/models.py
+++ b/archlinux/aur/models.py
@@ -1,5 +1,6 @@
 from django.db import models
 from django.db import transaction
+from django.db import IntegrityError
 from django.contrib.auth.models import User
 from django.core.mail import send_mass_mail
 from django.db.models import signals, permalink
@@ -183,6 +184,18 @@ class PackageNotification(models.Model):
                 self.package.name)
 
 
+class Vote(models.Model):
+    user = models.ForeignKey(User)
+    package = models.ForeignKey(Package)
+    added = models.DateTimeField(auto_now=True)
+
+    def __unicode__(self):
+        return u"%s's vote for %s" % (self.user.username,
+                self.package.name)
+
+    class Meta:
+        unique_together = (("user", "package"),)
+
 # Should this be here?
 def email_package_updates(sender, instance, signal, *args, **kwargs):
     from django.conf import settings
diff --git a/archlinux/aur/templatetags/aur_tags.py b/archlinux/aur/templatetags/aur_tags.py
index 141a21b..56a6765 100644
--- a/archlinux/aur/templatetags/aur_tags.py
+++ b/archlinux/aur/templatetags/aur_tags.py
@@ -1,7 +1,7 @@
 from django.template import Library
 from django.template.defaultfilters import stringfilter
 from django.contrib.auth.models import User
-from aur.models import Package, PackageNotification
+from aur.models import Package, PackageNotification, Vote
 import re
 
 register = Library()
@@ -15,6 +15,14 @@ def has_update_notification(user, package):
     return total != 0
 
 @register.filter
+def has_vote(user, package):
+    if not isinstance(user, User):
+        return False
+    total = Vote.objects.filter(user=user,
+        package=package).count()
+    return total != 0
+
+ at register.filter
 @stringfilter
 def merge_query_string(url, query_string):
     """Merge two query strings"""
diff --git a/archlinux/aur/tests.py b/archlinux/aur/tests.py
index 0cbe82a..9528a3b 100644
--- a/archlinux/aur/tests.py
+++ b/archlinux/aur/tests.py
@@ -1,3 +1,4 @@
+from datetime import datetime
 from django.test import TestCase
 from django.core.urlresolvers import reverse
 from django.contrib.auth.models import User
@@ -5,7 +6,7 @@ from django.core import mail
 from django.template import Template, Context
 
 from aur.forms import PackageSearchForm
-from aur.models import Package, PackageNotification
+from aur.models import Package, PackageNotification, Vote
 
 class AurTestCase(TestCase):
     fixtures = ['test/users', 'test/packages']
@@ -45,6 +46,43 @@ class AurViewTests(AurTestCase):
         }))
         self.assertEqual(response.status_code, 404)
 
+    def test_vote_view(self):
+        user = User.objects.get(username='normal_user')
+        package = Package.objects.get(name='unique_package')
+        self.client.login(username=user.username, password='normal_user')
+        response = self.client.get(reverse('aur-vote', kwargs={
+            'object_id': package.name,
+        }))
+        self.assertRedirects(response, reverse('aur-package_detail', kwargs={
+            'slug': package.name,
+        }))
+        self.assertEqual(user.vote_set.count(), 1)
+        self.assertEqual(package.vote_set.count(), 1)
+        response = self.client.get(reverse('aur-vote', kwargs={
+            'object_id': 'DoesNotExist',
+        }))
+        self.assertEqual(response.status_code, 404)
+        # Make sure that we didn't count a vote for a nonexistent package...
+        self.assertEqual(user.vote_set.count(), 1)
+
+    def test_unvote_view(self):
+        package = Package.objects.get(name='unique_package')
+        user = User.objects.get(username='normal_user')
+        Vote(package=package, user=user).save()
+        self.client.login(username=user.username, password='normal_user')
+        response = self.client.get(reverse('aur-unvote', kwargs={
+            'object_id': package.name,
+        }))
+        self.assertRedirects(response, reverse('aur-package_detail', kwargs={
+            'slug': package.name,
+        }))
+        self.assertEqual(package.vote_set.count(), 0)
+        self.assertEqual(user.vote_set.count(), 0)
+        response = self.client.get(reverse('aur-unvote', kwargs={
+            'object_id': 'DoesNotExist',
+        }))
+        self.assertEqual(response.status_code, 404)
+
 class AurAPITests(AurTestCase):
     def test_search_view(self):
         response = self.client.get(reverse('aur.views.api_search', kwargs={
@@ -120,3 +158,22 @@ class AurTemplateTagTests(AurTestCase):
         PackageNotification(package=package, user=user).save()
         self.assertEquals(template.render(context).strip(), "True")
 
+    def test_has_vote(self):
+        user = User.objects.get(username='normal_user')
+        package = Package.objects.get(name='unique_package')
+        context = Context({
+            'user': user,
+            'package': package,
+        })
+        template = Template("""
+            {% load aur_tags %}
+            {% if user|has_vote:package %}
+                True
+            {% else %}
+                False
+            {% endif %}
+        """)
+        self.assertEquals(template.render(context).strip(), "False")
+        Vote(package=package, user=user).save()
+        self.assertEquals(template.render(context).strip(), "True")
+
diff --git a/archlinux/aur/urls.py b/archlinux/aur/urls.py
index 4b3a4b4..0bf2067 100644
--- a/archlinux/aur/urls.py
+++ b/archlinux/aur/urls.py
@@ -14,6 +14,10 @@ urlpatterns = patterns('aur.views',
         name='aur-comment_on_package'),
     url(r'^package/(?P<object_id>[\w_-]+)/flag_out_of_date/$',
         'flag_out_of_date', name='aur-flag_out_of_date'),
+    url(r'^package/(?P<object_id>[\w_-]+)/vote/$',
+        'vote', name='aur-vote'),
+    url(r'^package/(?P<object_id>[\w_-]+)/unvote/$',
+        'unvote', name='aur-unvote'),
     url(r'^package/(?P<object_id>[\w_-]+)/notify_of_updates/$',
         'notify_of_updates', name='aur-notify_of_updates'),
     url(r'^package/(?P<object_id>[\w_-]+)/denotify_of_updates/$',
diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
index e6ec7b7..5f379a0 100644
--- a/archlinux/aur/views.py
+++ b/archlinux/aur/views.py
@@ -3,6 +3,7 @@ import os
 import sys
 import tarfile
 import hashlib
+import datetime
 
 from django.shortcuts import render_to_response, get_object_or_404
 from django.http import HttpResponse, HttpResponseRedirect
@@ -12,6 +13,7 @@ from django.contrib.auth.decorators import login_required
 from django.core.urlresolvers import reverse
 from django.core import serializers
 from django.utils.translation import ugettext
+from django.db import IntegrityError
 
 from aur.models import *
 from aur.forms import PackageSearchForm, PackageSubmitForm
@@ -155,6 +157,28 @@ def denotify_of_updates(request, object_id):
     return HttpResponseRedirect(reverse('aur-package_detail',
         args=[object_id,]))
 
+ at login_required
+def vote(request, object_id):
+    """Record a user's vote for a package"""
+    package = get_object_or_404(Package, name=object_id)
+    try:
+        Vote(package=package, user=request.user).save()
+    except IntegrityError: # Ignore the duplicate.  Voter fraud not allowed!
+        pass # Should we complain?
+    return HttpResponseRedirect(reverse('aur-package_detail',
+        args=[object_id,]))
+
+ at login_required
+def unvote(request, object_id):
+    """Remove a user's vote for a package"""
+    package = get_object_or_404(Package, name=object_id)
+    try:
+        Vote.objects.get(package=package, user=request.user).delete()
+    except Vote.DoesNotExist:
+        pass
+    return HttpResponseRedirect(reverse('aur-package_detail',
+        args=[object_id,]))
+
 def api_search(request, query, format):
     results = Package.objects.filter(name__icontains=query)
     data = serializers.serialize(format, results,
diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
index b58f49b..e4516f7 100644
--- a/archlinux/templates/aur/package_detail.html
+++ b/archlinux/templates/aur/package_detail.html
@@ -9,6 +9,12 @@
     <div style="float:right" class="listing">
         <ul class="small">
             <li>
+                {% if user|has_vote:pkg %}
+                <a href="{% url aur-unvote object_id=pkg.name %}">{% trans "Remove my vote" %}</a>
+                {% else %}
+                <a href="{% url aur-vote object_id=pkg.name %}">{% trans "Record my vote for this package" %}</a></li>
+                {% endif %}
+            <li>
                 {% if user|has_update_notification:pkg %}
                 <a href="{% url aur-denotify_of_updates object_id=pkg.name %}">{% trans "Stop notifying me of updates" %}</a>
                 {% else %}
@@ -44,6 +50,9 @@
             <th>{% trans "Maintainer" %}:</th>
             <td>{{ pkg.maintainers.all|join:", " }}</td>
         </tr><tr>
+            <th>{% trans "Votes" %}:</th>
+            <td>{{ pkg.vote_set.count }}</td>
+        </tr><tr>
             <th>{% trans "Last Updated" %}:</th>
             <td>{{ pkg.updated|date:"Y-m-d H:i:s" }}</td>
         </tr><tr>
-- 
1.6.4.4



From cmbrannon79 at gmail.com  Sat Nov 28 22:07:45 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Sat, 28 Nov 2009 15:07:45 -0600
Subject: [aur2-dev] github
Message-ID: <4b1190db.9753f10a.316e.ffff871f@mx.google.com>

After resending all of those, I decided to make a fork on github:
git://github.com/CMB/aur2.git
The patch series I just mailed is in my "pullme" branch.
It's probably easier to just let you pull from there, rather than re-spamming
the list with stuff I've already sent.

-- Chris


From djszapi at archlinux.us  Sat Nov 28 22:19:06 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 22:19:06 +0100
Subject: [aur2-dev] github
In-Reply-To: <4b1190db.9753f10a.316e.ffff871f@mx.google.com>
References: <4b1190db.9753f10a.316e.ffff871f@mx.google.com>
Message-ID: <a362e8010911281319i6e3b2f27gbe8cf256325101f3@mail.gmail.com>

On Sat, Nov 28, 2009 at 10:07 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
> After resending all of those, I decided to make a fork on github:
> git://github.com/CMB/aur2.git
> The patch series I just mailed is in my "pullme" branch.
> It's probably easier to just let you pull from there, rather than re-spamming
> the list with stuff I've already sent.

It's not problem for me, because mutt+git am can handle this situation
very well, so I will use this way.

On Sat, Nov 28, 2009 at 9:14 PM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:

> Add EOF to the end of parsepkgbuild.sh.

> I needed to do this, because the script wouldn't work over here.  Package
> uploading didn't work for me, but now it does.

Some cosmetic changes for committing:

1) Fix package uploading with EOF at the end of parsepkgbuild.sh

Because If someone review this commit (e.g. with git reflog), you
won't see from the first line of the commit what this patch fixed,
just the EOF adding, but (s)he won't know why.

2) It's needed to do, because the script wouldn't work over here.  Package
    uploading didn't work, but now it does.

I prefer passive tenses to i/you/he/she/it/we/you/they.

3) I'd have taken the short error message if you got it to see in
cleaner manner later why the package uploading was problem (there can
be more reason for a problem)

I modified some cosmetic things in this and other patches too in case
of commits, and I applied your patches, thanks your effort really.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Sat Nov 28 22:19:06 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sat, 28 Nov 2009 22:19:06 +0100
Subject: [aur2-dev] github
In-Reply-To: <4b1190db.9753f10a.316e.ffff871f@mx.google.com>
References: <4b1190db.9753f10a.316e.ffff871f@mx.google.com>
Message-ID: <a362e8010911281319i6e3b2f27gbe8cf256325101f3@mail.gmail.com>

On Sat, Nov 28, 2009 at 10:07 PM, Chris Brannon <cmbrannon79 at gmail.com> wrote:
> After resending all of those, I decided to make a fork on github:
> git://github.com/CMB/aur2.git
> The patch series I just mailed is in my "pullme" branch.
> It's probably easier to just let you pull from there, rather than re-spamming
> the list with stuff I've already sent.

It's not problem for me, because mutt+git am can handle this situation
very well, so I will use this way.

On Sat, Nov 28, 2009 at 9:14 PM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:

> Add EOF to the end of parsepkgbuild.sh.

> I needed to do this, because the script wouldn't work over here.  Package
> uploading didn't work for me, but now it does.

Some cosmetic changes for committing:

1) Fix package uploading with EOF at the end of parsepkgbuild.sh

Because If someone review this commit (e.g. with git reflog), you
won't see from the first line of the commit what this patch fixed,
just the EOF adding, but (s)he won't know why.

2) It's needed to do, because the script wouldn't work over here.  Package
    uploading didn't work, but now it does.

I prefer passive tenses to i/you/he/she/it/we/you/they.

3) I'd have taken the short error message if you got it to see in
cleaner manner later why the package uploading was problem (there can
be more reason for a problem)

I modified some cosmetic things in this and other patches too in case
of commits, and I applied your patches, thanks your effort really.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Sat Nov 28 22:25:21 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Sat, 28 Nov 2009 22:25:21 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 4195ceb53e6ed852e339a582a76949ae2368c4c5
Message-ID: <200911282125.nASLPLxY011200@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  4195ceb53e6ed852e339a582a76949ae2368c4c5 (commit)
       via  fe6e516241c2ca72afd2427617d0b89cec2fb0a6 (commit)
       via  c3651e374b28edcfa2096f63c65f8bdced780ed3 (commit)
       via  2b99c50afa0c176df50cbbfb16784f4c50571bb7 (commit)
       via  b3791f8da474002480a053d8c52f75d0617a7347 (commit)
       via  f2b95d080ed438985b1b4ff2f54897fff2bf641a (commit)
      from  a73808e21190571c5a50e0e2847a6bd9cea5d910 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 4195ceb53e6ed852e339a582a76949ae2368c4c5
Author: Christopher Brannon <cmbrannon79 at gmail.com>
Date:   Sat Nov 28 14:20:00 2009 -0600

    Add voting for packages.
    
    A Vote object records the fact that a given user voted for a certain
    package at a known time.
    Voting and unvoting are implemented.  Also, the details page for a package
    shows the number of votes that it has received.
    
    Per discussions on the mailing list, the DateTime field is declared with
    auto_now_add=True, so we don't have to save timestamps manually on creation of votes.
    
    This patch incorporates the following changes by Ismael Carnales:
    1. Use get_package_or_404 in unvote, from views.py.  Trying to remove
    a vote for a non-existent package should produce a 404 HTTP response.
    2. The timestamp in the Vote class should be named "added" for consistency,
    rather than "when", which was the name used in the original patch.
    
    Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit fe6e516241c2ca72afd2427617d0b89cec2fb0a6
Author: Christopher Brannon <cmbrannon79 at gmail.com>
Date:   Sat Nov 28 14:17:46 2009 -0600

    Remove an unneeded call to os.path.join in PackageSubmitForm
    
    The call had one argument, so it was a no-op.
    
    Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit c3651e374b28edcfa2096f63c65f8bdced780ed3
Author: Christopher Brannon <cmbrannon79 at gmail.com>
Date:   Sat Nov 28 14:16:08 2009 -0600

    Remove a missplaced word from the middle of package_detail template.
    
    The word "ah" was in the middle of the package details template,
    and it doesn't belong to there, it's the result of a missplacing.
    
    Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 2b99c50afa0c176df50cbbfb16784f4c50571bb7
Author: Christopher Brannon <cmbrannon79 at gmail.com>
Date:   Sat Nov 28 14:14:23 2009 -0600

    Fix package uploading with EOF at the end of parsepkgbuild.sh.
    
    It's needed to do, because the script wouldn't work over here.  Package
    uploading didn't work, but now it does.
    
    Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit b3791f8da474002480a053d8c52f75d0617a7347
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 28 20:06:22 2009 +0100

    Refactor AurRegistrationForm subclass
    
    This modification was needed because of the django-registration updating to
    >=0.8 version now.
    
    Implementation details:
    
    * Change for 'form_class': aur.forms.AurRegistrationForm in the urls.py again
    
    * Change the main class of AurRegistrationForm from RegistrationForm to
    RegistrationFormUniqueEmail to keep the unique email handling facility.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit f2b95d080ed438985b1b4ff2f54897fff2bf641a
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sat Nov 28 14:58:41 2009 +0100

    Remove the plain PKGBUILD upload feature.
    
    makepkg --source should be used to upload packages. It provides a bit of error
    checking and it's good to support only a single format here.
    
    Keeping consistent with the current AUR in this regard.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 archlinux/aur/Package/parsepkgbuild.sh      |    1 +
 archlinux/aur/Package/pkgbuild.py           |    3 +-
 archlinux/aur/forms.py                      |    6 +-
 archlinux/aur/models.py                     |   13 ++++++
 archlinux/aur/templatetags/aur_tags.py      |   10 ++++-
 archlinux/aur/tests.py                      |   59 ++++++++++++++++++++++++++-
 archlinux/aur/urls.py                       |    4 ++
 archlinux/aur/views.py                      |   24 +++++++++++
 archlinux/templates/aur/package_detail.html |   11 +++++-
 archlinux/urls.py                           |    3 +-
 pip-requirements.txt                        |    2 +-
 11 files changed, 125 insertions(+), 11 deletions(-)


hooks/post-receive
-- 
Project aur2 at BerliOS


From icarnales at gmail.com  Sat Nov 28 23:28:50 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 20:28:50 -0200
Subject: [aur2-dev] [PATCH 4/4] Add voting for packages.
In-Reply-To: <4b118a35.9653f10a.0843.ffff89a2@mx.google.com>
References: <4b118a35.9653f10a.0843.ffff89a2@mx.google.com>
Message-ID: <d83f7a8d0911281428p237e23cegd8ce83ccd75b7065@mail.gmail.com>

On Sat, Nov 28, 2009 at 6:20 PM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:
> A Vote object records the fact that a given user voted for a certain
> package at a known time.
> Voting and unvoting are implemented. ?Also, the details page for a package
> shows the number of votes that it has received.
>
> Per discussions on the mailing list, the DateTime field is declared with
> auto_now_add=True, so we don't have to save timestamps manually on creation of votes.
>
> This patch incorporates the following changes by Ismael Carnales:
> 1. Use get_package_or_404 in unvote, from views.py. ?Trying to remove
> a vote for a non-existent package should produce a 404 HTTP response.
> 2. The timestamp in the Vote class should be named "added" for consistency,
> rather than "when", which was the name used in the original patch.
>
> Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
> ---
> ?archlinux/aur/models.py ? ? ? ? ? ? ? ? ? ? | ? 13 ++++++
> ?archlinux/aur/templatetags/aur_tags.py ? ? ?| ? 10 ++++-
> ?archlinux/aur/tests.py ? ? ? ? ? ? ? ? ? ? ?| ? 59 ++++++++++++++++++++++++++-
> ?archlinux/aur/urls.py ? ? ? ? ? ? ? ? ? ? ? | ? ?4 ++
> ?archlinux/aur/views.py ? ? ? ? ? ? ? ? ? ? ?| ? 24 +++++++++++
> ?archlinux/templates/aur/package_detail.html | ? ?9 ++++
> ?6 files changed, 117 insertions(+), 2 deletions(-)
>
> diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
> index 6bc7a85..f399200 100644
> --- a/archlinux/aur/models.py
> +++ b/archlinux/aur/models.py
> @@ -1,5 +1,6 @@
> ?from django.db import models
> ?from django.db import transaction
> +from django.db import IntegrityError
> ?from django.contrib.auth.models import User
> ?from django.core.mail import send_mass_mail
> ?from django.db.models import signals, permalink
> @@ -183,6 +184,18 @@ class PackageNotification(models.Model):
> ? ? ? ? ? ? ? ? self.package.name)
>
>
> +class Vote(models.Model):
> + ? ?user = models.ForeignKey(User)
> + ? ?package = models.ForeignKey(Package)
> + ? ?added = models.DateTimeField(auto_now=True)
> +
> + ? ?def __unicode__(self):
> + ? ? ? ?return u"%s's vote for %s" % (self.user.username,
> + ? ? ? ? ? ? ? ?self.package.name)
> +
> + ? ?class Meta:
> + ? ? ? ?unique_together = (("user", "package"),)
> +
> ?# Should this be here?
> ?def email_package_updates(sender, instance, signal, *args, **kwargs):
> ? ? from django.conf import settings
> diff --git a/archlinux/aur/templatetags/aur_tags.py b/archlinux/aur/templatetags/aur_tags.py
> index 141a21b..56a6765 100644
> --- a/archlinux/aur/templatetags/aur_tags.py
> +++ b/archlinux/aur/templatetags/aur_tags.py
> @@ -1,7 +1,7 @@
> ?from django.template import Library
> ?from django.template.defaultfilters import stringfilter
> ?from django.contrib.auth.models import User
> -from aur.models import Package, PackageNotification
> +from aur.models import Package, PackageNotification, Vote
> ?import re
>
> ?register = Library()
> @@ -15,6 +15,14 @@ def has_update_notification(user, package):
> ? ? return total != 0
>
> ?@register.filter
> +def has_vote(user, package):
> + ? ?if not isinstance(user, User):
> + ? ? ? ?return False
> + ? ?total = Vote.objects.filter(user=user,
> + ? ? ? ?package=package).count()
> + ? ?return total != 0
> +
> + at register.filter
> ?@stringfilter
> ?def merge_query_string(url, query_string):
> ? ? """Merge two query strings"""
> diff --git a/archlinux/aur/tests.py b/archlinux/aur/tests.py
> index 0cbe82a..9528a3b 100644
> --- a/archlinux/aur/tests.py
> +++ b/archlinux/aur/tests.py
> @@ -1,3 +1,4 @@
> +from datetime import datetime
> ?from django.test import TestCase
> ?from django.core.urlresolvers import reverse
> ?from django.contrib.auth.models import User
> @@ -5,7 +6,7 @@ from django.core import mail
> ?from django.template import Template, Context
>
> ?from aur.forms import PackageSearchForm
> -from aur.models import Package, PackageNotification
> +from aur.models import Package, PackageNotification, Vote
>
> ?class AurTestCase(TestCase):
> ? ? fixtures = ['test/users', 'test/packages']
> @@ -45,6 +46,43 @@ class AurViewTests(AurTestCase):
> ? ? ? ? }))
> ? ? ? ? self.assertEqual(response.status_code, 404)
>
> + ? ?def test_vote_view(self):
> + ? ? ? ?user = User.objects.get(username='normal_user')
> + ? ? ? ?package = Package.objects.get(name='unique_package')
> + ? ? ? ?self.client.login(username=user.username, password='normal_user')
> + ? ? ? ?response = self.client.get(reverse('aur-vote', kwargs={
> + ? ? ? ? ? ?'object_id': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertRedirects(response, reverse('aur-package_detail', kwargs={
> + ? ? ? ? ? ?'slug': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(user.vote_set.count(), 1)
> + ? ? ? ?self.assertEqual(package.vote_set.count(), 1)
> + ? ? ? ?response = self.client.get(reverse('aur-vote', kwargs={
> + ? ? ? ? ? ?'object_id': 'DoesNotExist',
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(response.status_code, 404)
> + ? ? ? ?# Make sure that we didn't count a vote for a nonexistent package...
> + ? ? ? ?self.assertEqual(user.vote_set.count(), 1)
> +
> + ? ?def test_unvote_view(self):
> + ? ? ? ?package = Package.objects.get(name='unique_package')
> + ? ? ? ?user = User.objects.get(username='normal_user')
> + ? ? ? ?Vote(package=package, user=user).save()
> + ? ? ? ?self.client.login(username=user.username, password='normal_user')
> + ? ? ? ?response = self.client.get(reverse('aur-unvote', kwargs={
> + ? ? ? ? ? ?'object_id': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertRedirects(response, reverse('aur-package_detail', kwargs={
> + ? ? ? ? ? ?'slug': package.name,
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(package.vote_set.count(), 0)
> + ? ? ? ?self.assertEqual(user.vote_set.count(), 0)
> + ? ? ? ?response = self.client.get(reverse('aur-unvote', kwargs={
> + ? ? ? ? ? ?'object_id': 'DoesNotExist',
> + ? ? ? ?}))
> + ? ? ? ?self.assertEqual(response.status_code, 404)
> +
> ?class AurAPITests(AurTestCase):
> ? ? def test_search_view(self):
> ? ? ? ? response = self.client.get(reverse('aur.views.api_search', kwargs={
> @@ -120,3 +158,22 @@ class AurTemplateTagTests(AurTestCase):
> ? ? ? ? PackageNotification(package=package, user=user).save()
> ? ? ? ? self.assertEquals(template.render(context).strip(), "True")
>
> + ? ?def test_has_vote(self):
> + ? ? ? ?user = User.objects.get(username='normal_user')
> + ? ? ? ?package = Package.objects.get(name='unique_package')
> + ? ? ? ?context = Context({
> + ? ? ? ? ? ?'user': user,
> + ? ? ? ? ? ?'package': package,
> + ? ? ? ?})
> + ? ? ? ?template = Template("""
> + ? ? ? ? ? ?{% load aur_tags %}
> + ? ? ? ? ? ?{% if user|has_vote:package %}
> + ? ? ? ? ? ? ? ?True
> + ? ? ? ? ? ?{% else %}
> + ? ? ? ? ? ? ? ?False
> + ? ? ? ? ? ?{% endif %}
> + ? ? ? ?""")
> + ? ? ? ?self.assertEquals(template.render(context).strip(), "False")
> + ? ? ? ?Vote(package=package, user=user).save()
> + ? ? ? ?self.assertEquals(template.render(context).strip(), "True")
> +
> diff --git a/archlinux/aur/urls.py b/archlinux/aur/urls.py
> index 4b3a4b4..0bf2067 100644
> --- a/archlinux/aur/urls.py
> +++ b/archlinux/aur/urls.py
> @@ -14,6 +14,10 @@ urlpatterns = patterns('aur.views',
> ? ? ? ? name='aur-comment_on_package'),
> ? ? url(r'^package/(?P<object_id>[\w_-]+)/flag_out_of_date/$',
> ? ? ? ? 'flag_out_of_date', name='aur-flag_out_of_date'),
> + ? ?url(r'^package/(?P<object_id>[\w_-]+)/vote/$',
> + ? ? ? ?'vote', name='aur-vote'),
> + ? ?url(r'^package/(?P<object_id>[\w_-]+)/unvote/$',
> + ? ? ? ?'unvote', name='aur-unvote'),
> ? ? url(r'^package/(?P<object_id>[\w_-]+)/notify_of_updates/$',
> ? ? ? ? 'notify_of_updates', name='aur-notify_of_updates'),
> ? ? url(r'^package/(?P<object_id>[\w_-]+)/denotify_of_updates/$',
> diff --git a/archlinux/aur/views.py b/archlinux/aur/views.py
> index e6ec7b7..5f379a0 100644
> --- a/archlinux/aur/views.py
> +++ b/archlinux/aur/views.py
> @@ -3,6 +3,7 @@ import os
> ?import sys
> ?import tarfile
> ?import hashlib
> +import datetime
>
> ?from django.shortcuts import render_to_response, get_object_or_404
> ?from django.http import HttpResponse, HttpResponseRedirect
> @@ -12,6 +13,7 @@ from django.contrib.auth.decorators import login_required
> ?from django.core.urlresolvers import reverse
> ?from django.core import serializers
> ?from django.utils.translation import ugettext
> +from django.db import IntegrityError
>
> ?from aur.models import *
> ?from aur.forms import PackageSearchForm, PackageSubmitForm
> @@ -155,6 +157,28 @@ def denotify_of_updates(request, object_id):
> ? ? return HttpResponseRedirect(reverse('aur-package_detail',
> ? ? ? ? args=[object_id,]))
>
> + at login_required
> +def vote(request, object_id):
> + ? ?"""Record a user's vote for a package"""
> + ? ?package = get_object_or_404(Package, name=object_id)
> + ? ?try:
> + ? ? ? ?Vote(package=package, user=request.user).save()
> + ? ?except IntegrityError: # Ignore the duplicate. ?Voter fraud not allowed!
> + ? ? ? ?pass # Should we complain?
> + ? ?return HttpResponseRedirect(reverse('aur-package_detail',
> + ? ? ? ?args=[object_id,]))
> +
> + at login_required
> +def unvote(request, object_id):
> + ? ?"""Remove a user's vote for a package"""
> + ? ?package = get_object_or_404(Package, name=object_id)
> + ? ?try:
> + ? ? ? ?Vote.objects.get(package=package, user=request.user).delete()
> + ? ?except Vote.DoesNotExist:
> + ? ? ? ?pass
> + ? ?return HttpResponseRedirect(reverse('aur-package_detail',
> + ? ? ? ?args=[object_id,]))
> +
> ?def api_search(request, query, format):
> ? ? results = Package.objects.filter(name__icontains=query)
> ? ? data = serializers.serialize(format, results,
> diff --git a/archlinux/templates/aur/package_detail.html b/archlinux/templates/aur/package_detail.html
> index b58f49b..e4516f7 100644
> --- a/archlinux/templates/aur/package_detail.html
> +++ b/archlinux/templates/aur/package_detail.html
> @@ -9,6 +9,12 @@
> ? ? <div style="float:right" class="listing">
> ? ? ? ? <ul class="small">
> ? ? ? ? ? ? <li>
> + ? ? ? ? ? ? ? ?{% if user|has_vote:pkg %}
> + ? ? ? ? ? ? ? ?<a href="{% url aur-unvote object_id=pkg.name %}">{% trans "Remove my vote" %}</a>
> + ? ? ? ? ? ? ? ?{% else %}
> + ? ? ? ? ? ? ? ?<a href="{% url aur-vote object_id=pkg.name %}">{% trans "Record my vote for this package" %}</a></li>
> + ? ? ? ? ? ? ? ?{% endif %}
> + ? ? ? ? ? ?<li>
> ? ? ? ? ? ? ? ? {% if user|has_update_notification:pkg %}
> ? ? ? ? ? ? ? ? <a href="{% url aur-denotify_of_updates object_id=pkg.name %}">{% trans "Stop notifying me of updates" %}</a>
> ? ? ? ? ? ? ? ? {% else %}
> @@ -44,6 +50,9 @@
> ? ? ? ? ? ? <th>{% trans "Maintainer" %}:</th>
> ? ? ? ? ? ? <td>{{ pkg.maintainers.all|join:", " }}</td>
> ? ? ? ? </tr><tr>
> + ? ? ? ? ? ?<th>{% trans "Votes" %}:</th>
> + ? ? ? ? ? ?<td>{{ pkg.vote_set.count }}</td>
> + ? ? ? ?</tr><tr>
> ? ? ? ? ? ? <th>{% trans "Last Updated" %}:</th>
> ? ? ? ? ? ? <td>{{ pkg.updated|date:"Y-m-d H:i:s" }}</td>
> ? ? ? ? </tr><tr>
> --
> 1.6.4.4
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

Chris, somehow in the remaking of the patches the added field ended
with auto_now=True instead of auto_now_add=True :(.

I see this patch is already pushed to upstream, maybe you can send
another amending this issue.

bye!


From icarnales at gmail.com  Sat Nov 28 23:50:37 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sat, 28 Nov 2009 20:50:37 -0200
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 	4195ceb53e6ed852e339a582a76949ae2368c4c5
In-Reply-To: <200911282125.nASLPLxY011200@sheep.berlios.de>
References: <200911282125.nASLPLxY011200@sheep.berlios.de>
Message-ID: <d83f7a8d0911281450p3a7dc50dh720778054c247557@mail.gmail.com>

> commit f2b95d080ed438985b1b4ff2f54897fff2bf641a
> Author: Laszlo Papp <djszapi at archlinux.us>
> Date: ? Sat Nov 28 14:58:41 2009 +0100
>
> ? ?Remove the plain PKGBUILD upload feature.
>
> ? ?makepkg --source should be used to upload packages. It provides a bit of error
> ? ?checking and it's good to support only a single format here.
>
> ? ?Keeping consistent with the current AUR in this regard.
>
> ? ?Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

The plain PKGBUILD uploading logic is all over the place on the
aur/forms.py file in the Package form and the PackageField, maybe you
forgot to add that file to the commit.

bye!


From sebnow at gmail.com  Sun Nov 29 02:12:33 2009
From: sebnow at gmail.com (Sebastian Nowicki)
Date: Sun, 29 Nov 2009 09:12:33 +0800
Subject: [aur2-dev] [PATCH] Fix added date on Package and Comment models
In-Reply-To: <d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>
References: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
	<d83f7a8d0911280850r768685devcc9456da1958b976@mail.gmail.com>
Message-ID: <85CDEF04-F7E9-4B73-8CD9-A124BFA1F89D@gmail.com>

On Nov 29, 2009, at 12:50 AM, Ismael Carnales wrote:

> Sorry for asking, but someone cares to comment on this patch?
> Currently the "added" date of the Comment model for example is totally
> broken, I think we must fixit, with this implementation (not my
> preferred as I commented earlier) or with other.

Actually if we get rid of the call to datetime.now() (and just  
reference the function) it will work. This method of doing it (using  
default, and setting the updated date on save()) is more flexible, as  
it doesn't set the times in stone. If everyone's happy with the patch  
though, we'll just use it.

> This is other thing I don't like much about the patch-sending
> workflow, is easy for patches to get lost in tons of mails. Darcs has
> a nice feature called darcswatch for keep track of patches:
> http://darcs.nomeata.de/darcswatch/documentation.html do you know if
> something like this exists for git?

I'm not familiar with neither darcswatch, nor stgit, but perhaps stgit  
(stacked git) is what you're looking for.

http://procode.org/stgit/



From cmbrannon79 at gmail.com  Sun Nov 29 02:45:12 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Sat, 28 Nov 2009 19:45:12 -0600
Subject: [aur2-dev] [PATCH] Fix a typo: auto_now should've been auto_now_add.
Message-ID: <4b11d780.9753f10a.316e.ffff900e@mx.google.com>

It's an easy mistake to make, and it's trivial to fix.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/aur/models.py |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
index f399200..2a1a81e 100644
--- a/archlinux/aur/models.py
+++ b/archlinux/aur/models.py
@@ -187,7 +187,7 @@ class PackageNotification(models.Model):
 class Vote(models.Model):
     user = models.ForeignKey(User)
     package = models.ForeignKey(Package)
-    added = models.DateTimeField(auto_now=True)
+    added = models.DateTimeField(auto_now_add=True)
 
     def __unicode__(self):
         return u"%s's vote for %s" % (self.user.username,
-- 
1.6.4.4



From djszapi at archlinux.us  Sun Nov 29 03:35:12 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sun, 29 Nov 2009 03:35:12 +0100
Subject: [aur2-dev] [PATCH] Fix a typo: auto_now should've been
	auto_now_add.
In-Reply-To: <4b11d780.9753f10a.316e.ffff900e@mx.google.com>
References: <4b11d780.9753f10a.316e.ffff900e@mx.google.com>
Message-ID: <a362e8010911281835p7cca6b1xa1bd2e8647af8f32@mail.gmail.com>

On Sun, Nov 29, 2009 at 2:45 AM, Christopher Brannon
<cmbrannon79 at gmail.com> wrote:
> It's an easy mistake to make, and it's trivial to fix.
>
> Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
> ---
> ?archlinux/aur/models.py | ? ?2 +-
> ?1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
> index f399200..2a1a81e 100644
> --- a/archlinux/aur/models.py
> +++ b/archlinux/aur/models.py
> @@ -187,7 +187,7 @@ class PackageNotification(models.Model):
> ?class Vote(models.Model):
> ? ? user = models.ForeignKey(User)
> ? ? package = models.ForeignKey(Package)
> - ? ?added = models.DateTimeField(auto_now=True)
> + ? ?added = models.DateTimeField(auto_now_add=True)
>
> ? ? def __unicode__(self):
> ? ? ? ? return u"%s's vote for %s" % (self.user.username,
> --
> 1.6.4.4
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

ACK, thanks.

Best Regards,
Laszlo Papp


From djszapi at archlinux.us  Sun Nov 29 16:50:43 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Sun, 29 Nov 2009 16:50:43 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 315e7f52ee72fff6953c90236c43a207a91ff4b6
Message-ID: <200911291550.nATFoh41003243@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  315e7f52ee72fff6953c90236c43a207a91ff4b6 (commit)
       via  4ccf7bbd94c3a9e66cef6a24b98192ef9b86d1f0 (commit)
       via  b5aa1dafb9adfbb5b387635b37f465884df44e9b (commit)
       via  6729570467d0c967ebe861894cb4484a90e4eae5 (commit)
       via  1595ca239546bd29fcd2a5f9cd80ba4e0a32cb6c (commit)
       via  7345c45e7fe38427f2f3a0b597ccac27cb118f12 (commit)
       via  2d75b4171df34428fa9c6504988724f8d9edfa82 (commit)
       via  36754bb53f8f79f80e1667982d3a379808b61e97 (commit)
       via  5d1ae7b0f2c57d7ad70594a85bac036826a15401 (commit)
       via  e12e506342352f56f2b0c61860078d02db2337fa (commit)
      from  4195ceb53e6ed852e339a582a76949ae2368c4c5 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 315e7f52ee72fff6953c90236c43a207a91ff4b6
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 16:46:49 2009 +0100

    Add a better design(css) to the registration form page
    
    These modifications were needed because the design was a bit ugly after the
    table removing.
    
    The implementation touched the following snippets:
    
    * Labels, input fields design were changed
    * Registration form was identified
    * Registration form label was added to the design
    * Registration submit button was added to the design
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 4ccf7bbd94c3a9e66cef6a24b98192ef9b86d1f0
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 16:09:51 2009 +0100

    Add a better design(css) to the login page
    
    These modifications were needed because the design was a bit ugly after the
    table removing.
    
    The implementation touched the following snippets:
    
    * Labels, input fields design were changed
    * greybox div was redesigned
    * The login submit button was identified
    * h2.title font size was changed
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit b5aa1dafb9adfbb5b387635b37f465884df44e9b
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 16:01:16 2009 +0100

    Fix the activation session of new accounts
    
    template/registration/activation_complete.html file was added since the
    activation session required it to exist.
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 6729570467d0c967ebe861894cb4484a90e4eae5
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 13:57:44 2009 +0100

    Delete the table from the template registration form
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 1595ca239546bd29fcd2a5f9cd80ba4e0a32cb6c
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 13:49:48 2009 +0100

    Delete the table from the template login form
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 7345c45e7fe38427f2f3a0b597ccac27cb118f12
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 13:24:58 2009 +0100

    Implement Password Reseting option
    
    The builtin password_reset django feature was used for it.
    
    New line was added in the login form/table, templates/registration/login.html to
    handle this option. This line(tr) was added after the login line in this table
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 2d75b4171df34428fa9c6504988724f8d9edfa82
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 10:16:10 2009 +0100

    Implement Unflag feature on the Package Details page
    
    It was needed, because until this time only the Flag out-of-date option was
    available there, and it could be solved without any plus line adding in the
    Package Details page.
    
    The implementation touched the following items:
    * Implement unflag_out_of_date function in the aur/views.py
    * Add the desired link for this operation in the aur/urls.py
    * Modify the string for the relevant link in the package_detail.html template
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 36754bb53f8f79f80e1667982d3a379808b61e97
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 06:12:54 2009 +0100

    Change for 'With selected package(s):' in the profile and aur too
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit 5d1ae7b0f2c57d7ad70594a85bac036826a15401
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 05:50:50 2009 +0100

    Change the 'Go' button for 'Apply' in the profile
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit e12e506342352f56f2b0c61860078d02db2337fa
Author: Christopher Brannon <cmbrannon79 at gmail.com>
Date:   Sat Nov 28 19:45:12 2009 -0600

    Fix a typo: auto_now should've been auto_now_add.
    
    It's an easy mistake to make, and it's trivial to fix.
    
    Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 archlinux/aur/models.py                            |    2 +-
 archlinux/aur/urls.py                              |    2 +
 archlinux/aur/views.py                             |    6 +++
 archlinux/media/css/arch.css                       |   18 ++++++++++
 archlinux/templates/aur/package_detail.html        |    2 +-
 archlinux/templates/aur/search.html                |    4 +-
 archlinux/templates/aurprofile/profile.html        |    2 +-
 ...tion_complete.html => activation_complete.html} |    5 ++-
 archlinux/templates/registration/login.html        |   34 ++++++++++---------
 .../templates/registration/registration_form.html  |   23 +++++++------
 10 files changed, 64 insertions(+), 34 deletions(-)
 copy archlinux/templates/registration/{registration_complete.html => activation_complete.html} (58%)


hooks/post-receive
-- 
Project aur2 at BerliOS


From icarnales at gmail.com  Sun Nov 29 19:40:08 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sun, 29 Nov 2009 16:40:08 -0200
Subject: [aur2-dev] [PATCH] Fix requirement for django-registration
Message-ID: <4b12c11e.47c2f10a.687c.2723@mx.google.com>

From: Ismael Carnales <icarnales at gmail.com>

As django-registration 0.8 is not released yet, the hg repository must
be used. Added it to pip-requirements file.

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 pip-requirements.txt |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/pip-requirements.txt b/pip-requirements.txt
index 3a9f9d0..d11da85 100644
--- a/pip-requirements.txt
+++ b/pip-requirements.txt
@@ -1,3 +1,3 @@
 Django>=1.0
-django-registration>=0.8
+-e hg+http://bitbucket.org/ubernostrum/django-registration/#egg=django-registration
 -e svn+http://django-tagging.googlecode.com/svn/trunk/#egg=tagging
-- 
1.6.5.2



From icarnales at gmail.com  Sun Nov 29 19:43:12 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sun, 29 Nov 2009 16:43:12 -0200
Subject: [aur2-dev] [PATCH] Save added and updated date of models in save
	method
In-Reply-To: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
References: <4b101d07.47c2f10a.64fe.ffffde10@mx.google.com>
Message-ID: <4b12c1f4.47c1f10a.34a3.26f7@mx.google.com>

From: Ismael Carnales <icarnales at gmail.com>

* The added datetime for Packages and Comments was getting set in the
default value (always the datetime from server start), now using the
model save method for this.
* Also use save method for setting added on Vote model for consistency.

Signed-off-by: Ismael Carnales <icarnales at gmail.com>
---
 archlinux/aur/models.py |   24 +++++++++++++++++++-----
 1 files changed, 19 insertions(+), 5 deletions(-)

diff --git a/archlinux/aur/models.py b/archlinux/aur/models.py
index 2a1a81e..1ba3e09 100644
--- a/archlinux/aur/models.py
+++ b/archlinux/aur/models.py
@@ -95,8 +95,8 @@ class Package(models.Model):
     provides = models.ManyToManyField(Provision, null=True, blank=True)
     deleted = models.BooleanField(default=False)
     outdated = models.BooleanField(default=False)
-    added = models.DateTimeField(editable=False, default=datetime.now())
-    updated = models.DateTimeField()
+    added = models.DateTimeField(editable=False)
+    updated = models.DateTimeField(editable=False)
     groups = models.ManyToManyField(Group, null=True, blank=True)
 
     def __unicode__(self):
@@ -115,12 +115,16 @@ class Package(models.Model):
     get_absolute_url = permalink(get_absolute_url)
 
     def save(self):
-        self.updated = datetime.now()
+        if not self.id:
+            self.added = datetime.now()
+
         if not self.slug:
             import re
             slug = re.sub('[^\w\s-]', '', self.name).strip().lower()
             slug = re.sub('[-\s]+', '-', slug)
             self.slug = slug
+
+        self.updated = datetime.now()
         super(Package, self).save()
 
     class Meta:
@@ -167,13 +171,18 @@ class Comment(models.Model):
     parent = models.ForeignKey('self', null=True, blank=True)
     user = models.ForeignKey(User)
     message = models.TextField()
-    added = models.DateTimeField(editable=False, default=datetime.now())
+    added = models.DateTimeField(editable=False)
     ip = models.IPAddressField()
     hidden = models.BooleanField(default=False)
 
     def __unicode__(self):
         return self.message
 
+    def save(self):
+        if not self.id:
+            self.added = datetime.now()
+        super(Comment, self).save()
+
 
 class PackageNotification(models.Model):
     user = models.ForeignKey(User)
@@ -187,12 +196,17 @@ class PackageNotification(models.Model):
 class Vote(models.Model):
     user = models.ForeignKey(User)
     package = models.ForeignKey(Package)
-    added = models.DateTimeField(auto_now_add=True)
+    added = models.DateTimeField(editable=False)
 
     def __unicode__(self):
         return u"%s's vote for %s" % (self.user.username,
                 self.package.name)
 
+    def save(self):
+        if not self.id:
+            self.added = datetime.now()
+        super(Vote, self).save()
+
     class Meta:
         unique_together = (("user", "package"),)
 
-- 

This is the style I prefer using for autosaving model creation and update
dates. It makes all the code visible in the save method so the logic is not
scattered in many places.


From djszapi at archlinux.us  Sun Nov 29 21:44:30 2009
From: djszapi at archlinux.us (djszapi at archlinux.us)
Date: Sun, 29 Nov 2009 21:44:30 +0100
Subject: [aur2-dev] [Git]Project aur2 at BerliOS branch, master,
	updated. 2b44a1265c789da7cf767349a946f4cdc1269bf6
Message-ID: <200911292044.nATKiU93007473@sheep.berlios.de>

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project "Project aur2 at BerliOS".

The branch, master has been updated
       via  2b44a1265c789da7cf767349a946f4cdc1269bf6 (commit)
       via  c5520a2a6c9a6db43e540b819cf77bc3afb26a4d (commit)
      from  315e7f52ee72fff6953c90236c43a207a91ff4b6 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 2b44a1265c789da7cf767349a946f4cdc1269bf6
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 19:22:52 2009 +0100

    Change the activation handling during registration
    
    This modification was needed because the activate/activation_complete handling
    was changed, so it was needed to split the older activate.html for two separate
    activation related templates.
    
    activate.html is called at this momment when some error happened during
    activation  either your activation link was incorrect, or the activation key for
    your account has expired. So looking the view more account will never evaluate to
    True in activate.html.
    
    activation_complete.html is called when the activation was successful.
    
    Summary: registration/activation.html is rendered if not valid,
    registration/activation_complete.html is rendered if valid
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

commit c5520a2a6c9a6db43e540b819cf77bc3afb26a4d
Author: Laszlo Papp <djszapi at archlinux.us>
Date:   Sun Nov 29 17:14:26 2009 +0100

    Change the 'Go' button for 'Apply' in the aurprofile too
    
    Signed-off-by: Laszlo Papp <djszapi at archlinux.us>

-----------------------------------------------------------------------

Summary of changes:
 archlinux/templates/aurprofile/profile.html        |    2 +-
 archlinux/templates/registration/activate.html     |    5 -----
 .../registration/activation_complete.html          |    8 ++++----
 3 files changed, 5 insertions(+), 10 deletions(-)


hooks/post-receive
-- 
Project aur2 at BerliOS


From djszapi at archlinux.us  Sun Nov 29 21:52:00 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Sun, 29 Nov 2009 21:52:00 +0100
Subject: [aur2-dev] [PATCH] Fix requirement for django-registration
In-Reply-To: <4b12c11e.47c2f10a.687c.2723@mx.google.com>
References: <4b12c11e.47c2f10a.687c.2723@mx.google.com>
Message-ID: <a362e8010911291252w209fc003ka7edd456b53b6052@mail.gmail.com>

On Sun, Nov 29, 2009 at 7:40 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> From: Ismael Carnales <icarnales at gmail.com>
>
> As django-registration 0.8 is not released yet, the hg repository must
> be used. Added it to pip-requirements file.
>
> Signed-off-by: Ismael Carnales <icarnales at gmail.com>
> ---
> ?pip-requirements.txt | ? ?2 +-
> ?1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/pip-requirements.txt b/pip-requirements.txt
> index 3a9f9d0..d11da85 100644
> --- a/pip-requirements.txt
> +++ b/pip-requirements.txt
> @@ -1,3 +1,3 @@
> ?Django>=1.0
> -django-registration>=0.8
> +-e hg+http://bitbucket.org/ubernostrum/django-registration/#egg=django-registration
> ?-e svn+http://django-tagging.googlecode.com/svn/trunk/#egg=tagging

NACK, no need to involve django-registration from hg, if the release
is provided on their site(available from AUR too), and works fine.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Sun Nov 29 23:32:19 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sun, 29 Nov 2009 20:32:19 -0200
Subject: [aur2-dev] [PATCH] Fix requirement for django-registration
In-Reply-To: <a362e8010911291252w209fc003ka7edd456b53b6052@mail.gmail.com>
References: <4b12c11e.47c2f10a.687c.2723@mx.google.com>
	<a362e8010911291252w209fc003ka7edd456b53b6052@mail.gmail.com>
Message-ID: <d83f7a8d0911291432l2fe7f045n786cc04eef5bb768@mail.gmail.com>

>
> NACK, no need to involve django-registration from hg, if the release
> is provided on their site(available from AUR too), and works fine.
>

Currently, the 0.8alpha1 release is only available as a tarball on the
site, but is not available bas a pip installable (or easy_installable)
package, so we must use the hg version by now, have you tried your
modified pip-install.txt file???


From icarnales at gmail.com  Sun Nov 29 23:54:07 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Sun, 29 Nov 2009 20:54:07 -0200
Subject: [aur2-dev] [PATCH] Remove single PKGBUILD uploading from aur forms
In-Reply-To: <d83f7a8d0911281450p3a7dc50dh720778054c247557@mail.gmail.com>
References: <d83f7a8d0911281450p3a7dc50dh720778054c247557@mail.gmail.com>
Message-ID: <1259535247-6439-1-git-send-email-icarnales@gmail.com>

---
 archlinux/aur/forms.py |   32 ++++++--------------------------
 1 files changed, 6 insertions(+), 26 deletions(-)

diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
index e6d9e87..aca1cbf 100644
--- a/archlinux/aur/forms.py
+++ b/archlinux/aur/forms.py
@@ -97,8 +97,7 @@ class PackageField(forms.FileField):
             pkg = PKGBUILD.Package(filename)
         except:
             raise forms.ValidationError(sys.exc_info()[1])
-        # Add path of the tarball/PKGBUILD so we can reference in other
-        # places
+        # Add path of the tarball so we can reference in other places
         pkg['filename'] = filename
         # Validate PKGBUILD
         pkg.validate()
@@ -190,18 +189,10 @@ class PackageSubmitForm(forms.Form):
         for arch in pkg['arch']:
             object = Architecture.objects.get(name=arch)
             package.architectures.add(object)
-        # Check if the uploaded file is a tar file or just a PKGBUILD
-        try:
-            tar = tarfile.open(pkg['filename'], "r")
-        except tarfile.ReadError:
-            # It's not a tar file, so if must be a PKGBUILD since it validated
-            is_tarfile = False
-            pkgbuild = pkg['filename']
-        else:
-            is_tarfile = True
-            tmpdir_sources = os.path.join(tmpdir, 'sources')
-            tar.extractall(tmpdir_sources)
-            pkgbuild = os.path.join(tmpdir_sources, pkg['name'], 'PKGBUILD')
+        tar = tarfile.open(pkg['filename'], "r")
+        tmpdir_sources = os.path.join(tmpdir, 'sources')
+        tar.extractall(tmpdir_sources)
+        pkgbuild = os.path.join(tmpdir_sources, pkg['name'], 'PKGBUILD')
         # Remove all sources. It's easier and cleaner this way.
         if updating:
             PackageFile.objects.filter(package=pkg['name']).delete()
@@ -219,17 +210,6 @@ class PackageSubmitForm(forms.Form):
         # Save tarball
         # TODO: Tar the saved sources instead of using the uploaded one, for
         # security
-        if not is_tarfile:
-            # We only have the PKGBUILD, so lets make a tarball
-            try:
-                tarball_path = os.path.join(tmpdir, pkg['name'] + '.tar.gz')
-                tar = tarfile.open(str(tarball_path), "w|gz")
-                tar.add(pkg['filename'], '%s/PKGBUILD' % pkg['name'])
-                tar.close()
-                pkg['filename'] = os.path.join(tmpdir, '%s.tar.gz' % pkg['name'])
-            except:
-                transaction.rollback()
-                raise
         fp = File(open(pkg['filename'], "rb"))
         package.tarball.save(os.path.join('%(name)s', os.path.basename(pkg['filename'])), fp)
         fp.close()
@@ -239,7 +219,7 @@ class PackageSubmitForm(forms.Form):
             source = PackageFile(package=package)
             # If it's a local file, save to disk, otherwise record as url
             source_file = os.path.join(tmpdir_sources, package.name, source_filename)
-            if is_tarfile and os.path.exists(source_file):
+            if os.path.exists(source_file):
                 fp = File(open(source_file, "r"))
                 source.filename.save('%(name)s/sources/' + source_filename, fp)
                 fp.close()
-- 
1.6.5.2



From cmbrannon79 at gmail.com  Mon Nov 30 00:35:48 2009
From: cmbrannon79 at gmail.com (Chris Brannon)
Date: Sun, 29 Nov 2009 17:35:48 -0600
Subject: [aur2-dev] [PATCH] Remove single PKGBUILD uploading from aur
	forms
In-Reply-To: <1259535247-6439-1-git-send-email-icarnales@gmail.com>
References: <d83f7a8d0911281450p3a7dc50dh720778054c247557@mail.gmail.com>
	<1259535247-6439-1-git-send-email-icarnales@gmail.com>
Message-ID: <4b13050c.9753f10a.316e.ffffad42@mx.google.com>

I tested it locally, and it looks good over here.

-- Chris


From djszapi at archlinux.us  Mon Nov 30 05:18:03 2009
From: djszapi at archlinux.us (Laszlo Papp)
Date: Mon, 30 Nov 2009 05:18:03 +0100
Subject: [aur2-dev] [PATCH] Remove single PKGBUILD uploading from aur
	forms
In-Reply-To: <1259535247-6439-1-git-send-email-icarnales@gmail.com>
References: <d83f7a8d0911281450p3a7dc50dh720778054c247557@mail.gmail.com>
	<1259535247-6439-1-git-send-email-icarnales@gmail.com>
Message-ID: <a362e8010911292018u7bdce1eap7e9c5e822b072686@mail.gmail.com>

On Sun, Nov 29, 2009 at 11:54 PM, Ismael Carnales <icarnales at gmail.com> wrote:
> ---
> ?archlinux/aur/forms.py | ? 32 ++++++--------------------------
> ?1 files changed, 6 insertions(+), 26 deletions(-)
>
> diff --git a/archlinux/aur/forms.py b/archlinux/aur/forms.py
> index e6d9e87..aca1cbf 100644
> --- a/archlinux/aur/forms.py
> +++ b/archlinux/aur/forms.py
> @@ -97,8 +97,7 @@ class PackageField(forms.FileField):
> ? ? ? ? ? ? pkg = PKGBUILD.Package(filename)
> ? ? ? ? except:
> ? ? ? ? ? ? raise forms.ValidationError(sys.exc_info()[1])
> - ? ? ? ?# Add path of the tarball/PKGBUILD so we can reference in other
> - ? ? ? ?# places
> + ? ? ? ?# Add path of the tarball so we can reference in other places
> ? ? ? ? pkg['filename'] = filename
> ? ? ? ? # Validate PKGBUILD
> ? ? ? ? pkg.validate()
> @@ -190,18 +189,10 @@ class PackageSubmitForm(forms.Form):
> ? ? ? ? for arch in pkg['arch']:
> ? ? ? ? ? ? object = Architecture.objects.get(name=arch)
> ? ? ? ? ? ? package.architectures.add(object)
> - ? ? ? ?# Check if the uploaded file is a tar file or just a PKGBUILD
> - ? ? ? ?try:
> - ? ? ? ? ? ?tar = tarfile.open(pkg['filename'], "r")
> - ? ? ? ?except tarfile.ReadError:
> - ? ? ? ? ? ?# It's not a tar file, so if must be a PKGBUILD since it validated
> - ? ? ? ? ? ?is_tarfile = False
> - ? ? ? ? ? ?pkgbuild = pkg['filename']
> - ? ? ? ?else:
> - ? ? ? ? ? ?is_tarfile = True
> - ? ? ? ? ? ?tmpdir_sources = os.path.join(tmpdir, 'sources')
> - ? ? ? ? ? ?tar.extractall(tmpdir_sources)
> - ? ? ? ? ? ?pkgbuild = os.path.join(tmpdir_sources, pkg['name'], 'PKGBUILD')
> + ? ? ? ?tar = tarfile.open(pkg['filename'], "r")
> + ? ? ? ?tmpdir_sources = os.path.join(tmpdir, 'sources')
> + ? ? ? ?tar.extractall(tmpdir_sources)
> + ? ? ? ?pkgbuild = os.path.join(tmpdir_sources, pkg['name'], 'PKGBUILD')
> ? ? ? ? # Remove all sources. It's easier and cleaner this way.
> ? ? ? ? if updating:
> ? ? ? ? ? ? PackageFile.objects.filter(package=pkg['name']).delete()
> @@ -219,17 +210,6 @@ class PackageSubmitForm(forms.Form):
> ? ? ? ? # Save tarball
> ? ? ? ? # TODO: Tar the saved sources instead of using the uploaded one, for
> ? ? ? ? # security
> - ? ? ? ?if not is_tarfile:
> - ? ? ? ? ? ?# We only have the PKGBUILD, so lets make a tarball
> - ? ? ? ? ? ?try:
> - ? ? ? ? ? ? ? ?tarball_path = os.path.join(tmpdir, pkg['name'] + '.tar.gz')
> - ? ? ? ? ? ? ? ?tar = tarfile.open(str(tarball_path), "w|gz")
> - ? ? ? ? ? ? ? ?tar.add(pkg['filename'], '%s/PKGBUILD' % pkg['name'])
> - ? ? ? ? ? ? ? ?tar.close()
> - ? ? ? ? ? ? ? ?pkg['filename'] = os.path.join(tmpdir, '%s.tar.gz' % pkg['name'])
> - ? ? ? ? ? ?except:
> - ? ? ? ? ? ? ? ?transaction.rollback()
> - ? ? ? ? ? ? ? ?raise
> ? ? ? ? fp = File(open(pkg['filename'], "rb"))
> ? ? ? ? package.tarball.save(os.path.join('%(name)s', os.path.basename(pkg['filename'])), fp)
> ? ? ? ? fp.close()
> @@ -239,7 +219,7 @@ class PackageSubmitForm(forms.Form):
> ? ? ? ? ? ? source = PackageFile(package=package)
> ? ? ? ? ? ? # If it's a local file, save to disk, otherwise record as url
> ? ? ? ? ? ? source_file = os.path.join(tmpdir_sources, package.name, source_filename)
> - ? ? ? ? ? ?if is_tarfile and os.path.exists(source_file):
> + ? ? ? ? ? ?if os.path.exists(source_file):
> ? ? ? ? ? ? ? ? fp = File(open(source_file, "r"))
> ? ? ? ? ? ? ? ? source.filename.save('%(name)s/sources/' + source_filename, fp)
> ? ? ? ? ? ? ? ? fp.close()
> --
> 1.6.5.2
>
> _______________________________________________
> aur2-dev mailing list
> aur2-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/aur2-dev
>

I implemented something similar after my PKBUILD removing patch, and
after you warned me for these things, so you will see the patch from
me after the next aur2 push operation, but thanks.

Best Regards,
Laszlo Papp


From icarnales at gmail.com  Mon Nov 30 13:19:17 2009
From: icarnales at gmail.com (Ismael Carnales)
Date: Mon, 30 Nov 2009 10:19:17 -0200
Subject: [aur2-dev] [PATCH] Remove single PKGBUILD uploading from aur
	forms
In-Reply-To: <a362e8010911292018u7bdce1eap7e9c5e822b072686@mail.gmail.com>
References: <d83f7a8d0911281450p3a7dc50dh720778054c247557@mail.gmail.com> 
	<1259535247-6439-1-git-send-email-icarnales@gmail.com>
	<a362e8010911292018u7bdce1eap7e9c5e822b072686@mail.gmail.com>
Message-ID: <d83f7a8d0911300419x5265d0d3qa4f086700d8e5f0c@mail.gmail.com>

> I implemented something similar after my PKBUILD removing patch, and
> after you warned me for these things, so you will see the patch from
> me after the next aur2 push operation, but thanks.
>

You could have replied that to my mail :/


From cmbrannon79 at gmail.com  Mon Nov 30 16:00:05 2009
From: cmbrannon79 at gmail.com (Christopher Brannon)
Date: Mon, 30 Nov 2009 09:00:05 -0600
Subject: [aur2-dev] [PATCH] Use a temporary MEDIA_ROOT when running unit
	tests.
Message-ID: <4b14948d.9653f10a.0b57.fffff586@mx.google.com>

I want to test package uploading thoroughly.  Here's the first step.
This was suggested by Xilon on the AUR_2 page from the Arch wiki.
The temporary tree is removed when the application terminates.

Signed-off-by: Christopher Brannon <cmbrannon79 at gmail.com>
---
 archlinux/settings.py |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/archlinux/settings.py b/archlinux/settings.py
index a7d1813..63958fa 100644
--- a/archlinux/settings.py
+++ b/archlinux/settings.py
@@ -1,4 +1,8 @@
 import os.path
+import sys
+import tempfile
+import shutil
+import atexit
 
 DEPLOY_PATH = os.path.dirname(__file__) # This is the base dir for everything
 
@@ -75,3 +79,7 @@ try:
     from settings_local import *
 except ImportError:
     pass
+
+if len(sys.argv) > 1 and sys.argv[1] == 'test':
+    MEDIA_ROOT = tempfile.mkdtemp(prefix='testaur2')
+    atexit.register(lambda : shutil.rmtree(MEDIA_ROOT))
-- 
1.6.4.4



